{"version":3,"sources":["webpack:///./src/module/sw-promotion-v2/view/sw-promotion-detail-discounts/sw-promotion-detail-discounts.scss","webpack:///./src/module/sw-promotion-v2/helper/promotion.helper.js","webpack:///./src/module/sw-promotion-v2/view/sw-promotion-detail-discounts/index.js","webpack:///./src/module/sw-promotion-v2/view/sw-promotion-detail-discounts/sw-promotion-detail-discounts.html.twig"],"names":["content","__esModule","default","module","i","locals","exports","add","DiscountTypes","PERCENTAGE","ABSOLUTE","FIXED","FIXED_UNIT","DiscountScopes","CART","DELIVERY","SET","SETGROUP","PromotionPermissions","isEditingAllowed","promotion","undefined","hasOwnProperty","Error","hasOrders","template","inject","data","deleteDiscountId","repository","computed","Shopware","State","get","isLoading","set","commit","discounts","methods","onAddDiscount","newDiscount","this","repositoryFactory","create","entity","source","promotionId","id","scope","type","value","considerAdvancedRules","sorterKey","applierKey","usageKey","push","deleteDiscount","discount","_this","isNew","remove","delete","context","then"],"mappings":"uGAGA,IAAIA,EAAU,EAAQ,QACnBA,EAAQC,aAAYD,EAAUA,EAAQE,SACnB,iBAAZF,IAAsBA,EAAU,CAAC,CAACG,EAAOC,EAAIJ,EAAS,MAC7DA,EAAQK,SAAQF,EAAOG,QAAUN,EAAQK,SAG/BE,EADH,EAAQ,QAAwEL,SACzE,WAAYF,GAAS,EAAM,K,kCCT5C,sHAQaQ,EAAgB,CACzBC,WAAY,aACZC,SAAU,WACVC,MAAO,QACPC,WAAY,cAMHC,EAAiB,CAC1BC,KAAM,OACNC,SAAU,WACVC,IAAK,MACLC,SAAU,YAMDC,EAAuB,CAChCC,iBAUJ,SAA0BC,GACtB,GAAkB,OAAdA,EACA,OAAO,EAGX,QAAkBC,IAAdD,EACA,OAAO,EAGX,IAAKE,YAAeF,EAAW,aAC3B,MAAM,IAAIG,MAAM,gFAGpB,OAAQH,EAAUI,a,0FC3CP,WACXC,SCVW,w8CDYXC,OAAQ,CAAC,oBAAqB,OAE9BC,KAAI,WACA,MAAO,CACHC,iBAAkB,KAClBC,WAAY,OAIpBC,SAAU,CACNV,UAAS,WACL,OAAOW,SAASC,MAAMC,IAAI,qBAAqBb,WAGnDc,UAAW,CACPD,IAAG,WACC,OAAOF,SAASC,MAAMC,IAAI,qBAAqBC,WAEnDC,IAAG,SAACD,GACAH,SAASC,MAAMI,OAAO,iCAAkCF,KAIhEG,UAAS,WACL,OAAON,SAASC,MAAMC,IAAI,qBAAqBb,WAC3CW,SAASC,MAAMC,IAAI,qBAAqBb,UAAUiB,YAK9DC,QAAS,CAILC,cAAa,WACT,IAIMC,EAJ8BC,KAAKC,kBAAkBC,OACvDF,KAAKJ,UAAUO,OACfH,KAAKJ,UAAUQ,QAE6BF,SAChDH,EAAYM,YAAcL,KAAKrB,UAAU2B,GACzCP,EAAYQ,MAAQnC,IAAeC,KACnC0B,EAAYS,KAAOzC,IAAcC,WACjC+B,EAAYU,MAAQ,IACpBV,EAAYW,uBAAwB,EACpCX,EAAYY,UAAY,YACxBZ,EAAYa,WAAa,MACzBb,EAAYc,SAAW,MAEvBb,KAAKJ,UAAUkB,KAAKf,IAGxBgB,eAAc,SAACC,GAAW,IAADC,EAAA,KACjBD,EAASE,QACTlB,KAAKJ,UAAUuB,OAAOH,EAASV,KAInCN,KAAKP,WAAY,EACmBO,KAAKC,kBAAkBC,OACvDF,KAAKJ,UAAUO,OACfH,KAAKJ,UAAUQ,QAGSgB,OAAOJ,EAASV,GAAIN,KAAKJ,UAAUyB,SAASC,MAAK,WACzEL,EAAKrB,UAAUuB,OAAOH,EAASV,IAC/BW,EAAKxB,WAAY","file":"static/js/f422ced4d9e53588995d.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-promotion-detail-discounts.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"4831d264\", content, true, {});","/**\n * @package buyers-experience\n */\nimport { hasOwnProperty } from 'src/core/service/utils/object.utils';\n\n/**\n * @private\n */\nexport const DiscountTypes = {\n    PERCENTAGE: 'percentage',\n    ABSOLUTE: 'absolute',\n    FIXED: 'fixed',\n    FIXED_UNIT: 'fixed_unit',\n};\n\n/**\n * @private\n */\nexport const DiscountScopes = {\n    CART: 'cart',\n    DELIVERY: 'delivery',\n    SET: 'set',\n    SETGROUP: 'setgroup',\n};\n\n/**\n * @private\n */\nexport const PromotionPermissions = {\n    isEditingAllowed,\n};\n\n/**\n * Gets if the editing of the promotion is allowed,\n * or if it's forbidden to change anything because\n * it has already been used.\n *\n * @param {Object} promotion\n */\nfunction isEditingAllowed(promotion) {\n    if (promotion === null) {\n        return false;\n    }\n\n    if (promotion === undefined) {\n        return false;\n    }\n\n    if (!hasOwnProperty(promotion, 'hasOrders')) {\n        throw new Error('Promotion Property hasOrders does not exist. Please use the Hydrator before!');\n    }\n\n    return !promotion.hasOrders;\n}\n","import { DiscountTypes, DiscountScopes } from 'src/module/sw-promotion-v2/helper/promotion.helper';\nimport template from './sw-promotion-detail-discounts.html.twig';\nimport './sw-promotion-detail-discounts.scss';\n\n/**\n * @package buyers-experience\n *\n * @private\n */\nexport default {\n    template,\n\n    inject: ['repositoryFactory', 'acl'],\n\n    data() {\n        return {\n            deleteDiscountId: null,\n            repository: null,\n        };\n    },\n\n    computed: {\n        promotion() {\n            return Shopware.State.get('swPromotionDetail').promotion;\n        },\n\n        isLoading: {\n            get() {\n                return Shopware.State.get('swPromotionDetail').isLoading;\n            },\n            set(isLoading) {\n                Shopware.State.commit('swPromotionDetail/setIsLoading', isLoading);\n            },\n        },\n\n        discounts() {\n            return Shopware.State.get('swPromotionDetail').promotion &&\n                Shopware.State.get('swPromotionDetail').promotion.discounts;\n        },\n\n    },\n\n    methods: {\n        // This function adds a new blank discount object to our promotion.\n        // It will automatically trigger a rendering of the view which\n        // leads to a new card that appears within our discounts area.\n        onAddDiscount() {\n            const promotionDiscountRepository = this.repositoryFactory.create(\n                this.discounts.entity,\n                this.discounts.source,\n            );\n            const newDiscount = promotionDiscountRepository.create();\n            newDiscount.promotionId = this.promotion.id;\n            newDiscount.scope = DiscountScopes.CART;\n            newDiscount.type = DiscountTypes.PERCENTAGE;\n            newDiscount.value = 0.01;\n            newDiscount.considerAdvancedRules = false;\n            newDiscount.sorterKey = 'PRICE_ASC';\n            newDiscount.applierKey = 'ALL';\n            newDiscount.usageKey = 'ALL';\n\n            this.discounts.push(newDiscount);\n        },\n\n        deleteDiscount(discount) {\n            if (discount.isNew()) {\n                this.discounts.remove(discount.id);\n                return;\n            }\n\n            this.isLoading = true;\n            const promotionDiscountRepository = this.repositoryFactory.create(\n                this.discounts.entity,\n                this.discounts.source,\n            );\n\n            promotionDiscountRepository.delete(discount.id, this.discounts.context).then(() => {\n                this.discounts.remove(discount.id);\n                this.isLoading = false;\n            });\n        },\n    },\n};\n","export default \"\\n{% block sw_promotion_detail_discounts %}\\n<div class=\\\"sw-promotion-detail-discounts\\\">\\n    \\n    {% block sw_promotion_detail_discounts_card_add %}\\n    <div\\n        class=\\\"promotion-detail-discounts__action_add\\\"\\n        position-identifier=\\\"sw-promotion-detail-discounts\\\"\\n    >\\n        \\n        {% block sw_promotion_detail_discounts_actions_add %}\\n        <sw-button\\n            v-tooltip=\\\"{\\n                message: $tc('sw-privileges.tooltip.warning'),\\n                disabled: acl.can('promotion.editor'),\\n                showOnDisabledElements: true\\n            }\\\"\\n            :is-loading=\\\"isLoading\\\"\\n            variant=\\\"ghost\\\"\\n            :disabled=\\\"(promotion && promotion.hasOrders) || !acl.can('promotion.editor')\\\"\\n            @click=\\\"onAddDiscount\\\"\\n        >\\n            {{ $tc('sw-promotion.detail.main.discounts.buttonAddDiscount') }}\\n        </sw-button>\\n        {% endblock %}\\n    </div>\\n    {% endblock %}\\n\\n    \\n    {% block sw_promotion_detail_discounts_items %}\\n    <ul class=\\\"sw-promotion-detail-discounts__discount-list\\\">\\n        \\n        {% block sw_promotion_detail_discounts_item_form %}\\n        <sw-promotion-discount-component\\n            v-for=\\\"discount in discounts\\\"\\n            :key=\\\"discount.id\\\"\\n            :promotion=\\\"promotion\\\"\\n            :discount=\\\"discount\\\"\\n            @discount-delete=\\\"deleteDiscount\\\"\\n        />\\n        {% endblock %}\\n    </ul>\\n    {% endblock %}\\n</div>\\n{% endblock %}\\n\";"],"sourceRoot":""}