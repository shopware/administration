(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[491],{bL8K:function(e,s,n){"use strict";n.r(s);var t=n("CsSd"),i=n.n(t),r=n("2wIO");n("xHho");function a(e,s){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);s&&(t=t.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),n.push.apply(n,t)}return n}function l(e){for(var s=1;s<arguments.length;s++){var n=null!=arguments[s]?arguments[s]:{};s%2?a(Object(n),!0).forEach((function(s){i()(e,s,n[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))}))}return e}var o=Shopware,d=o.Component,c=o.Mixin,u=Shopware.Data.Criteria,m=d.getComponentHelper().mapPropertyErrors,_=Shopware.Utils.debug.warn;s.default={template:'\n{% block sw_settings_user_detail %}\n<sw-page class="sw-settings-user-detail">\n    \n    {% block sw_settings_user_detail_header %}\n    <template #smart-bar-header>\n        <h2 v-if="!isLoading">\n            {{ fullName }}\n        </h2>\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_settings_user_detail_actions %}\n    <template #smart-bar-actions>\n        \n        {% block sw_settings_user_detail_actions_cancel %}\n        <sw-button\n            v-tooltip.bottom="tooltipCancel"\n            @click="onCancel"\n        >\n            {{ $tc(\'sw-users-permissions.users.user-detail.labelButtonCancel\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_settings_user_detail_actions_save %}\n        <sw-button-process\n            v-tooltip.bottom="tooltipSave"\n            class="sw-settings-user-detail__save-action"\n            :is-loading="isLoading"\n            :process-success="isSaveSuccessful"\n            :disabled="isLoading || !acl.can(\'users_and_permissions.editor\')"\n            variant="primary"\n            {% if VUE3 %}\n            @update:process-success="saveFinish"\n            {% else %}\n            @process-finish="saveFinish"\n            {% endif %}\n            @click.prevent="onSave"\n        >\n            {{ $tc(\'sw-users-permissions.users.user-detail.labelButtonSave\') }}\n        </sw-button-process>\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_settings_user_detail_content %}\n    <template #content>\n        <sw-card-view>\n            \n            {% block sw_settings_user_detail_content_inner %}\n            <template v-if="isLoading">\n                <sw-skeleton />\n                <sw-skeleton />\n            </template>\n\n            {# v-show is used here as underlying components influence the loading state and v-if would destroy this behaviour #}\n            <div v-show="!isLoading">\n                {%  block sw_setting_user_detail_card_basic_information %}\n                <sw-card\n                    position-identifier="sw-users-permissions-user-detail"\n                    :title="$tc(\'sw-users-permissions.users.user-detail.labelCard\')"\n                    :is-loading="isLoading"\n                >\n                    \n                    {% block sw_settings_user_detail_content_grid %}\n                    <div\n                        v-if="user"\n                        class="sw-settings-user-detail__grid"\n                    >\n                        \n                        {% block sw_settings_user_detail_content_first_name %}\n                        <sw-text-field\n                            {% if VUE3 %}\n                            v-model:value="user.firstName"\n                            {% else %}\n                            v-model="user.firstName"\n                            {% endif %}\n                            name="sw-field--user-firstName"\n                            class="sw-settings-user-detail__grid-firstName"\n                            :disabled="!acl.can(\'users_and_permissions.editor\')"\n                            :error="userFirstNameError"\n                            required\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelFirstName\')"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_content_last_name %}\n                        <sw-text-field\n                            {% if VUE3 %}\n                            v-model:value="user.lastName"\n                            {% else %}\n                            v-model="user.lastName"\n                            {% endif %}\n                            name="sw-field--user-lastName"\n                            class="sw-settings-user-detail__grid-lastName"\n                            :disabled="!acl.can(\'users_and_permissions.editor\')"\n                            :error="userLastNameError"\n                            required\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelLastName\')"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_content_email %}\n                        <sw-text-field\n                            {% if VUE3 %}\n                            v-model:value.trim="user.email"\n                            {% else %}\n                            v-model.trim="user.email"\n                            {% endif %}\n                            name="sw-field--user-email"\n                            class="sw-settings-user-detail__grid-eMail"\n                            :error-message="isEmailUsed ? $tc(\'sw-users-permissions.users.user-detail.errorEmailUsed\') : \'\'"\n                            :error="userEmailError"\n                            :disabled="!acl.can(\'users_and_permissions.editor\')"\n                            required\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelEmail\')"\n                            @change="checkEmail()"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_content_username %}\n                        <sw-text-field\n                            {% if VUE3 %}\n                            v-model:value="user.username"\n                            {% else %}\n                            v-model="user.username"\n                            {% endif %}\n                            name="sw-field--user-username"\n                            class="sw-settings-user-detail__grid-username"\n                            :error-message="isUsernameUsed ? $tc(\'sw-users-permissions.users.user-detail.errorUsernameUsed\') : \'\'"\n                            :error="userUsernameError"\n                            :disabled="!acl.can(\'users_and_permissions.editor\')"\n                            required\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelUsername\')"\n                            @change="checkUsername"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_content_media_upload %}\n                        <sw-upload-listener\n                            :upload-tag="user.id"\n                            auto-upload\n                            @media-upload-finish="setMediaItem"\n                        />\n                        <sw-media-upload-v2\n                            class="sw-settings-user-detail__grid-profile-picture"\n                            :source="avatarMedia"\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelProfilePicture\')"\n                            :upload-tag="user.id"\n                            :allow-multi-select="false"\n                            :source-context="user"\n                            :disabled="!acl.can(\'users_and_permissions.editor\')"\n                            variant="regular"\n                            default-folder="user"\n                            @media-upload-remove-image="onUnlinkLogo"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_content_password %}\n                        <sw-password-field\n                            class="sw-settings-user-detail__grid-password"\n                            :value="user.password"\n                            name="sw-field--user-password"\n                            :disabled="!acl.can(\'users_and_permissions.editor\')"\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelPassword\')"\n                            :copy-able="false"\n                            :error="userPasswordError"\n                            {% if VUE3 %}\n                            @update:value="setPassword"\n                            {% else %}\n                            @change="setPassword"\n                            {% endif %}\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_grid_content_language %}\n                        <sw-select-field\n                            {% if VUE3 %}\n                            v-model:value="user.localeId"\n                            {% else %}\n                            v-model="user.localeId"\n                            {% endif %}\n                            name="sw-field--user-localeId"\n                            class="sw-settings-user-detail__grid-language"\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelLanguage\')"\n                            :disabled="!acl.can(\'users_and_permissions.editor\')"\n                            :error="userLocaleIdError"\n                            required\n                            :placeholder="$tc(\'sw-users-permissions.users.user-detail.labelLanguagePlaceholder\')"\n                        >\n                            <option\n                                v-for="language in languages"\n                                :key="language.locale.id"\n                                :value="language.locale.id"\n                                :selected="language.locale.id === user.localeId"\n                            >\n                                {{ language.customLabel }}\n                            </option>\n                        </sw-select-field>\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_grid_content_timezone %}\n                        <sw-single-select\n                            {% if VUE3 %}\n                            v-model:value="user.timeZone"\n                            {% else %}\n                            v-model="user.timeZone"\n                            {% endif %}\n                            name="sw-field--user-timeZone"\n                            class="sw-settings-user-detail__grid-timezone"\n                            :options="timezoneOptions"\n                            required\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelTimezone\')"\n                            :is-loading="timezoneOptions.length <= 0"\n                            :disabled="!acl.can(\'user.update_profile\')"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_grid_content_acl_is_admin %}\n                        <sw-switch-field\n                            {% if VUE3 %}\n                            v-model:value="user.admin"\n                            {% else %}\n                            v-model="user.admin"\n                            {% endif %}\n                            name="sw-field--user-admin"\n                            class="sw-settings-user-detail__grid-is-admin"\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelAdministrator\')"\n                            :disabled="isCurrentUser || !acl.can(\'users_and_permissions.editor\')"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_grid_content_job_title %}\n                        <sw-text-field\n                            {% if VUE3 %}\n                            v-model:value="user.title"\n                            {% else %}\n                            v-model="user.title"\n                            {% endif %}\n                            name="sw-field--user-title"\n                            class="sw-settings-user-detail__grid-jobTitle"\n                            :disabled="!acl.can(\'users_and_permissions.editor\')"\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelJobTitle\')"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_settings_user_detail_grid_content_acl_roles %}\n                        <sw-entity-multi-select\n                            {% if VUE3 %}\n                            v-model:entityCollection="user.aclRoles"\n                            {% else %}\n                            v-model="user.aclRoles"\n                            {% endif %}\n                            v-tooltip="{\n                                showDelay: 300,\n                                message: $tc(\'sw-users-permissions.users.user-detail.disabledRoleSelectWarning\'),\n                                disabled: !user.admin || !acl.can(\'users_and_permissions.editor\')\n                            }"\n                            name="sw-field--user-aclRoles"\n                            class="sw-settings-user-detail__grid-aclRoles"\n                            :label="$tc(\'sw-users-permissions.users.user-detail.labelRoles\')"\n                            :disabled="user.admin || !acl.can(\'users_and_permissions.editor\')"\n                            :criteria="aclRoleCriteria"\n                            label-property="name"\n                        />\n                        {% endblock %}\n                    </div>\n                    {% endblock %}\n\n                    \n                    {% block sw_settings_user_detail_content_confirm_password_modal %}\n                    <sw-verify-user-modal\n                        v-if="confirmPasswordModal"\n                        @verified="saveUser"\n                        @close="onCloseConfirmPasswordModal"\n                    />\n                    {% endblock %}\n                </sw-card>\n                {% endblock %}\n\n                {%  block sw_setting_user_detail_card_integrations %}\n                <sw-card\n                    :title="$tc(\'sw-users-permissions.users.user-detail.labelIntegrationsCard\')"\n                    position-identifier="sw-users-permissions-user-detail"\n                >\n                    \n                    {% block sw_settings_user_detail_grid_toolbar %}\n                    <template #toolbar>\n                        \n                        {% block sw_settings_user_detail_grid_add_key %}\n                        <sw-button\n                            variant="primary"\n                            size="small"\n                            :disabled="!$route.params.id || !acl.can(\'users_and_permissions.editor\')"\n                            @click="addAccessKey"\n                        >\n                            {{ $tc(\'sw-users-permissions.users.user-detail.addAccessKey\') }}\n                        </sw-button>\n                        {% endblock %}\n                    </template>\n                    {% endblock %}\n\n                    \n                    {% block sw_settings_user_detail_key_grid %}\n                    <template #grid>\n                        \n                        {% block sw_settings_user_detail_key_grid_content %}\n                        <sw-data-grid\n                            :is-loading="isLoading"\n                            :data-source="integrations"\n                            :columns="integrationColumns"\n                            identifier="user-grid"\n                            :show-settings="true"\n                            :skeleton-item-amount="skeletonItemAmount"\n                        >\n\n                            \n                            {% block sw_settings_user_detail_grid_columns_actions %}\n                            <template #actions="{ item }">\n                                \n                                {% block sw_settings_user_detail_grid_columns_actions_edit %}\n                                <sw-context-menu-item\n                                    class="sw-settings-user-detail__grid-context-menu-edit sw-product-list__edit-action"\n                                    :disabled="!acl.can(\'users_and_permissions.editor\')"\n                                    @click="onShowDetailModal(item.id)"\n                                >\n                                    {{ $tc(\'sw-users-permissions.users.user-detail.contextMenuEdit\') }}\n                                </sw-context-menu-item>\n                                {% endblock %}\n\n                                \n                                {% block sw_settings_user_detail_grid_columns_actions_delete %}\n                                <sw-context-menu-item\n                                    class="sw-settings-user-detail__grid-context-menu-delete"\n                                    :disabled="!acl.can(\'users_and_permissions.editor\')"\n                                    variant="danger"\n                                    @click="showDeleteModal = item.id"\n                                >\n                                    {{ $tc(\'sw-users-permissions.users.user-detail.contextMenuDelete\') }}\n                                </sw-context-menu-item>\n                                {% endblock %}\n                            </template>\n                            {% endblock %}\n                        </sw-data-grid>\n                        <sw-empty-state\n                            v-if="integrations.length === 0"\n                            :absolute="false"\n                            :title="$tc(\'sw-users-permissions.users.user-detail.noAccessKeysTitle\')"\n                            :subline="$tc(\'sw-users-permissions.users.user-detail.noAccessKeysSubline\')"\n                            auto-height\n                        />\n                        {% endblock %}\n                    </template>\n                    {% endblock %}\n                </sw-card>\n                {% endblock %}\n            </div>\n            {% endblock %}\n        </sw-card-view>\n\n        \n        {% block sw_settings_user_detail_grid_inner_slot_delete_modal %}\n        <sw-modal\n            v-if="showDeleteModal"\n            :title="$tc(\'global.default.warning\')"\n            @modal-close="onCloseDeleteModal"\n        >\n            \n            {% block sw_settings_user_detail_grid_inner_slot_delete_modal_confirm_text %}\n            <p>\n                {{ $tc(\'sw-users-permissions.users.user-detail.modal.confirmDelete\') }}\n            </p>\n            {% endblock %}\n\n            \n            {% block sw_settings_user_detail_grid_inner_slot_delete_modal_footer %}\n            <template #modal-footer>\n                <sw-button\n                    size="small"\n                    @click="onCloseDeleteModal"\n                >\n                    {{ $tc(\'sw-users-permissions.users.user-detail.modal.buttonCancel\') }}\n                </sw-button>\n                <sw-button\n                    size="small"\n                    variant="danger"\n                    @click="onConfirmDelete(showDeleteModal)"\n                >\n                    {{ $tc(\'sw-users-permissions.users.user-detail.modal.buttonDelete\') }}\n                </sw-button>\n            </template>\n            {% endblock %}\n        </sw-modal>\n        {% endblock %}\n\n        \n        {% block sw_settings_user_detail_detail_modal %}\n        <sw-modal\n            v-if="currentIntegration"\n            size="550px"\n            class="sw-settings-user-detail__detail"\n            :is-loading="isModalLoading"\n            :title="showSecretAccessKey ? $tc(\'global.default.warning\') : $tc(\'sw-users-permissions.users.user-detail.modal.detailModalTitleEdit\')"\n            @modal-close="onCloseDetailModal"\n        >\n            \n            {% block sw_settings_user_detail_detail_modal_inner %}\n\n            \n            {% block sw_settings_user_detail_detail_modal_inner_field_access_key %}\n            <sw-text-field\n                {% if VUE3 %}\n                v-model:value="currentIntegration.accessKey"\n                {% else %}\n                v-model="currentIntegration.accessKey"\n                {% endif %}\n                :label="$tc(\'sw-users-permissions.users.user-detail.modal.idFieldLabel\')"\n                :disabled="true"\n                :copy-able="true"\n                :copy-able-tooltip="true"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_user_detail_detail_modal_inner_field_secret_access_key %}\n            \n            {% block sw_settings_user_detail_detail_modal_inner_field_secret_access_key_field %}\n            <sw-text-field\n                v-if="showSecretAccessKey"\n                {% if VUE3 %}\n                v-model:value="currentIntegration.secretAccessKey"\n                {% else %}\n                v-model="currentIntegration.secretAccessKey"\n                {% endif %}\n                :label="$tc(\'sw-users-permissions.users.user-detail.modal.secretFieldLabel\')"\n                :disabled="true"\n                :password-toggle-able="false"\n                :copy-able="showSecretAccessKey"\n                :copy-able-tooltip="true"\n            />\n\n            <sw-password-field\n                v-else\n                {% if VUE3 %}\n                v-model:value="currentIntegration.secretAccessKey"\n                {% else %}\n                v-model="currentIntegration.secretAccessKey"\n                {% endif %}\n                :label="$tc(\'sw-users-permissions.users.user-detail.modal.secretFieldLabel\')"\n                :disabled="true"\n                :password-toggle-able="false"\n                :copy-able="showSecretAccessKey"\n                :copy-able-tooltip="true"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_user_detail_detail_modal_inner_field_secret_access_key_button %}\n            <sw-button\n                v-if="!showSecretAccessKey"\n                class="sw-settings-user-detail__secret-help-text-button sw-field"\n                variant="danger"\n                :block="true"\n                @click="addAccessKey"\n            >\n                {{ $tc(\'sw-users-permissions.users.user-detail.modal.buttonCreateNewApiKeys\') }}\n            </sw-button>\n            {% endblock %}\n\n            \n            {% block sw_settings_user_detail_detail_modal_inner_field_help_text %}\n            <sw-alert\n                v-if="!showSecretAccessKey"\n                variant="warning"\n                class="sw-settings-user-detail__secret-help-text-alert"\n            >\n                {{ $tc(\'sw-users-permissions.users.user-detail.modal.hintCreateNewApiKeys\') }}\n            </sw-alert>\n            {% endblock %}\n            {% endblock %}\n\n            \n            {% block sw_settings_user_detail_detail_modal_inner_help_text %}\n            <sw-alert\n                v-else\n                variant="warning"\n                class="sw-settings-user-detail__secret-help-text-alert"\n            >\n                {{ $tc(\'sw-users-permissions.users.user-detail.modal.secretHelpText\') }}\n            </sw-alert>\n            {% endblock %}\n\n            \n            {% block sw_settings_user_detail_detail_modal_inner_footer %}\n            <template #modal-footer>\n                \n                {% block sw_settings_user_detail_detail_modal_inner_footer_cancel %}\n                <sw-button\n                    size="small"\n                    :disabled="isModalLoading"\n                    @click="onCloseDetailModal"\n                >\n                    {{ $tc(\'sw-users-permissions.users.user-detail.modal.buttonCancel\') }}\n                </sw-button>\n                {% endblock %}\n\n                \n                {% block sw_settings_user_detail_detail_modal_inner_footer_apply %}\n                <sw-button\n                    size="small"\n                    class="sw-settings-user-detail__save-action"\n                    :disabled="isModalLoading && !!currentIntegration.label"\n                    variant="primary"\n                    @click="onSaveIntegration"\n                >\n                    {{ showSecretAccessKey ? $tc(\'sw-users-permissions.users.user-detail.modal.buttonApply\') : $tc(\'sw-users-permissions.users.user-detail.modal.buttonApplyEdit\') }}\n                </sw-button>\n                {% endblock %}\n            </template>\n            {% endblock %}\n            {% endblock %}\n        </sw-modal>\n        {% endblock %}\n    </template>\n    {% endblock %}\n</sw-page>\n{% endblock %}\n',inject:["userService","loginService","userValidationService","integrationService","repositoryFactory","acl"],mixins:[c.getByName("notification"),c.getByName("salutation")],shortcuts:{"SYSTEMKEY+S":"onSave",ESCAPE:"onCancel"},data:function(){return{isLoading:!1,userId:"",user:null,currentUser:null,languages:[],integrations:[],currentIntegration:null,mediaItem:null,newPassword:"",newPasswordConfirm:"",isEmailUsed:!1,isUsernameUsed:!1,isIntegrationsLoading:!1,isSaveSuccessful:!1,isModalLoading:!1,showSecretAccessKey:!1,showDeleteModal:null,skeletonItemAmount:3,confirmPasswordModal:!1,timezoneOptions:[]}},metaInfo:function(){return{title:this.$createTitle(this.identifier)}},computed:l(l({},m("user",["firstName","lastName","email","username","localeId","password"])),{},{identifier:function(){return this.fullName},fullName:function(){return this.salutation(this.user,this.$tc("sw-users-permissions.users.user-detail.labelNewUser"))},userRepository:function(){return this.repositoryFactory.create("user")},userCriteria:function(){var e=new u(1,25);return e.addAssociation("accessKeys"),e.addAssociation("locale"),e.addAssociation("aclRoles"),e},aclRoleCriteria:function(){var e=new u(1,25);return e.addFilter(u.equals("app.id",null)),e.addFilter(u.equals("deletedAt",null)),e},languageRepository:function(){return this.repositoryFactory.create("language")},languageCriteria:function(){var e=new u(1,500);return e.addAssociation("locale"),e.addSorting(u.sort("locale.name","ASC")),e.addSorting(u.sort("locale.territory","ASC")),e},localeRepository:function(){return this.repositoryFactory.create("locale")},avatarMedia:function(){return this.mediaItem},isError:function(){return this.isEmailUsed||this.isUsernameUsed||!this.hasLanguage},hasLanguage:function(){return this.user&&this.user.localeId},disableConfirm:function(){return this.newPassword!==this.newPasswordConfirm||""===this.newPassword||null===this.newPassword},isCurrentUser:function(){return!(!this.user||!this.currentUser)&&this.userId===this.currentUser.id},mediaRepository:function(){return this.repositoryFactory.create("media")},integrationColumns:function(){return[{property:"accessKey",label:this.$tc("sw-users-permissions.users.user-detail.labelAccessKey")}]},secretAccessKeyFieldType:function(){return this.showSecretAccessKey?"text":"password"},languageId:function(){return Shopware.State.get("session").languageId},tooltipSave:function(){var e=this.$device.getSystemKey();return{message:"".concat(e," + S"),appearance:"light"}},tooltipCancel:function(){return{message:"ESC",appearance:"light"}}}),watch:{languageId:function(){this.createdComponent()}},created:function(){this.createdComponent()},methods:{createdComponent:function(){var e=this;if(Shopware.ExtensionAPI.publishData({id:"sw-users-permissions-user-detail__currentUser",path:"currentUser",scope:this}),this.isLoading=!0,this.languageId){this.timezoneOptions=Shopware.Service("timezoneService").getTimezoneOptions();var s=[new Promise((function(s){Shopware.State.commit("context/setApiLanguageId",e.languageId),s(e.languageId)})),this.loadLanguages(),this.loadUser(),this.loadCurrentUser()];Promise.all(s).then((function(){e.isLoading=!1}))}else this.isLoading=!1},loadTimezones:function(){},loadLanguages:function(){var e=this;return this.languageRepository.search(this.languageCriteria).then((function(s){return e.languages=[],s.forEach((function(s){s.customLabel="".concat(s.locale.translated.name," (").concat(s.locale.translated.territory,")"),e.languages.push(s)})),e.languages}))},loadUser:function(){var e=this;return this.userId=this.$route.params.id,this.userRepository.get(this.userId,Shopware.Context.api,this.userCriteria).then((function(s){e.user=s,e.user.avatarId&&(e.mediaItem=e.user.avatarMedia),e.keyRepository=e.repositoryFactory.create(s.accessKeys.entity,e.user.accessKeys.source),e.loadKeys()}))},loadCurrentUser:function(){var e=this;return this.userService.getUser().then((function(s){e.currentUser=s.data}))},loadKeys:function(){this.integrations=this.user.accessKeys},addAccessKey:function(){var e=this,s=this.keyRepository.create();this.isModalLoading=!0,s.quantityStart=1,this.integrationService.generateKey({},{},!0).then((function(n){s.accessKey=n.accessKey,s.secretAccessKey=n.secretAccessKey,e.currentIntegration=s,e.isModalLoading=!1,e.showSecretAccessKey=!0}))},checkEmail:function(){var e=this;return this.user.email?Object(r.b)(this.user.email)?this.userValidationService.checkUserEmail({email:this.user.email,id:this.user.id}).then((function(s){var n=s.emailIsUnique;e.isEmailUsed=!n})):(this.createNotificationError({title:this.$tc("global.default.error"),message:this.$tc("sw-users-permissions.users.user-detail.notification.invalidEmailErrorMessage")}),Promise.reject()):Promise.resolve()},checkUsername:function(){var e=this;return this.userValidationService.checkUserUsername({username:this.user.username,id:this.user.id}).then((function(s){var n=s.usernameIsUnique;e.isUsernameUsed=!n}))},setMediaItem:function(e){var s=this,n=e.targetId;this.mediaRepository.get(n).then((function(e){s.mediaItem=e,s.user.avatarMedia=e,s.user.avatarId=n}))},onUnlinkLogo:function(){this.mediaItem=null,this.user.avatarMedia=null,this.user.avatarId=null},onSearch:function(e){this.term=e,this.clearSelection()},saveFinish:function(){this.isSaveSuccessful=!1},onSave:function(){this.confirmPasswordModal=!0},saveUser:function(e){var s=this;this.isSaveSuccessful=!1,this.isLoading=!0;var n=[];return this.currentUser.id===this.user.id&&(n=[Shopware.Service("localeHelper").setLocaleWithId(this.user.localeId)]),Promise.all(n).then(this.checkEmail().then((function(){if(!s.isEmailUsed){s.isLoading=!0;var n=s.$tc("global.default.error"),t=s.$tc("sw-users-permissions.users.user-detail.notification.saveError.message",0,{name:s.fullName});return s.userRepository.save(s.user,e).then((function(){return s.updateCurrentUser()})).then((function(){s.createdComponent(),s.confirmPasswordModal=!1,s.isSaveSuccessful=!0})).catch((function(e){throw s.createNotificationError({title:n,message:t}),_(s._name,e.message,e.response),s.isLoading=!1,e})).finally((function(){s.isLoading=!1}))}return s.createNotificationError({message:s.$tc("sw-users-permissions.users.user-detail.notification.duplicateEmailErrorMessage")}),Promise.resolve()})).catch((function(){return Promise.reject()})).finally((function(){s.isLoading=!1})))},updateCurrentUser:function(){return this.userService.getUser().then((function(e){var s=e.data;return delete s.password,Shopware.State.commit("setCurrentUser",s)}))},onCancel:function(){this.$router.push({name:"sw.users.permissions.index"})},setPassword:function(e){"string"==typeof e&&e.length<=0?this.$delete(this.user,"password"):this.$set(this.user,"password",e)},onShowDetailModal:function(e){e?this.currentIntegration=this.user.accessKeys.get(e):this.addAccessKey()},onCloseDetailModal:function(){this.currentIntegration=null,this.showSecretAccessKey=!1,this.isModalLoading=!1},onSaveIntegration:function(){this.currentIntegration&&(this.user.accessKeys.has(this.currentIntegration.id)||this.user.accessKeys.add(this.currentIntegration),this.onCloseDetailModal())},onCloseDeleteModal:function(){this.showDeleteModal=null},onConfirmDelete:function(e){e&&(this.onCloseDeleteModal(),this.user.accessKeys.remove(e))},onCloseConfirmPasswordModal:function(){this.confirmPasswordModal=!1}}}},ksBF:function(e,s,n){},xHho:function(e,s,n){var t=n("ksBF");t.__esModule&&(t=t.default),"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);(0,n("P8hj").default)("7190ef38",t,!0,{})}}]);
//# sourceMappingURL=6d380d5cda6ca9245b45.js.map