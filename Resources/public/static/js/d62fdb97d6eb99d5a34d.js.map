{"version":3,"sources":["webpack:///./src/module/sw-settings-custom-field/component/sw-custom-field-detail/index.js","webpack:///./src/module/sw-settings-custom-field/component/sw-custom-field-detail/sw-custom-field-detail.html.twig","webpack:///./src/module/sw-settings-custom-field/component/sw-custom-field-detail/sw-custom-field-detail.scss"],"names":["_Shopware","Shopware","Mixin","Context","Criteria","Data","template","inject","mixins","getByName","props","currentCustomField","type","Object","required","set","data","fieldTypes","disableCartExpose","computed","locales","this","config","translated","keys","$root","$i18n","messages","fallbackLocale","canSave","customFieldType","renderComponentName","configRenderComponent","modalTitle","_isNew","$tc","labelSaveButton","isProductCustomField","relations","filter","relation","entityName","length","ruleConditionRepository","repositoryFactory","create","watch","value","validation","hasOwnProperty","$delete","created","createdComponent","methods","_this","customFieldDataProviderService","getTypes","$set","name","concat","toLowerCase","allowCartExpose","criteria","addFilter","multi","equals","search","api","then","searchResult","onCancel","$emit","onSave","_this2","applyTypeConfiguration","entity","SwCustomFieldListIsCustomFieldNameUnique","isUnique","createNameNotUniqueNotification","createEntityTypeRequiredNotification","notificationTitle","nameNotUniqueMessage","createNotificationError","title","message","entityTypeRequiredTitle","_objectSpread","getCartExposeTooltipConfig","disabled","width","$t","content","__esModule","default","module","i","locals","exports","add"],"mappings":"uvBAMA,IAAAA,EAA2BC,SAAnBC,EAAKF,EAALE,MAAOC,EAAOH,EAAPG,QACPC,EAAaH,SAASI,KAAtBD,SAGO,WACXE,SCXW,mkMDaXC,OAAQ,CAAC,oBAAqB,iCAAkC,2CAA4C,OAE5GC,OAAQ,CACJN,EAAMO,UAAU,iBAGpBC,MAAO,CACHC,mBAAoB,CAChBC,KAAMC,OACNC,UAAU,GAGdC,IAAK,CACDH,KAAMC,OACNC,UAAU,IAIlBE,KAAI,WACA,MAAO,CACHC,WAAY,GACZH,UAAU,EACVI,mBAAmB,IAI3BC,SAAU,CACNC,QAAO,WACH,OAAIC,KAAKN,IAAIO,OAAOC,aAA6C,IAA/BF,KAAKN,IAAIO,OAAOC,WACvCV,OAAOW,KAAKH,KAAKI,MAAMC,MAAMC,UAGjC,CAACN,KAAKI,MAAMC,MAAME,iBAE7BC,QAAO,WACH,OAAOR,KAAKV,mBAAmBW,OAAOQ,iBAE1CC,oBAAmB,WACf,OAAOV,KAAKJ,WAAWI,KAAKV,mBAAmBW,OAAOQ,iBAAiBE,uBAE3EC,WAAU,WACN,OAAIZ,KAAKV,mBAAmBuB,OACjBb,KAAKc,IAAI,mEAGbd,KAAKc,IAAI,qEAEpBC,gBAAe,WACX,OAAIf,KAAKV,mBAAmBuB,OACjBb,KAAKc,IAAI,+DAGbd,KAAKc,IAAI,gEAEpBE,qBAAoB,WAChB,QAAKhB,KAAKN,IAAIuB,WAI6E,IAApFjB,KAAKN,IAAIuB,UAAUC,QAAO,SAAAC,GAAQ,MAA4B,YAAxBA,EAASC,cAA0BC,QAEpFC,wBAAuB,WACnB,OAAOtB,KAAKuB,kBAAkBC,OAAO,oBAI7CC,MAAO,CACHhC,SAAQ,SAACiC,GACDA,EACA1B,KAAKV,mBAAmBW,OAAO0B,WAAa,WAK5C3B,KAAKV,mBAAmBW,OAAO2B,eAAe,eAC9C5B,KAAK6B,QAAQ7B,KAAKV,mBAAmBW,OAAQ,gBAKzD6B,QAAO,WACH9B,KAAK+B,oBAGTC,QAAS,CACLD,iBAAgB,WAAI,IAADE,EAAA,KAuBf,GAtBAjC,KAAKJ,WAAaI,KAAKkC,+BAA+BC,WAEjDnC,KAAKV,mBAAmBW,QACzBD,KAAKoC,KAAKpC,KAAKV,mBAAoB,SAAU,IAG5CU,KAAKV,mBAAmBW,OAAO2B,eAAe,oBAC/C5B,KAAKoC,KAAKpC,KAAKV,mBAAmBW,OAAQ,kBAAmB,IAG5DD,KAAKV,mBAAmB+C,OACzBrC,KAAKV,mBAAmB+C,KAAI,GAAAC,OAAMtC,KAAKN,IAAI2C,KAAKE,cAAa,MAG7DvC,KAAKV,mBAAmBW,OAAO2B,eAAe,gBAC9C5B,KAAKP,SAA0D,aAA9CO,KAAKV,mBAAmBW,OAAO0B,YAG/C3B,KAAKV,mBAAmBW,OAAO2B,eAAe,wBAC/C5B,KAAKoC,KAAKpC,KAAKV,mBAAmBW,OAAQ,sBAAuB,GAGhED,KAAKV,mBAAmBkD,gBAA7B,CAMA,IAAMC,EAAW,IAAI1D,EAAS,EAAG,GACjC0D,EAASC,UAAU3D,EAAS4D,MACxB,MACA,CACI5D,EAAS6D,OAAO,OAAQ,2BACxB7D,EAAS6D,OAAO,2BAA4B5C,KAAKV,mBAAmB+C,SAI5ErC,KAAKsB,wBAAwBuB,OAAOJ,EAAU3D,EAAQgE,KAAKC,MAAK,SAACC,GAC7Df,EAAKpC,kBAAoBmD,EAAa3B,OAAS,UAf/CrB,KAAKH,mBAAoB,GAmBjCoD,SAAQ,WACJjD,KAAKkD,MAAM,2BAA4BlD,KAAKV,qBAGhD6D,OAAM,WAAI,IAADC,EAAA,KACLpD,KAAKqD,yBAEArD,KAAKV,mBAAmBuB,OAM0B,WAAnDb,KAAKV,mBAAmBW,OAAOQ,iBAC1BT,KAAKV,mBAAmBW,OAAOqD,OAOxCtD,KAAKuD,yCAAyCvD,KAAKV,oBAAoByD,MAAK,SAAAS,GACpEA,EACAJ,EAAKF,MAAM,yBAA0BE,EAAK9D,oBAK9C8D,EAAKK,qCAbDzD,KAAK0D,uCAPT1D,KAAKkD,MAAM,yBAA0BlD,KAAKV,qBAwBlDmE,gCAA+B,WAC3B,IAAME,EAAoB3D,KAAKc,IAAI,wBAC7B8C,EAAuB5D,KAAKc,IAAI,4DAEtCd,KAAK6D,wBAAwB,CACzBC,MAAOH,EACPI,QAASH,KAIjBF,qCAAoC,WAChC,IAAMC,EAAoB3D,KAAKc,IAAI,wBAC7BkD,EAA0BhE,KAAKc,IAAI,0DAEzCd,KAAK6D,wBAAwB,CACzBC,MAAOH,EACPI,QAASC,KAIjBX,uBAAsB,WAClB,IAAM5C,EAAkBT,KAAKV,mBAAmBW,OAAOQ,gBAElDT,KAAKV,mBAAmBC,OACzBS,KAAKV,mBAAmBC,KAAOS,KAAKJ,WAAWa,GAAiBlB,MAAQkB,GAG5ET,KAAKV,mBAAmBW,OAAMgE,IAAA,GACvBjE,KAAKV,mBAAmBW,QACxBD,KAAKJ,WAAWa,GAAiBR,SAI5CiE,2BAA0B,WACtB,OAAKlE,KAAKH,kBAIH,CACHsE,UAAU,EACVC,MAAO,IACPL,QAAS/D,KAAKqE,GAAG,0EANV,CAAEN,QAAS,GAAII,UAAU,O,qBE7MhD,IAAIG,EAAU,EAAQ,QACnBA,EAAQC,aAAYD,EAAUA,EAAQE,SACnB,iBAAZF,IAAsBA,EAAU,CAAC,CAACG,EAAOC,EAAIJ,EAAS,MAC7DA,EAAQK,SAAQF,EAAOG,QAAUN,EAAQK,SAG/BE,EADH,EAAQ,QAAwEL,SACzE,WAAYF,GAAS,EAAM","file":"static/js/d62fdb97d6eb99d5a34d.js","sourcesContent":["/**\n * @package services-settings\n */\nimport template from './sw-custom-field-detail.html.twig';\nimport './sw-custom-field-detail.scss';\n\nconst { Mixin, Context } = Shopware;\nconst { Criteria } = Shopware.Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: ['repositoryFactory', 'customFieldDataProviderService', 'SwCustomFieldListIsCustomFieldNameUnique', 'acl'],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        currentCustomField: {\n            type: Object,\n            required: true,\n        },\n\n        set: {\n            type: Object,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            fieldTypes: {},\n            required: false,\n            disableCartExpose: true,\n        };\n    },\n\n    computed: {\n        locales() {\n            if (this.set.config.translated && this.set.config.translated === true) {\n                return Object.keys(this.$root.$i18n.messages);\n            }\n\n            return [this.$root.$i18n.fallbackLocale];\n        },\n        canSave() {\n            return this.currentCustomField.config.customFieldType;\n        },\n        renderComponentName() {\n            return this.fieldTypes[this.currentCustomField.config.customFieldType].configRenderComponent;\n        },\n        modalTitle() {\n            if (this.currentCustomField._isNew) {\n                return this.$tc('sw-settings-custom-field.customField.detail.titleNewCustomField');\n            }\n\n            return this.$tc('sw-settings-custom-field.customField.detail.titleEditCustomField');\n        },\n        labelSaveButton() {\n            if (this.currentCustomField._isNew) {\n                return this.$tc('sw-settings-custom-field.customField.detail.buttonSaveApply');\n            }\n\n            return this.$tc('sw-settings-custom-field.customField.detail.buttonEditApply');\n        },\n        isProductCustomField() {\n            if (!this.set.relations) {\n                return false;\n            }\n\n            return this.set.relations.filter(relation => relation.entityName === 'product').length !== 0;\n        },\n        ruleConditionRepository() {\n            return this.repositoryFactory.create('rule_condition');\n        },\n    },\n\n    watch: {\n        required(value) {\n            if (value) {\n                this.currentCustomField.config.validation = 'required';\n\n                return;\n            }\n\n            if (this.currentCustomField.config.hasOwnProperty('validation')) {\n                this.$delete(this.currentCustomField.config, 'validation');\n            }\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.fieldTypes = this.customFieldDataProviderService.getTypes();\n\n            if (!this.currentCustomField.config) {\n                this.$set(this.currentCustomField, 'config', {});\n            }\n\n            if (!this.currentCustomField.config.hasOwnProperty('customFieldType')) {\n                this.$set(this.currentCustomField.config, 'customFieldType', '');\n            }\n\n            if (!this.currentCustomField.name) {\n                this.currentCustomField.name = `${this.set.name.toLowerCase()}_`;\n            }\n\n            if (this.currentCustomField.config.hasOwnProperty('validation')) {\n                this.required = (this.currentCustomField.config.validation === 'required');\n            }\n\n            if (!this.currentCustomField.config.hasOwnProperty('customFieldPosition')) {\n                this.$set(this.currentCustomField.config, 'customFieldPosition', 1);\n            }\n\n            if (!this.currentCustomField.allowCartExpose) {\n                this.disableCartExpose = false;\n\n                return;\n            }\n\n            const criteria = new Criteria(1, 1);\n            criteria.addFilter(Criteria.multi(\n                'AND',\n                [\n                    Criteria.equals('type', 'cartLineItemCustomField'),\n                    Criteria.equals('value.renderedField.name', this.currentCustomField.name),\n                ],\n            ));\n\n            this.ruleConditionRepository.search(criteria, Context.api).then((searchResult) => {\n                this.disableCartExpose = searchResult.length > 0;\n            });\n        },\n\n        onCancel() {\n            this.$emit('custom-field-edit-cancel', this.currentCustomField);\n        },\n\n        onSave() {\n            this.applyTypeConfiguration();\n\n            if (!this.currentCustomField._isNew) {\n                this.$emit('custom-field-edit-save', this.currentCustomField);\n\n                return;\n            }\n\n            if (this.currentCustomField.config.customFieldType === 'entity') {\n                if (!this.currentCustomField.config.entity) {\n                    this.createEntityTypeRequiredNotification();\n\n                    return;\n                }\n            }\n\n            this.SwCustomFieldListIsCustomFieldNameUnique(this.currentCustomField).then(isUnique => {\n                if (isUnique) {\n                    this.$emit('custom-field-edit-save', this.currentCustomField);\n\n                    return;\n                }\n\n                this.createNameNotUniqueNotification();\n            });\n        },\n\n        createNameNotUniqueNotification() {\n            const notificationTitle = this.$tc('global.default.error');\n            const nameNotUniqueMessage = this.$tc('sw-settings-custom-field.set.detail.messageNameNotUnique');\n\n            this.createNotificationError({\n                title: notificationTitle,\n                message: nameNotUniqueMessage,\n            });\n        },\n\n        createEntityTypeRequiredNotification() {\n            const notificationTitle = this.$tc('global.default.error');\n            const entityTypeRequiredTitle = this.$tc('sw-settings-custom-field.set.detail.entityTypeRequired');\n\n            this.createNotificationError({\n                title: notificationTitle,\n                message: entityTypeRequiredTitle,\n            });\n        },\n\n        applyTypeConfiguration() {\n            const customFieldType = this.currentCustomField.config.customFieldType;\n\n            if (!this.currentCustomField.type) {\n                this.currentCustomField.type = this.fieldTypes[customFieldType].type || customFieldType;\n            }\n\n            this.currentCustomField.config = {\n                ...this.currentCustomField.config,\n                ...this.fieldTypes[customFieldType].config,\n            };\n        },\n\n        getCartExposeTooltipConfig() {\n            if (!this.disableCartExpose) {\n                return { message: '', disabled: true };\n            }\n\n            return {\n                disabled: false,\n                width: 260,\n                message: this.$t('sw-settings-custom-field.customField.detail.tooltipCartExposeDisabled'),\n            };\n        },\n    },\n};\n","export default \"\\n{% block sw_custom_field_detail %}\\n<sw-modal\\n    class=\\\"sw-custom-field-detail\\\"\\n    :title=\\\"modalTitle\\\"\\n    @modal-close=\\\"onCancel\\\"\\n>\\n    \\n    {% block sw_custom_field_detail_modal %}\\n    <sw-container\\n        columns=\\\"1fr 1fr\\\"\\n        gap=\\\"20px\\\"\\n    >\\n        \\n        {% block sw_custom_field_detail_modal_type %}\\n        <sw-select-field\\n            {% if VUE3 %}\\n            v-model:value=\\\"currentCustomField.config.customFieldType\\\"\\n            {% else %}\\n            v-model=\\\"currentCustomField.config.customFieldType\\\"\\n            {% endif %}\\n            :label=\\\"$tc('sw-settings-custom-field.customField.detail.labelCustomFieldType')\\\"\\n            :placeholder=\\\"$tc('sw-settings-custom-field.customField.detail.placeholderCustomFieldType')\\\"\\n            class=\\\"sw-custom-field-detail__modal-type\\\"\\n            type=\\\"select\\\"\\n            :help-text=\\\"$tc('sw-settings-custom-field.general.tooltipType')\\\"\\n            :disabled=\\\"!currentCustomField._isNew || !acl.can('custom_field.editor')\\\"\\n        >\\n            <option\\n                v-for=\\\"(option, key) in fieldTypes\\\"\\n                :key=\\\"key\\\"\\n                :value=\\\"key\\\"\\n            >\\n                {{ $tc(`sw-settings-custom-field.types.${key}`) }}\\n            </option>\\n        </sw-select-field>\\n        {% endblock %}\\n\\n        \\n        {% block sw_custom_field_detail_modal_technical_name %}\\n        <sw-text-field\\n            {% if VUE3 %}\\n            v-model:value=\\\"currentCustomField.name\\\"\\n            {% else %}\\n            v-model=\\\"currentCustomField.name\\\"\\n            {% endif %}\\n            class=\\\"sw-custom-field-detail__technical-name\\\"\\n            :label=\\\"$tc('sw-settings-custom-field.customField.detail.labelTechnicalName')\\\"\\n            :help-text=\\\"$tc('sw-settings-custom-field.general.tooltipTechnicalName')\\\"\\n            :disabled=\\\"!currentCustomField._isNew || !acl.can('custom_field.editor')\\\"\\n        />\\n        {% endblock %}\\n\\n        \\n        {% block sw_custom_field_detail_modal_position %}\\n        <sw-number-field\\n            {% if VUE3 %}\\n            v-model:value=\\\"currentCustomField.config.customFieldPosition\\\"\\n            {% else %}\\n            v-model=\\\"currentCustomField.config.customFieldPosition\\\"\\n            {% endif %}\\n            class=\\\"sw-custom-field-detail__modal-position\\\"\\n            :help-text=\\\"$tc('sw-settings-custom-field.customField.detail.tooltipCustomFieldPosition')\\\"\\n            number-type=\\\"int\\\"\\n            :label=\\\"$tc('sw-settings-custom-field.customField.detail.labelCustomFieldPosition')\\\"\\n            :disabled=\\\"!acl.can('custom_field.editor')\\\"\\n        />\\n        {% endblock %}\\n\\n        \\n        {% block sw_custom_field_detail_modal_required %}\\n        <sw-switch-field\\n            {% if VUE3 %}\\n            v-model:value=\\\"required\\\"\\n            {% else %}\\n            v-model=\\\"required\\\"\\n            {% endif %}\\n            bordered\\n            :help-text=\\\"$tc('sw-settings-custom-field.customField.detail.tooltipRequired')\\\"\\n            class=\\\"sw-custom-field-detail__switch\\\"\\n            :label=\\\"$tc('sw-settings-custom-field.customField.detail.labelRequired')\\\"\\n            required\\n            :disabled=\\\"!acl.can('custom_field.editor')\\\"\\n        />\\n        {% endblock %}\\n\\n        \\n        {% block sw_custom_field_detail_modal_allow_customer_write %}\\n        <sw-switch-field\\n            {% if VUE3 %}\\n            v-model:value=\\\"currentCustomField.allowCustomerWrite\\\"\\n            {% else %}\\n            v-model=\\\"currentCustomField.allowCustomerWrite\\\"\\n            {% endif %}\\n            bordered\\n            :help-text=\\\"$tc('sw-settings-custom-field.customField.detail.tooltipAllowCustomerWrite')\\\"\\n            class=\\\"sw-custom-field-detail__allow-customer-write\\\"\\n            :label=\\\"$tc('sw-settings-custom-field.customField.detail.labelAllowCustomerWrite')\\\"\\n            :disabled=\\\"!acl.can('custom_field.editor')\\\"\\n        />\\n        {% endblock %}\\n\\n        <sw-switch-field\\n            v-if=\\\"isProductCustomField\\\"\\n            {% if VUE3 %}\\n            v-model:value=\\\"currentCustomField.allowCartExpose\\\"\\n            {% else %}\\n            v-model=\\\"currentCustomField.allowCartExpose\\\"\\n            {% endif %}\\n            v-tooltip=\\\"getCartExposeTooltipConfig()\\\"\\n            bordered\\n            :help-text=\\\"$tc('sw-settings-custom-field.customField.detail.tooltipAllowCartExpose')\\\"\\n            class=\\\"sw-custom-field-detail__allow-cart-expose\\\"\\n            :label=\\\"$tc('sw-settings-custom-field.customField.detail.labelAllowCartExpose')\\\"\\n            :disabled=\\\"!acl.can('custom_field.editor') || disableCartExpose\\\"\\n        />\\n\\n        \\n        {% block sw_custom_field_detail_modal_snippet_info  %}\\n        <sw-alert class=\\\"sw-custom-field-detail__info\\\">\\n            {{ $tc('sw-settings-custom-field.customField.detail.infoText', 0, { name: currentCustomField.name }) }}\\n        </sw-alert>\\n        {% endblock %}\\n    </sw-container>\\n\\n    \\n    {% block sw_custom_field_detail_modal_render_component %}\\n    <div v-if=\\\"currentCustomField.config.customFieldType.length > 0\\\">\\n        <component\\n            :is=\\\"renderComponentName\\\"\\n            :current-custom-field=\\\"currentCustomField\\\"\\n            :set=\\\"set\\\"\\n        />\\n    </div>\\n    {% endblock %}\\n\\n    \\n    {% block sw_custom_field_detail_modal_footer %}\\n    <template #modal-footer>\\n        \\n        {% block sw_custom_field_detail_modal_footer_cancel %}\\n        <sw-button\\n            size=\\\"small\\\"\\n            @click=\\\"onCancel\\\"\\n        >\\n            {{ $tc('sw-settings-custom-field.customField.detail.buttonCancel') }}\\n        </sw-button>\\n        {% endblock %}\\n\\n        \\n        {% block sw_custom_field_detail_modal_footer_save %}\\n        <sw-button\\n            class=\\\"sw-custom-field-detail__footer-save\\\"\\n            variant=\\\"primary\\\"\\n            size=\\\"small\\\"\\n            :disabled=\\\"!canSave || !acl.can('custom_field.editor')\\\"\\n            @click=\\\"onSave\\\"\\n        >\\n            {{ labelSaveButton }}\\n        </sw-button>\\n        {% endblock %}\\n    </template>\\n    {% endblock %}\\n    {% endblock %}\\n</sw-modal>\\n{% endblock %}\\n\";","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-custom-field-detail.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"04a3d0ea\", content, true, {});"],"sourceRoot":""}