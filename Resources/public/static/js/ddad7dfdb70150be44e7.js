(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[251],{EmxK:function(n,e,t){var a=t("X1ON");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);(0,t("ydqr").default)("d55288ac",a,!0,{})},H3gU:function(n,e,t){"use strict";t.r(e);var a=t("HZZ/"),i=t.n(a),r=t("J58c"),s=t.n(r),o=t("hJxD"),l=t.n(o);t("EmxK");function c(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,a)}return t}var u=Shopware.Data.Criteria;e.default={template:'\n{% block sw_first_run_wizard_welcome %}\n<div class="sw-first-run-wizard-welcome">\n    <div class="center">\n        <img\n            class="sw-first-run-wizard__welcome-image"\n            :src="\'/administration/static/img/first-run-wizard/welcome.svg\' | asset"\n            alt=""\n        >\n        <h4 class="headline-welcome">\n            {{ $tc(\'sw-first-run-wizard.welcome.headlineWelcome\') }}\n        </h4>\n        <p\n            class="text-welcome"\n            v-html="$tc(\'sw-first-run-wizard.welcome.messageWelcome\')"\n        ></p>\n    </div>\n\n    <h5 class="text-change-language">\n        {{ $tc(\'sw-first-run-wizard.welcome.headlineChangeLanguage\') }}\n    </h5>\n\n    <sw-loader v-if="isLoading" />\n\n    <sw-container\n        columns="1fr 1fr"\n        gap="24px 0"\n    >\n        <sw-plugin-card\n            v-for="languagePlugin in languagePlugins"\n            :key="languagePlugin.name"\n            :plugin="languagePlugin"\n            @onPluginInstalled="onPluginInstalled"\n            @onPluginRemoved="onPluginRemoved"\n            @extension-activated="$emit(\'extension-activated\', $event)"\n        />\n    </sw-container>\n\n    \n    {% block sw_first_run_wizard_welcome_confirm_language_switch_modal %}\n    <sw-modal\n        v-if="showConfirmLanguageSwitchModal"\n        variant="small"\n        :title="$tc(\'sw-first-run-wizard.welcome.switchLanguageModalTitle\')"\n        class="sw-first-run-wizard-confirmLanguageSwitch-modal"\n        @modal-close="onCancelSwitch"\n    >\n\n        \n        {% block sw_first_run_wizard_welcome_confirm_language_switch_modal_text %}\n        <p class="sw-first-run-wizard-welcome__modal-text">\n            {{ $tc(\'sw-first-run-wizard.welcome.switchLanguageMessage\', {}, { pluginName: latestTouchedPlugin.name }) }}\n        </p>\n        <sw-select-field\n            v-model="user.localeId"\n            class="sw-profile__language"\n            :label="$tc(\'sw-users-permissions.users.user-detail.labelLanguage\')"\n        >\n            <option\n                v-for="language in languages"\n                :key="language.locale.id"\n                :value="language.locale.id"\n                :selected="user.localeId === language.locale.id"\n            >\n                {{ language.customLabel }}\n            </option>\n        </sw-select-field>\n        <sw-password-field\n            v-model="user.pw"\n            type="password"\n            :label="$tc(\'sw-first-run-wizard.shopwareAccount.passwordPlaceholder\')"\n            :copy-able="false"\n            @keypress.enter="onConfirmLanguageSwitch"\n        />\n        {% endblock %}\n\n        \n        {% block sw_first_run_wizard_welcome_confirm_language_switch_modal_footer %}\n        <template #modal-footer>\n            \n            {% block sw_first_run_wizard_welcome_confirm_language_switch_modal_action_cancel %}\n            <sw-button\n                size="small"\n                @click="onCancelSwitch"\n            >\n                {{ $tc(\'sw-first-run-wizard.welcome.cancelLanguageSwitch\') }}\n            </sw-button>\n            {% endblock %}\n\n            \n            {% block sw_first_run_wizard_welcome_confirm_language_switch_modal_action_switch %}\n            <sw-button\n                size="small"\n                variant="primary"\n                @click="onConfirmLanguageSwitch"\n            >\n                {{ $tc(\'sw-first-run-wizard.welcome.confirmLanguageSwitch\') }}\n            </sw-button>\n            {% endblock %}\n        </template>\n        {% endblock %}\n    </sw-modal>\n    {% endblock %}\n</div>\n{% endblock %}\n',inject:["languagePluginService","userService","loginService","repositoryFactory"],mixins:["notification"],data:function(){return{languages:[],languagePlugins:[],latestTouchedPlugin:null,showConfirmLanguageSwitchModal:!1,newLocaleId:null,user:{localeId:"",pw:""},userProfile:{},userPromise:null,isLoading:!1}},computed:{languageRepository:function(){return this.repositoryFactory.create("language")},userRepository:function(){return this.repositoryFactory.create("user")},languageId:function(){return Shopware.State.get("session").languageId},languageCriteria:function(){return this.getLanguageCriteria()}},watch:{languageId:function(){this.createdComponent()}},beforeMount:function(){this.beforeMountComponent()},created:function(){this.createdComponent()},methods:{beforeMountComponent:function(){var n=this;this.userPromise.then((function(e){n.user=e}))},createdComponent:function(){var n=this;this.updateButtons(),this.setTitle(),this.getLanguagePlugins();var e=new Promise((function(e){e(n.languageId)}));this.userPromise=this.userService.getUser().then((function(e){return n.setUserData(e.data)}));var t=[e,this.userPromise];Promise.all(t).then((function(){n.loadLanguages()}))},setTitle:function(){this.$emit("frw-set-title",this.$tc("sw-first-run-wizard.welcome.modalTitle"))},updateButtons:function(){var n=[{key:"next",label:this.$tc("sw-first-run-wizard.general.buttonNext"),position:"right",variant:"primary",action:"sw.first.run.wizard.index.data-import",disabled:!1}];this.$emit("buttons-update",n)},setUserData:function(n){var e=this;return this.userProfile=n,new Promise((function(n){n(e.userRepository.get(e.userProfile.id))}))},getLanguagePlugins:function(){var n=this;this.languagePluginService.getPlugins().then((function(e){n.languagePlugins=e.items}))},onPluginInstalled:function(n){var e=this;this.latestTouchedPlugin=this.getPluginByName(n),this.getLanguagePlugins(),this.isLoading=!0,this.loadLanguages().then((function(){e.showConfirmLanguageSwitchModal=!0,e.isLoading=!1}))},onPluginRemoved:function(n){this.latestTouchedPlugin=this.getPluginByName(n),this.getLanguagePlugins()},onConfirmLanguageSwitch:function(){var n=this;this.loginService.verifyUserToken(this.user.pw).then((function(e){var t=function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?c(Object(t),!0).forEach((function(e){s()(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}({},Shopware.Context.api);t.authToken.access=e,n.userRepository.save(n.user,t).then(i()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Shopware.Service("localeHelper").setLocaleWithId(n.user.localeId);case 2:case"end":return e.stop()}}),e)})))).finally((function(){n.showConfirmLanguageSwitchModal=!1}))})).catch((function(){n.createNotificationError({title:n.$tc("sw-users-permissions.users.user-detail.passwordConfirmation.notificationPasswordErrorTitle"),message:n.$tc("sw-users-permissions.users.user-detail.passwordConfirmation.notificationPasswordErrorMessage")})})).finally((function(){n.confirmPassword=""}))},onCancelSwitch:function(){this.showConfirmLanguageSwitchModal=!1},getPluginByName:function(n){return this.languagePlugins.length<1?null:this.languagePlugins.find((function(e){return e.name===n}))},getLanguageCriteria:function(){var n=new u(1,null);return n.addAssociation("locale"),n.addSorting(u.sort("locale.name","ASC")),n.addSorting(u.sort("locale.territory","ASC")),n},showPluginErrorNotification:function(n,e){var t=this.$tc("sw-first-run-wizard.welcome.tryAgainLater");this.createNotificationError({message:"".concat(n,"\n").concat(e,"\n").concat(t)})},loadLanguages:function(){var n=this;return this.languageRepository.search(this.languageCriteria).then((function(e){return n.languages=[],e.forEach((function(e){e.customLabel="".concat(e.locale.translated.name," (").concat(e.locale.translated.territory,")"),n.languages.push(e)})),n.languages}))}}}},X1ON:function(n,e,t){}}]);