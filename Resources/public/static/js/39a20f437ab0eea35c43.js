(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[354],{"3a0g":function(t,n,e){},Qdie:function(t,n,e){"use strict";e.r(n);var s=e("J58c"),i=e.n(s);e("fAW1");function o(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,s)}return e}function r(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?o(Object(e),!0).forEach((function(n){i()(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var a=Shopware.Component.getComponentHelper(),c=a.mapGetters,d=a.mapState,l=Shopware.Context,u=Shopware.Data.Criteria;n.default={template:'<div class="sw-product-cross-selling-assignment">\n    \n    {% block sw_product_cross_selling_assignment_container %}\n    <div class="sw-product-cross-selling-assignment__select-container">\n        \n        {% block sw_product_cross_selling_assignment_select %}\n        <sw-entity-single-select\n            :label="$tc(\'sw-product.crossselling.inputCrossSellingProductList\')"\n            entity="product"\n            value=""\n            :criteria="searchCriteria"\n            :context="searchContext"\n            disable-auto-close\n            :disabled="!allowEdit"\n            show-clearable-button\n            @change="onToggleProduct"\n        >\n\n            <template #result-item="{ item, index }">\n                <slot\n                    name="result-item"\n                    v-bind="{ item, index, isSelected }"\n                >\n                    <li\n                        is="sw-select-result"\n                        :selected="isSelected(item)"\n                        v-bind="{ item, index }"\n                    >\n                        \n                        {% block sw_entity_single_select_base_results_list_result_label %}\n                        <span class="sw-select-result__result-item-text">\n                            <sw-product-variant-info :variations="item.variation">\n                                {{ item.translated.name || item.name }}\n                            </sw-product-variant-info>\n                        </span>\n                        {% endblock %}\n                    </li>\n                </slot>\n            </template>\n\n        </sw-entity-single-select>\n        {% endblock %}\n\n        \n        {% block sw_product_cross_selling_assignment_option_grid %}\n        <sw-data-grid\n            v-if="total"\n            :key="isLoadingGrid"\n            :data-source="assignedProducts"\n            :is-loading="isLoadingGrid"\n            :columns="assignedProductColumns"\n            :show-settings="true"\n            :show-selection="false"\n        >\n\n            <template #actions="{ item }">\n                <sw-context-menu-item\n                    :disabled="!allowEdit"\n                    variant="danger"\n                    @click="removeItem(item)"\n                >\n                    {{ $tc(\'global.default.delete\') }}\n                </sw-context-menu-item>\n            </template>\n\n            <template #column-product.translated.name="{ item }">\n                \n                {% block sw_data_grid_columns_render_value %}\n                <span>\n                    <sw-product-variant-info :variations="item.product.variation">\n                        {{ item.product.translated.name || item.product.name || variantNames[item.product.id] }}\n                    </sw-product-variant-info>\n                </span>\n                {% endblock %}\n            </template>\n\n            \n            {% block sw_product_cross_selling_assignment_option_grid_column_position %}\n            <template #column-position="{ item }">\n                <sw-data-grid-column-position\n                    ref="columnPosition"\n                    v-model="assignedProducts"\n                    :show-value="true"\n                    :item="item"\n                />\n            </template>\n            {% endblock %}\n        </sw-data-grid>\n        {% endblock %}\n        \n        {% block sw_product_cross_selling_assignment_empty_state %}\n        <sw-empty-state\n            v-if="!total && !isLoadingGrid"\n            class="sw-product-cross-selling-assignment__option-list-empty-state"\n            title=""\n            :absolute="false"\n            :subline="$tc(\'sw-product.crossselling.assignEmptyStateDescription\')"\n        >\n            <template #icon>\n                <img\n                    :src="\'/administration/static/img/empty-states/products-empty-state.svg\' | asset"\n                    alt=""\n                >\n            </template>\n        </sw-empty-state>\n        {% endblock %}\n    </div>\n    {% endblock %}\n</div>\n',inject:["repositoryFactory"],props:{assignedProducts:{type:Array,required:!0},crossSellingId:{type:String,required:!0},allowEdit:{type:Boolean,required:!1,default:!0}},data:function(){return{isLoadingData:!1,variantNames:{}}},computed:r(r(r({},d("swProductDetail",["product"])),c("swProductDetail",["isLoading"])),{},{isLoadingGrid:function(){return this.isLoadingData||this.isLoading},assignmentRepository:function(){return this.repositoryFactory.create(this.assignedProducts.entity,this.assignedProducts.source)},productRepository:function(){return this.repositoryFactory.create("product")},searchCriteria:function(){var t=new u(1,25);return t.addFilter(u.not("and",[u.equals("id",this.product.id)])),t.addFilter(u.multi("or",[u.equals("childCount",0),u.not("and",[u.equals("parentId",null)])])),t.addAssociation("options.group"),t},searchContext:function(){return r(r({},l.api),{},{inheritance:!0})},total:function(){return this.assignedProducts&&Array.isArray(this.assignedProducts)?this.assignedProducts.length:0},assignedProductColumns:function(){return[{property:"product.translated.name",label:this.$tc("sw-product.list.columnName"),primary:!0,allowResize:!0,sortable:!1},{property:"product.productNumber",label:this.$tc("sw-product.list.columnProductNumber"),allowResize:!0,sortable:!1},{property:"position",label:this.$tc("sw-product.crossselling.inputCrossSellingPosition"),allowResize:!0,sortable:!1}]},variantProductIds:function(){var t=[];return this.assignedProducts.forEach((function(n){!n.product.parentId||n.product.translated.name||n.product.name||t.push(n.product.id)})),t},variantCriteria:function(){var t=new u(1,25);return t.setIds(this.variantProductIds),t}}),created:function(){var t=this;0!==this.variantProductIds.length&&this.productRepository.search(this.variantCriteria,r(r({},l.api),{},{inheritance:!0})).then((function(n){var e={};n.forEach((function(t){e[t.id]=t.translated.name})),t.variantNames=e}))},methods:{onToggleProduct:function(t){var n=this;if(null!==t){this.isLoadingData=!0;var e=this.assignedProducts.find((function(n){return n.productId===t}));if(e)this.removeItem(e),this.isLoadingData=!1;else{var s=this.assignmentRepository.create();s.crossSellingId=this.crossSellingId,s.productId=t,s.position=this.assignedProducts.length+1,this.assignedProducts.add(s);var i=new u(1,25);i.addAssociation("options.group"),this.productRepository.get(t,r(r({},l.api),{},{inheritance:!0}),i).then((function(t){s.product=t,n.isLoadingData=!1}))}}},removeItem:function(t){var n=t.position;this.assignedProducts.remove(t.id),this.assignedProducts.forEach((function(t){t.position<=n||(t.position-=1)}))},isSelected:function(t){return this.assignedProducts.some((function(n){return n.productId===t.id}))}}}},fAW1:function(t,n,e){var s=e("3a0g");s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,e("ydqr").default)("289491be",s,!0,{})}}]);