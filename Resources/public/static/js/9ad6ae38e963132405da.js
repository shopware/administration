(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[533],{v8vR:function(e,t,a){"use strict";a.r(t);var n=a("7yzw"),s=a.n(n),i=a("92Mt"),r=a.n(i),o=Shopware.Mixin,c=Shopware.Utils;t.default={template:'\n{% block sw_cms_detail_toolbar_language_switch %}\n\n<template #language-switch>\n    <sw-language-switch disabled />\n</template>\n{% endblock %}\n\n\n{% block sw_cms_detail_toolbar_actions_sales_channel %}\n{% endblock %}\n\n\n{% block sw_cms_detail_toolbar_actions_save %}\n<sw-button-process\n    v-tooltip.bottom="tooltipSave"\n    class="sw-cms-detail__save-action"\n    :is-loading="isLoading"\n    :process-success="isSaveSuccessful"\n    :disabled="true"\n    variant="primary"\n>\n    {{ $tc(\'sw-cms.detail.label.buttonSave\') }}\n</sw-button-process>\n{% endblock %}\n\n\n{% block sw_cms_detail_stage_container %}\n<sw-cms-create-wizard\n    :page="page"\n    @on-section-select="addFirstSection($event, 0)"\n    @wizard-complete="onWizardComplete"\n/>\n{% endblock %}\n',mixins:[o.getByName("placeholder")],data:function(){return{wizardComplete:!1}},beforeRouteEnter:function(e,t,a){e.name.includes("sw.cms.create")&&!e.params.id&&(e.params.id=c.createId()),a()},computed:{pageHasSections:function(){return this.page.sections.length>0&&this.wizardComplete},categoryRepository:function(){return this.repositoryFactory.create("category")}},methods:{createdComponent:function(){Shopware.State.commit("adminMenu/collapseSidebar");var e=Shopware.State.getters["context/isSystemDefaultLanguage"];e||(Shopware.State.commit("context/resetLanguageToDefault"),this.$store.commit("cmsPageState/setIsSystemDefaultLanguage",e)),this.page=this.pageRepository.create(),this.page.sections=[]},onSave:function(){var e=this;return s()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isSaveSuccessful=!1,(!e.isSystemDefaultLanguage||e.page.name)&&e.page.type){t.next=4;break}return e.createNotificationWarning({message:e.$tc("sw-cms.detail.notification.messageMissingFields")}),t.abrupt("return",Promise.reject());case 4:return t.next=6,e.assignToEntity(e.page);case 6:return e.page=t.sent,e.deleteEntityAndRequiredConfigKey(e.page.sections),e.isLoading=!0,t.abrupt("return",e.pageRepository.save(e.page).then((function(){e.isLoading=!1,e.isSaveSuccessful=!0,e.$router.push({name:"sw.cms.detail",params:{id:e.page.id}})})).catch((function(t){return e.isLoading=!1,e.createNotificationError({message:t.message}),Promise.reject(t)})));case 10:case"end":return t.stop()}}),t)})))()},assignToEntity:function(e){var t=this;return s()(r.a.mark((function a(){var n,s,i,o,p,u;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.$route.params,s=n.type,(i=n.id)&&s){a.next=3;break}return a.abrupt("return",e);case 3:if(a.prev=3,"category"!==s){a.next=9;break}return a.next=7,t.categoryRepository.get(i);case 7:(o=a.sent)&&e.categories.push(o);case 9:if(!s.startsWith("ce_")&&!s.startsWith("custom_entity_")){a.next=15;break}return p=t.repositoryFactory.create(s),a.next=13,p.get(i);case 13:(u=a.sent)&&e.extensions["".concat(c.string.camelCase(s),"SwCmsPage")].push(u);case 15:a.next=20;break;case 17:a.prev=17,a.t0=a.catch(3),t.createNotificationError({message:t.$tc("sw-cms.create.notification.assignToEntityError")});case 20:return a.abrupt("return",e);case 21:case"end":return a.stop()}}),a,null,[[3,17]])})))()},onWizardComplete:function(){"product_list"!==this.page.type&&"product_detail"!==this.page.type||this.onPageTypeChange(this.page.type),this.wizardComplete=!0,this.onSave()}}}}}]);