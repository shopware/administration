(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[290],{EeZA:function(e,a,n){"use strict";n.r(a);var t=n("HZZ/"),o=n.n(t),r=n("J58c"),i=n.n(r),l=n("hJxD"),s=n.n(l);n("eV1/");function d(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function c(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?d(Object(n),!0).forEach((function(a){i()(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}var m=Shopware.Mixin,h=Shopware.Data.Criteria,f=Shopware.Utils.debug.warn,p=Shopware.Component.getComponentHelper().mapPropertyErrors;a.default={template:'\n{% block sw_mail_header_footer_detail %}\n<sw-page class="sw-mail-header-footer-detail">\n\n    \n    {% block sw_mail_header_footer_detail_header %}\n    <template #smart-bar-header>\n        <h2>{{ placeholder(mailHeaderFooter, \'name\', $tc(\'sw-mail-header-footer.detail.textHeadline\')) }}</h2>\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_mail_header_footer_detail_actions %}\n    <template #smart-bar-actions>\n        \n        {% block sw_mail_header_footer_detail_actions_abort %}\n        <sw-button\n            v-tooltip.bottom="{\n                message: \'ESC\',\n                appearance: \'light\'\n            }"\n            :disabled="isLoading"\n            @click="onCancel"\n        >\n            {{ $tc(\'sw-mail-header-footer.detail.buttonCancel\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_mail_header_footer_detail_actions_save %}\n        <sw-button-process\n            v-tooltip.bottom="tooltipSave"\n            class="sw-mail-header-footer-detail__save-action"\n            variant="primary"\n            :is-loading="isLoading"\n            :process-success="isSaveSuccessful"\n            :disabled="!allowSave"\n            @process-finish="saveFinish"\n            @click.prevent="onSave"\n        >\n            {{ $tc(\'sw-mail-header-footer.detail.buttonSave\') }}\n        </sw-button-process>\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_mail_header_footer_detail_language_switch %}\n    <template #language-switch>\n        <sw-language-switch\n            :save-changes-function="saveOnLanguageChange"\n            @on-change="onChangeLanguage"\n        />\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_mail_header_footer_detail_content %}\n    <template #content>\n        <sw-card-view sidebar>\n            <template v-if="isLoading">\n                <sw-skeleton />\n                <sw-skeleton />\n            </template>\n\n            <template v-else-if="mailHeaderFooter">\n                \n                {% block sw_mail_header_footer_detail_content_language_info %}\n                <sw-language-info\n                    :entity-description="placeholder(mailHeaderFooter, \'name\', $tc(\'sw-mail-header-footer.detail.textHeadline\'))"\n                />\n                {% endblock %}\n\n                \n                {% block sw_mail_header_footer_detail_basic_info %}\n                <sw-card\n                    :title="$tc(\'sw-mail-header-footer.detail.basic.titleCard\')"\n                    position-identifier="sw-mail-header-footer-detail-basic-info"\n                >\n                    \n                    {% block sw_mail_header_footer_basic_form_name_field %}\n                    <sw-field\n                        v-model="mailHeaderFooter.name"\n                        validation="required"\n                        type="text"\n                        required\n                        :label="$tc(\'sw-mail-header-footer.detail.basic.labelName\')"\n                        :placeholder="placeholder(mailHeaderFooter, \'name\', $tc(\'sw-mail-header-footer.detail.basic.placeholderName\'))"\n                        :disabled="!acl.can(\'mail_templates.editor\')"\n                        :error="mailHeaderFooterNameError"\n                    />\n                    {% endblock %}\n\n                    \n                    {% block sw_mail_header_footer_basic_form_description_field %}\n                    <sw-field\n                        v-model="mailHeaderFooter.description"\n                        type="textarea"\n                        :label="$tc(\'sw-mail-header-footer.detail.basic.labelDescription\')"\n                        :placeholder="placeholder(mailHeaderFooter, \'description\', $tc(\'sw-mail-header-footer.detail.basic.placeholderDescription\'))"\n                        :disabled="!acl.can(\'mail_templates.editor\')"\n                    />\n                    {% endblock %}\n\n                    \n                    {% block sw_mail_header_footer_basic_form_sales_channels_field %}\n                    <sw-entity-multi-select\n                        id="salesChannels"\n                        v-model="mailHeaderFooter.salesChannels"\n                        class="sw-mail-header-footer-detail__sales-channel"\n                        :label="$tc(\'sw-mail-header-footer.detail.basic.labelSalesChannels\')"\n                        :placeholder="$tc(\'sw-mail-header-footer.detail.basic.placeholderSalesChannels\')"\n                        :disabled="!acl.can(\'mail_templates.editor\')"\n                    />\n                    {% endblock %}\n                </sw-card>\n                {% endblock %}\n\n                \n                {% block sw_mail_header_footer_detail_content_header %}\n                <sw-card\n                    :title="$tc(\'sw-mail-header-footer.detail.header.titleCard\')"\n                    position-identifier="sw-mail-header-footer-detail-content-header"\n                >\n                    \n                    {% block sw_mail_header_footer_detail_content_header_plain_field %}\n                    <sw-code-editor\n                        v-model="mailHeaderFooter.headerPlain"\n                        identifier="header_plain"\n                        name="header_plain"\n                        completion-mode="entity"\n                        :label="$tc(\'sw-mail-header-footer.detail.header.labelPlain\')"\n                        :placeholder="placeholder(mailHeaderFooter, \'headerPlain\', $tc(\'sw-mail-header-footer.detail.header.placeholderPlain\'))"\n                        :completer-function="completerFunction"\n                        :editor-config="editorConfig"\n                        :disabled="!acl.can(\'mail_templates.editor\')"\n                    />\n                    {% endblock %}\n\n                    \n                    {% block sw_mail_header_footer_detail_content_header_html_field %}\n                    <sw-code-editor\n                        v-model="mailHeaderFooter.headerHtml"\n                        identifier="header_html"\n                        name="header_html"\n                        completion-mode="entity"\n                        :label="$tc(\'sw-mail-header-footer.detail.header.labelHtml\')"\n                        :placeholder="placeholder(mailHeaderFooter, \'headerHtml\', $tc(\'sw-mail-header-footer.detail.header.placeholderHtml\'))"\n                        :completer-function="completerFunction"\n                        :editor-config="editorConfig"\n                        :disabled="!acl.can(\'mail_templates.editor\')"\n                    />\n                    {% endblock %}\n                </sw-card>\n                {% endblock %}\n\n                \n                {% block sw_mail_header_footer_detail_content_footer %}\n                <sw-card\n                    :title="$tc(\'sw-mail-header-footer.detail.footer.titleCard\')"\n                    position-identifier="sw-mail-header-footer-detail-content-footer"\n                >\n                    \n                    {% block sw_mail_header_footer_detail_content_footer_plain_field %}\n                    <sw-code-editor\n                        v-model="mailHeaderFooter.footerPlain"\n                        identifier="footer_plain"\n                        name="footer_plain"\n                        completion-mode="entity"\n                        :label="$tc(\'sw-mail-header-footer.detail.footer.labelPlain\')"\n                        :placeholder="placeholder(mailHeaderFooter, \'footerPlain\', $tc(\'sw-mail-header-footer.detail.footer.placeholderPlain\'))"\n                        :completer-function="completerFunction"\n                        :editor-config="editorConfig"\n                        :disabled="!acl.can(\'mail_templates.editor\')"\n                    />\n                    {% endblock %}\n\n                    \n                    {% block sw_mail_header_footer_detail_content_footer_html_field %}\n                    <sw-code-editor\n                        v-model="mailHeaderFooter.footerHtml"\n                        identifier="footer_html"\n                        name="footer_html"\n                        completion-mode="entity"\n                        :label="$tc(\'sw-mail-header-footer.detail.footer.labelHtml\')"\n                        :placeholder="placeholder(mailHeaderFooter, \'footerHtml\', $tc(\'sw-mail-header-footer.detail.footer.placeholderHtml\'))"\n                        :completer-function="completerFunction"\n                        :editor-config="editorConfig"\n                        :disabled="!acl.can(\'mail_templates.editor\')"\n                    />\n                    {% endblock %}\n                </sw-card>\n                {% endblock %}\n            </template>\n        </sw-card-view>\n\n        <sw-modal\n            v-if="showModal"\n            :title="$tc(\'sw-mail-header-footer.modal.title\')"\n            @modal-close="onClose"\n        >\n            <div>{{ $tc(\'sw-mail-header-footer.modal.mainContent\') }}</div>\n            <div>{{ $tc(\'sw-mail-header-footer.modal.affectedList\') }}</div>\n            <div class="sw-mail-header-footer-detail__sales-channel-list">\n                <div\n                    v-for="salesChannel in alreadyAssignedSalesChannels"\n                    :key="salesChannel.translated.name"\n                    class="sw-mail-header-footer-detail__sales-channel-list-entry"\n                >\n                    {{ salesChannel.translated.name }}\n                </div>\n            </div>\n\n            <template #modal-footer>\n                <sw-button @click="onClose">\n                    {{ $tc(\'global.default.cancel\') }}\n                </sw-button>\n                <sw-button-process\n                    :is-loading="isLoading"\n                    :process-success="isSaveSuccessful"\n                    variant="primary"\n                    @click="confirmSave"\n                >\n                    {{ $tc(\'global.default.save\') }}\n                </sw-button-process>\n            </template>\n        </sw-modal>\n    </template>\n    {% endblock %}\n</sw-page>\n{% endblock %}\n',inject:["entityMappingService","repositoryFactory","acl"],mixins:[m.getByName("placeholder"),m.getByName("notification")],shortcuts:{"SYSTEMKEY+S":{active:function(){return this.allowSave},method:"onSave"},ESCAPE:"onCancel"},data:function(){return{mailHeaderFooter:null,mailHeaderFooterId:null,isLoading:!0,isSaveSuccessful:!1,editorConfig:{enableBasicAutocompletion:!0},showModal:!1,alreadyAssignedSalesChannels:[]}},metaInfo:function(){return{title:this.$createTitle(this.identifier)}},computed:c(c({},p("mailHeaderFooter",["name"])),{},{identifier:function(){return this.placeholder(this.mailHeaderFooter,"name")},mailHeaderFooterRepository:function(){return this.repositoryFactory.create("mail_header_footer")},mailHeaderFooterCriteria:function(){var e=new h(1,25);return e.addAssociation("salesChannels"),e},salesChannelRepository:function(){return this.repositoryFactory.create("sales_channel")},completerFunction:function(){return e=this.entityMappingService,function(a){var n=[];return Object.keys(e.getEntityMapping(a,{salesChannel:"sales_channel"})).forEach((function(e){n.push({value:e})})),n};var e},allowSave:function(){return this.mailHeaderFooter&&this.mailHeaderFooter.isNew()?this.acl.can("mail_templates.creator"):this.acl.can("mail_templates.editor")},tooltipSave:function(){if(!this.allowSave)return{message:this.$tc("sw-privileges.tooltip.warning"),disabled:this.allowSave,showOnDisabledElements:!0};var e=this.$device.getSystemKey();return{message:"".concat(e," + S"),appearance:"light"}}}),watch:{"$route.params.id":function(){this.createdComponent()}},created:function(){this.createdComponent()},methods:{onClose:function(){this.showModal=!1,this.isLoading=!1},createdComponent:function(){var e=this;return o()(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.$route.params.id){a.next=4;break}return e.mailHeaderFooterId=e.$route.params.id,a.next=4,e.loadEntityData();case 4:e.isLoading=!1;case 5:case"end":return a.stop()}}),a)})))()},loadEntityData:function(){var e=this;return o()(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.isLoading=!0,a.next=3,e.mailHeaderFooterRepository.get(e.mailHeaderFooterId,Shopware.Context.api,e.mailHeaderFooterCriteria);case 3:e.mailHeaderFooter=a.sent,e.isLoading=!1;case 5:case"end":return a.stop()}}),a)})))()},abortOnLanguageChange:function(){return this.this.mailHeaderFooterRepository.hasChanges(this.mailHeaderFooter)},saveOnLanguageChange:function(){return this.onSave()},onChangeLanguage:function(){this.loadEntityData()},saveFinish:function(){this.isSaveSuccessful=!1},onCancel:function(){this.$router.push({name:"sw.mail.template.index"})},onSave:function(){var e=this;return o()(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.isSaveSuccessful=!1,e.isLoading=!0,!(e.mailHeaderFooter.salesChannels.length>0)){a.next=5;break}return a.next=5,e.findAlreadyAssignedSalesChannels();case 5:if(!e.alreadyAssignedSalesChannels.length){a.next=9;break}return e.showModal=!0,e.isLoading=!1,a.abrupt("return");case 9:return a.next=11,e.confirmSave();case 11:case"end":return a.stop()}}),a)})))()},confirmSave:function(){var e=this;return o()(s.a.mark((function a(){var n;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e.isLoading=!0,a.next=4,e.mailHeaderFooterRepository.save(e.mailHeaderFooter);case 4:return a.next=6,e.loadEntityData();case 6:e.isSaveSuccessful=!0,a.next=14;break;case 9:a.prev=9,a.t0=a.catch(0),n={message:e.$tc("global.notification.notificationSaveErrorMessageRequiredFieldsInvalid")},e.createNotificationError(n),f(a.t0);case 14:return a.prev=14,e.isLoading=!1,e.showModal=!1,a.finish(14);case 18:case"end":return a.stop()}}),a,null,[[0,9,14,18]])})))()},findAlreadyAssignedSalesChannels:function(){var e=this;return o()(s.a.mark((function a(){var n,t,o;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=new h(1,25),t=[],e.mailHeaderFooter.salesChannels.forEach((function(e){t.push(e.id)})),n.addFilter(h.equalsAny("id",t)),a.next=6,e.salesChannelRepository.search(n);case 6:o=a.sent,e.alreadyAssignedSalesChannels=o.reduce((function(a,n){return null===n.mailHeaderFooterId||(e.mailHeaderFooterId||a.push(n),e.mailHeaderFooterId&&n.mailHeaderFooterId!==e.mailHeaderFooterId&&a.push(n)),a}),[]);case 8:case"end":return a.stop()}}),a)})))()}}}},"eV1/":function(e,a,n){var t=n("qM1b");t.__esModule&&(t=t.default),"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);(0,n("ydqr").default)("d3717414",t,!0,{})},qM1b:function(e,a,n){}}]);