(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[555],{QEv7:function(e,t,n){"use strict";n.r(t);var i=Shopware.Mixin,a=Shopware.Data.Criteria;t.default={template:'\n{% block sw_mail_header_footer_list_grid %}\n<sw-card\n    :title="$tc(\'sw-mail-header-footer.list.textMailHeaderFooterOverview\')"\n    position-identifier="sw-mail-header-footer-list"\n>\n\n    \n    {% block sw_mail_header_footer_list_grid_empty_state %}\n    <sw-empty-state\n        v-if="!isLoading && !showListing"\n        :title="$tc(\'sw-mail-header-footer.list.emptyStateTitle\')"\n        :subline="$tc(\'sw-mail-header-footer.list.emptyStateSubTitle\')"\n        :absolute="false"\n    >\n\n        \n        {% block sw_mail_header_footer_list_grid_empty_state_icon %}\n        <template #icon>\n            <img\n                :src="\'/administration/static/img/empty-states/settings-empty-state.svg\' | asset"\n                :alt="$tc(\'sw-mail-header-footer.list.emptyStateTitle\')"\n            >\n        </template>\n        {% endblock %}\n\n    </sw-empty-state>\n    {% endblock %}\n\n    \n    {% block sw_mail_template_list_grid %}\n    <template #grid>\n        <sw-entity-listing\n            v-if="isLoading || showListing"\n            id="mailHeaderFooterGrid"\n            ref="listing"\n            class="sw-mail-templates-list-grid"\n            detail-route="sw.mail.template.detail_head_foot"\n            identifier="sw-mail-header-footer-list"\n            :items="mailHeaderFooters"\n            :columns="getListColumns()"\n            :repository="mailHeaderFooterRepository"\n            :full-page="false"\n            :is-loading="isLoading"\n            :allow-view="acl.can(\'mail_templates.viewer\')"\n            :allow-edit="acl.can(\'mail_templates.editor\')"\n            :allow-delete="acl.can(\'mail_templates.deleter\')"\n            :show-selection="acl.can(\'mail_templates.deleter\')"\n            :skeleton-item-amount="skeletonItemAmount"\n            @update-records="updateRecords"\n        >\n            <template #column-salesChannels.name="{ item }">\n                \n                {% block sw_mail_template_list_columns_sales_channels_label %}\n                {{ getSalesChannelsString(item) }}\n                {% endblock %}\n            </template>\n\n            <template #bulk-modal-delete-items>\n                <sw-button\n                    variant="danger"\n                    size="small"\n                    @click="onMultipleDelete"\n                >\n                    {{ $tc(\'global.default.delete\') }}\n                </sw-button>\n            </template>\n\n            <template #delete-modal-delete-item="{ item }">\n                <sw-button\n                    variant="danger"\n                    size="small"\n                    @click="onDelete(item)"\n                >\n                    {{ $tc(\'global.default.delete\') }}\n                </sw-button>\n            </template>\n\n            <template #more-actions="{ item }">\n                \n                {% block sw_mail_header_footer_list_grid_columns_actions_duplicate %}\n                <sw-context-menu-item\n                    class="sw-mail-header-footer-list-grid__duplicate-action"\n                    :disabled="!acl.can(\'mail_templates.creator\')"\n                    @click="onDuplicate(item.id)"\n                >\n                    {{ $tc(\'sw-mail-header-footer.list.contextMenuDuplicate\') }}\n                </sw-context-menu-item>\n                {% endblock %}\n            </template>\n        </sw-entity-listing>\n    </template>\n    {% endblock %}\n\n</sw-card>\n{% endblock %}\n',inject:["repositoryFactory","acl"],mixins:[i.getByName("listing"),i.getByName("notification")],props:{searchTerm:{type:String,required:!1,default:""}},data:function(){return{mailHeaderFooters:null,showDeleteModal:null,isLoading:!1}},computed:{mailHeaderFooterRepository:function(){return this.repositoryFactory.create("mail_header_footer")},skeletonItemAmount:function(){return this.mailHeaderFooters&&0!==this.mailHeaderFooters.length?this.mailHeaderFooters.length:3},showListing:function(){return!!this.mailHeaderFooters&&0!==this.mailHeaderFooters.length}},watch:{searchTerm:function(){this.getList()}},methods:{onEdit:function(e){null!=e&&e.id&&this.$router.push({name:"sw.mail.template.detail_head_foot",params:{id:e.id}})},getList:function(){var e=this;this.isLoading=!0;var t=new a(this.page,this.limit);t.addAssociation("salesChannels").addSorting(a.sort("name")),this.searchTerm&&t.setTerm(this.searchTerm),this.mailHeaderFooterRepository.search(t).then((function(t){return e.total=t.total,e.mailHeaderFooters=t,e.isLoading=!1,e.mailHeaderFooters}))},getListColumns:function(){return[{property:"name",dataIndex:"name",label:"sw-mail-header-footer.list.columnName",allowResize:!0,routerLink:"sw.mail.template.detail_head_foot",primary:!0},{property:"description",dataIndex:"description",label:"sw-mail-header-footer.list.columnDescription",allowResize:!0},{property:"salesChannels.name",dataIndex:"salesChannels.name",label:"sw-mail-header-footer.list.columnSalesChannels",allowResize:!0,sortable:!1}]},getSalesChannelsString:function(e){if(void 0===e.salesChannels)return"";var t="";return e.salesChannels.forEach((function(e){""!==t&&(t+=", "),t+="".concat(e.translated.name)})),e.salesChannels.length>=5&&(t+="..."),t},onDuplicate:function(e){var t=this;this.mailHeaderFooterRepository.clone(e).then((function(e){t.$router.push({name:"sw.mail.template.detail_head_foot",params:{id:e.id}})}))},checkCanBeDeleted:function(e){return!e.salesChannels.length},onDelete:function(e){var t=this;return this.$refs.listing.deleteId=null,this.checkCanBeDeleted(e)||this.showDeleteErrorNotification(e),this.mailHeaderFooterRepository.delete(e.id).then((function(){t.$refs.listing.resetSelection(),t.$refs.listing.doSearch()}))},getMailHeaderFooterCriteria:function(e){var t=new a(1,25);return t.addFilter(a.equalsAny("id",e)),t.addAssociation("salesChannels"),t},onMultipleDelete:function(){var e=this,t=Object.values(this.$refs.listing.selection).map((function(e){return e.id}));this.mailHeaderFooterRepository.search(this.getMailHeaderFooterCriteria(t)).then((function(t){t.forEach((function(t){e.checkCanBeDeleted(t)||e.showDeleteErrorNotification(t)})),e.$refs.listing.deleteItems()}))},showDeleteErrorNotification:function(e){return this.createNotificationError({message:this.$tc("sw-mail-header-footer.list.messageDeleteError",0,{name:e.name})})},updateRecords:function(e){this.mailHeaderFooters=e}}}}}]);