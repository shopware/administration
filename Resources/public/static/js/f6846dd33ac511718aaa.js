(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[554],{"gx/6":function(t,e,n){"use strict";n.r(e);var o=n("CsSd"),i=n.n(o);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var r=Shopware,s=r.Component,c=r.Mixin,g=r.Context,d=Shopware.Classes.ShopwareError,u=Shopware.Data,f=u.EntityCollection,h=u.Criteria,w=s.getComponentHelper().mapState;e.default={template:'\n{% block sw_flow_tag_modal %}\n<sw-modal\n    class="sw-flow-tag-modal"\n    :title="tagTitle"\n    :closable="false"\n    @modal-close="onClose"\n>\n    \n    {% block sw_flow_tag_modal_content %}\n    <div class="sw-flow-tag-modal__content">\n        \n        {% block sw_flow_tag_modal_to_field %}\n        <sw-single-select\n            {% if VUE3 %}\n            v-model:value="entity"\n            {% else %}\n            v-model="entity"\n            {% endif %}\n            class="sw-flow-tag-modal__to-field"\n            required\n            show-clearable-button\n            :label="$tc(\'sw-flow.modals.tag.labelToField\')"\n            :placeholder="$tc(\'sw-flow.modals.tag.placeholderToField\')"\n            :error="entityError"\n            :options="entityOptions"\n        />\n        {% endblock %}\n\n        \n        {% block sw_flow_tag_modal_tags_field %}\n        <sw-entity-tag-select\n            v-model="tagCollection"\n            class="sw-flow-tag-modal__tags-field"\n            required\n            :label="$tc(\'sw-flow.modals.tag.labelTagsField\')"\n            :placeholder="$tc(\'sw-flow.modals.tag.placeholderTagsField\')"\n            :error="tagError"\n            @item-add="onAddTag"\n            @item-remove="onRemoveTag"\n        />\n        {% endblock %}\n\n        \n        {% block sw_flow_tag_modal_content_custom %}\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    <template #modal-footer>\n        \n        {% block sw_flow_tag_modal_footer_cancel_button %}\n        <sw-button\n            class="sw-flow-tag-modal__cancel-button"\n            size="small"\n            @click="onClose"\n        >\n            {{ $tc(\'global.default.cancel\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_flow_tag_modal_footer_save_button %}\n        <sw-button\n            class="sw-flow-tag-modal__save-button"\n            variant="primary"\n            size="small"\n            @click="onSaveTag"\n        >\n            {{ isNewTag ? $tc(\'sw-flow.modals.buttonAddAction\') : $tc(\'sw-flow.modals.buttonSaveAction\') }}\n        </sw-button>\n        {% endblock %}\n    </template>\n</sw-modal>\n{% endblock %}\n',inject:["acl","repositoryFactory","flowBuilderService"],mixins:[c.getByName("placeholder"),c.getByName("notification")],props:{sequence:{type:Object,required:!0},action:{type:String,required:!1,default:null}},data:function(){return{isLoading:!1,entity:null,entityOptions:[],tagCollection:null,tagError:null,entityError:null}},computed:a({tagCriteria:function(){var t=new h(1,25),e=this.sequence.config,n=Object.keys(e.tagIds);return n.length&&t.addFilter(h.equalsAny("id",n)),t},isNewTag:function(){var t;return!(null!==(t=this.sequence)&&void 0!==t&&t.id)},tagRepository:function(){return this.repositoryFactory.create("tag")},tagTitle:function(){return this.action?this.action.match(/add.*tag/)?this.$tc("sw-flow.modals.tag.labelAddTag"):this.action.match(/remove.*tag/)?this.$tc("sw-flow.modals.tag.labelRemoveTag"):"":""}},w("swFlowState",["triggerEvent","triggerActions"])),watch:{entity:function(t){t&&this.entityError&&(this.entityError=null)},tagCollection:function(t){t&&this.tagError&&(this.tagError=null)}},created:function(){this.createdComponent()},methods:{createdComponent:function(){this.getEntityOptions(),this.tagCollection=this.createTagCollection();var t=this.sequence,e=t.config,n=t.id;null!=e&&e.entity&&(this.entity=null==e?void 0:e.entity),n&&null!=e&&e.tagIds&&this.getTagCollection()},getTagCollection:function(){var t=this;return this.tagRepository.search(this.tagCriteria).then((function(e){t.tagCollection=e})).catch((function(){t.tagCollection=[]}))},createTagCollection:function(){return new f(this.tagRepository.route,this.tagRepository.entityName,g.api)},onAddTag:function(t){this.tagCollection.add(t)},onRemoveTag:function(t){this.tagCollection.remove(t)},getEntityOptions:function(){var t;if(this.triggerEvent){var e=null!==(t=this.triggerEvent.aware)&&void 0!==t?t:[],n=this.flowBuilderService.getAvailableEntities(this.action,this.triggerActions,e,["tags"]);n.length&&(this.entity=n[0].value),this.entityOptions=n}else this.entityOptions=[]},getConfig:function(){var t={};return this.tagCollection.forEach((function(e){Object.assign(t,i()({},e.id,e.name))})),{entity:this.entity,tagIds:t}},fieldError:function(t){return t&&t.length?null:new d({code:"c1051bb4-d103-4f74-8988-acbcafc7fdc3"})},onSaveTag:function(){if(this.tagError=this.fieldError(this.tagCollection),this.entityError=this.fieldError(this.entity),!this.tagError&&!this.entityError){var t=this.getConfig(),e=a(a({},this.sequence),{},{config:t});this.$emit("process-finish",e),this.onClose()}},onClose:function(){this.tagError=null,this.$emit("modal-close")}}}}}]);
//# sourceMappingURL=f6846dd33ac511718aaa.js.map