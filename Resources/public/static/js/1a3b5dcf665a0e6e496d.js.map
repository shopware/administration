{"version":3,"sources":["webpack:///./src/module/sw-import-export/component/sw-import-export-importer/sw-import-export-importer.html.twig","webpack:///./src/module/sw-import-export/component/sw-import-export-importer/index.js","webpack:///./src/module/sw-import-export/component/sw-import-export-importer/sw-import-export-importer.scss"],"names":["Mixin","Shopware","Criteria","Data","template","inject","mixins","getByName","props","sourceEntity","type","String","required","default","data","selectedProfileId","selectedProfile","config","isLoading","importFile","importModalProfile","computed","profileCriteria","criteria","addSorting","sort","this","length","addFilter","equals","not","logRepository","repositoryFactory","create","disableImporting","showProductVariantsInfo","includeVariants","logCriteria","addAssociation","methods","onProfileSelect","profileId","profile","onStartProcess","_this","dryRun","arguments","undefined","importExport","import","handleProgress","then","catch","error","response","errors","forEach","singleError","createNotificationError","message","concat","code","detail","onStartDryRunProcess","log","createNotificationInfo","$tc","$emit","setImportModalProfile","profileName","content","__esModule","module","i","locals","exports","add"],"mappings":"+JAAe,ICMPA,EAAUC,SAAVD,MACAE,EAAaD,SAASE,KAAtBD,SAKO,WACXE,SDbW,mjJCeXC,OAAQ,CAAC,eAAgB,oBAAqB,WAE9CC,OAAQ,CACJN,EAAMO,UAAU,iBAGpBC,MAAO,CACHC,aAAc,CACVC,KAAMC,OACNC,UAAU,EACVC,QAAS,KAIjBC,KAAI,WACA,MAAO,CACHC,kBAAmB,KACnBC,gBAAiB,KACjBC,OAAQ,GACRC,WAAW,EACXC,WAAY,KACZC,mBAAoB,OAI5BC,SAAU,CACNC,gBAAe,WACX,IAAMC,EAAW,IAAIrB,EAAS,EAAG,IAUjC,OATAqB,EAASC,WAAWtB,EAASuB,KAAK,UAE9BC,KAAKjB,aAAakB,OAAS,GAC3BJ,EAASK,UACL1B,EAAS2B,OAAO,eAAgBH,KAAKjB,eAG7Cc,EAASK,UAAU1B,EAAS4B,IAAI,MAAO,CAAC5B,EAAS2B,OAAO,OAAQ,aAEzDN,GAGXQ,cAAa,WACT,OAAOL,KAAKM,kBAAkBC,OAAO,sBAGzCC,iBAAgB,WACZ,OAAOR,KAAKR,WAAwC,OAA3BQ,KAAKX,mBAAkD,OAApBW,KAAKP,YAGrEgB,wBAAuB,WACnB,OAAOT,KAAKV,iBAC8B,YAAtCU,KAAKV,gBAAgBP,cACrBiB,KAAKT,QACLS,KAAKT,OAAOmB,iBAGpBC,YAAW,WACP,IAAMd,EAAW,IAAIrB,EAAS,EAAG,IAKjC,OAHAqB,EAASe,eAAe,qBACxBf,EAASe,eAAe,QAEjBf,IAIfgB,QAAS,CACLC,gBAAe,SAACC,EAAWC,GACvBhB,KAAKX,kBAAoB0B,EACzBf,KAAKV,gBAAkB0B,GAG3BC,eAAc,WAAkB,IAADC,EAAA,KAAhBC,EAAMC,UAAAnB,OAAA,QAAAoB,IAAAD,UAAA,IAAAA,UAAA,GACjBpB,KAAKR,WAAY,EAEjB,IAAMwB,EAAUhB,KAAKX,kBAErBW,KAAKsB,aAAaC,OAAOP,EAAShB,KAAKP,WAAYO,KAAKwB,eAAgBxB,KAAKT,OAAQ4B,GAAQM,MAAK,WAC9FP,EAAKzB,WAAa,QACnBiC,OAAM,SAACC,GACDA,EAAMC,UAAaD,EAAMC,SAASxC,MAASuC,EAAMC,SAASxC,KAAKyC,OAKhEF,EAAMC,SAASxC,KAAKyC,OAAOC,SAAQ,SAACC,GAChCb,EAAKc,wBAAwB,CACzBC,QAAQ,GAADC,OAAKH,EAAYI,KAAI,MAAAD,OAAKH,EAAYK,aANrDlB,EAAKc,wBAAwB,CACzBC,QAASN,EAAMM,UAUvBf,EAAK1B,WAAY,MAIzB6C,qBAAoB,WAChBrC,KAAKiB,gBAAe,IAGxBO,eAAc,SAACc,GACXtC,KAAKuC,uBAAuB,CACxBN,QAASjC,KAAKwC,IAAI,oDAGtBxC,KAAKR,WAAY,EACjBQ,KAAKyC,MAAM,iBAAkBH,IAGjCI,sBAAqB,SAACC,GAClB3C,KAAKN,mBAAqBiD,M,qBCzHtC,IAAIC,EAAU,EAAQ,QACnBA,EAAQC,aAAYD,EAAUA,EAAQzD,SACnB,iBAAZyD,IAAsBA,EAAU,CAAC,CAACE,EAAOC,EAAIH,EAAS,MAC7DA,EAAQI,SAAQF,EAAOG,QAAUL,EAAQI,SAG/BE,EADH,EAAQ,QAAwE/D,SACzE,WAAYyD,GAAS,EAAM","file":"static/js/1a3b5dcf665a0e6e496d.js","sourcesContent":["export default \"\\n{% block sw_import_export_importer %}\\n<div class=\\\"sw-import-export-importer\\\">\\n    \\n    {% block sw_import_export_importer_upload_csv_label %}\\n    <h2>{{ $tc('sw-import-export.importer.uploadCsvLabel') }}</h2>\\n    {% endblock %}\\n\\n    \\n    {% block sw_import_export_importer_warning_block %}\\n    <p><span v-html=\\\"$tc('sw-import-export.importer.warningBlock')\\\"></span></p>\\n    {% endblock %}\\n\\n    \\n    {% block sw_import_export_importer_file_input %}\\n    <sw-file-input\\n        :key=\\\"isLoading\\\"\\n        {% if VUE3 %}\\n        v-model:value=\\\"importFile\\\"\\n        {% else %}\\n        v-model=\\\"importFile\\\"\\n        {% endif %}\\n    >\\n        <template #caption-label>\\n            {{ $tc('sw-import-export.importer.labelUploadCaption') }}\\n        </template>\\n    </sw-file-input>\\n    {% endblock %}\\n\\n    \\n    {% block sw_import_export_importer_select_profile_label %}\\n    <h2>{{ $tc('sw-import-export.importer.selectProfileLabel') }}</h2>\\n    {% endblock %}\\n\\n    \\n    {% block sw_import_export_importer_profile_select %}\\n    <sw-entity-single-select\\n        class=\\\"sw-import-export-importer__profile-select\\\"\\n        :disabled=\\\"isLoading\\\"\\n        :label=\\\"$tc('sw-import-export.importer.profileLabel')\\\"\\n        entity=\\\"import_export_profile\\\"\\n        label-property=\\\"label\\\"\\n        :criteria=\\\"profileCriteria\\\"\\n        :value=\\\"selectedProfileId\\\"\\n        required\\n        {% if VUE3 %}\\n        @update:value=\\\"onProfileSelect\\\"\\n        {% else %}\\n        @change=\\\"onProfileSelect\\\"\\n        {% endif %}\\n    />\\n    {% endblock %}\\n\\n    <template v-if=\\\"selectedProfile && selectedProfile.sourceEntity === 'product'\\\">\\n        \\n        {% block sw_import_export_importer_profile_select_product_variants_switch %}\\n        <sw-switch-field\\n            {% if VUE3 %}\\n            v-model:value=\\\"config.includeVariants\\\"\\n            {% else %}\\n            v-model=\\\"config.includeVariants\\\"\\n            {% endif %}\\n            class=\\\"sw-import-export-importer__variants-switch-field\\\"\\n            :label=\\\"$tc('sw-import-export.importer.importVariants')\\\"\\n        />\\n        {% endblock %}\\n    </template>\\n\\n    <template v-if=\\\"showProductVariantsInfo\\\">\\n        \\n        {% block sw_import_export_importer_product_variants_warning %}\\n        <sw-alert\\n            variant=\\\"warning\\\"\\n            class=\\\"sw-import-export-importer__variants-warning\\\"\\n        >\\n            \\n            {% block sw_import_export_importer_product_variants_warning_text %}\\n            <p>\\n                <span v-html=\\\"$tc('sw-import-export.importer.variantsWarning')\\\"></span>\\n            </p>\\n            <p>\\n                <a\\n                    href=\\\"#\\\"\\n                    class=\\\"sw-import-export-importer__link\\\"\\n                    @click.prevent=\\\"setImportModalProfile('product_configurator_setting')\\\"\\n                >\\n                    {{ $tc('sw-import-export.importer.directImportVariantsLabel') }}\\n                </a>\\n                <br>\\n                <a\\n                    href=\\\"#\\\"\\n                    class=\\\"sw-import-export-importer__link\\\"\\n                    @click.prevent=\\\"setImportModalProfile('property_group_option')\\\"\\n                >\\n                    {{ $tc('sw-import-export.importer.directImportPropertiesLabel') }}\\n                </a>\\n            </p>\\n            {% endblock %}\\n        </sw-alert>\\n        {% endblock %}\\n    </template>\\n\\n    \\n    {% block sw_import_export_importer_modal %}\\n    <sw-modal\\n        v-if=\\\"importModalProfile\\\"\\n        :title=\\\"$tc('sw-import-export.importer.importLabel')\\\"\\n        @modal-close=\\\"setImportModalProfile(null)\\\"\\n    >\\n        \\n        {% block sw_import_export_importer_modal_exporter %}\\n        <sw-import-export-importer\\n            :source-entity=\\\"importModalProfile\\\"\\n            @import-started=\\\"$emit('import-started', $event)\\\"\\n        />\\n        {% endblock %}\\n\\n        <template #modal-footer>\\n            \\n            {% block sw_import_export_importer_modal_footer %}\\n            <sw-button\\n                size=\\\"small\\\"\\n                @click=\\\"setImportModalProfile(null)\\\"\\n            >\\n                {{ $tc('sw-import-export.importer.close') }}\\n            </sw-button>\\n            {% endblock %}\\n        </template>\\n    </sw-modal>\\n    {% endblock %}\\n\\n    \\n    {% block sw_import_export_importer_progress %}\\n    <sw-import-export-progress\\n        activity-type=\\\"import\\\"\\n        :disable-button=\\\"disableImporting\\\"\\n        @process-start=\\\"onStartProcess\\\"\\n        @process-start-dryrun=\\\"onStartDryRunProcess\\\"\\n    />\\n    {% endblock %}\\n</div>\\n{% endblock %}\\n\";","/**\n * @package services-settings\n */\nimport template from './sw-import-export-importer.html.twig';\nimport './sw-import-export-importer.scss';\n\nconst { Mixin } = Shopware;\nconst { Criteria } = Shopware.Data;\n\n/**\n * @private\n */\nexport default {\n    template,\n\n    inject: ['importExport', 'repositoryFactory', 'feature'],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        sourceEntity: {\n            type: String,\n            required: false,\n            default: '',\n        },\n    },\n\n    data() {\n        return {\n            selectedProfileId: null,\n            selectedProfile: null,\n            config: {},\n            isLoading: false,\n            importFile: null,\n            importModalProfile: null,\n        };\n    },\n\n    computed: {\n        profileCriteria() {\n            const criteria = new Criteria(1, 25);\n            criteria.addSorting(Criteria.sort('label'));\n\n            if (this.sourceEntity.length > 0) {\n                criteria.addFilter(\n                    Criteria.equals('sourceEntity', this.sourceEntity),\n                );\n            }\n            criteria.addFilter(Criteria.not('AND', [Criteria.equals('type', 'export')]));\n\n            return criteria;\n        },\n\n        logRepository() {\n            return this.repositoryFactory.create('import_export_log');\n        },\n\n        disableImporting() {\n            return this.isLoading || this.selectedProfileId === null || this.importFile === null;\n        },\n\n        showProductVariantsInfo() {\n            return this.selectedProfile &&\n                this.selectedProfile.sourceEntity === 'product' &&\n                this.config &&\n                this.config.includeVariants;\n        },\n\n        logCriteria() {\n            const criteria = new Criteria(1, 25);\n\n            criteria.addAssociation('invalidRecordsLog');\n            criteria.addAssociation('file');\n\n            return criteria;\n        },\n    },\n\n    methods: {\n        onProfileSelect(profileId, profile) {\n            this.selectedProfileId = profileId;\n            this.selectedProfile = profile;\n        },\n\n        onStartProcess(dryRun = false) {\n            this.isLoading = true;\n\n            const profile = this.selectedProfileId;\n\n            this.importExport.import(profile, this.importFile, this.handleProgress, this.config, dryRun).then(() => {\n                this.importFile = null;\n            }).catch((error) => {\n                if (!error.response || !error.response.data || !error.response.data.errors) {\n                    this.createNotificationError({\n                        message: error.message,\n                    });\n                } else {\n                    error.response.data.errors.forEach((singleError) => {\n                        this.createNotificationError({\n                            message: `${singleError.code}: ${singleError.detail}`,\n                        });\n                    });\n                }\n\n                this.isLoading = false;\n            });\n        },\n\n        onStartDryRunProcess() {\n            this.onStartProcess(true);\n        },\n\n        handleProgress(log) {\n            this.createNotificationInfo({\n                message: this.$tc('sw-import-export.importer.messageImportStarted'),\n            });\n\n            this.isLoading = false;\n            this.$emit('import-started', log);\n        },\n\n        setImportModalProfile(profileName) {\n            this.importModalProfile = profileName;\n        },\n    },\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-import-export-importer.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"09337cb6\", content, true, {});"],"sourceRoot":""}