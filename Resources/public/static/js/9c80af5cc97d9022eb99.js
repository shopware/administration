(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[202],{"8fDd":function(e,t,n){var s=n("H2xK");s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,n("P8hj").default)("61c4e8e7",s,!0,{})},E7lP:function(e,t,n){"use strict";n.r(t);var s=n("c1oF"),i=n.n(s),a=n("CsSd"),o=n.n(a),l=n("7yzw"),c=n.n(l),r=n("92Mt"),d=n.n(r),m=(n("8fDd"),Shopware.Mixin),u=Shopware.Data.Criteria;t.default={template:'\n{% block sw_cms_list %}\n<sw-page class="sw-cms-list">\n    \n    {% block sw_cms_list_search_bar %}\n    <template #search-bar>\n        <sw-search-bar\n            initial-search-type="cms_page"\n            :initial-search="term"\n            @search="onSearch"\n        />\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_cms_list_toolbar %}\n    <template #smart-bar-header>\n        <h2>{{ $tc(\'sw-cms.general.moduleTitle\') }}</h2>\n    </template>\n\n    <template #language-switch>\n        <sw-language-switch @on-change="onChangeLanguage" />\n    </template>\n\n    <template #smart-bar-actions>\n        <sw-button\n            v-tooltip="{\n                message: $tc(\'sw-privileges.tooltip.warning\'),\n                disabled: acl.can(\'cms.creator\'),\n                showOnDisabledElements: true\n            }"\n            variant="primary"\n            :disabled="!acl.can(\'cms.creator\')"\n            @click="onCreateNewLayout"\n        >\n            {{ $tc(\'sw-cms.general.createNewLayout\') }}\n        </sw-button>\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_cms_list_card_view %}\n    <template #content>\n        <sw-card-view>\n\n            \n            {% block sw_cms_list_content %}\n            <div class="sw-cms-list__content">\n                \n                {% block sw_cms_list_sidebar %}\n                <div class="sw-cms-list__sidebar">\n                    \n                    {% block sw_cms_list_sidebar_tabs %}\n                    <sw-tabs\n                        is-vertical\n                        small\n                        position-identifier="sw-cms-list-sidebar"\n                        class="sw-cms-list__type-nav"\n                    >\n                        <sw-tabs-item\n                            v-for="pageType in sortPageTypes"\n                            :key="pageType.name"\n                            :disabled="pageType.disabled"\n                            :active="pageType.active"\n                            @click="onSortPageType(pageType.value)"\n                        >\n                            {{ pageType.name }}\n                        </sw-tabs-item>\n                    </sw-tabs>\n                    {% endblock %}\n                </div>\n                {% endblock %}\n\n                \n                {% block sw_cms_list_listing %}\n                <div class="sw-cms-list__listing">\n\n                    \n                    {% block sw_cms_list_listing_actions %}\n                    <div class="sw-cms-list__actions">\n                        \n                        {% block sw_cms_list_listing_title %}\n                        <h3>{{ $tc(\'sw-cms.general.greeting\') }}</h3>\n                        {% endblock %}\n\n                        \n                        {% block sw_cms_list_listing_actions_sorting %}\n                        <div class="sw-cms-list__actions-sorting">\n\n                            \n                            {% block sw_cms_list_listing_actions_sorting_select %}\n                            <sw-sorting-select\n                                :sort-by="sortBy"\n                                :sort-direction="sortDirection"\n                                @sorting-changed="onSort"\n                            />\n                            {% endblock %}\n\n                        </div>\n                        {% endblock %}\n\n                        \n                        {% block sw_cms_list_listing_actions_mode %}\n                        <div\n                            class="sw-cms-list__actions-mode"\n                            role="button"\n                            tabindex="0"\n                            @click="onListModeChange"\n                            @keydown.enter="onListModeChange"\n                        >\n                            <sw-icon\n                                v-if="listMode === \'grid\'"\n                                name="regular-view-normal"\n                                size="16"\n                            />\n                            <sw-icon\n                                v-if="listMode === \'list\'"\n                                name="regular-view-grid"\n                                size="16"\n                            />\n                        </div>\n                        {% endblock %}\n                    </div>\n                    {% endblock %}\n\n                    \n                    {% block sw_cms_list_listing_list %}\n                    <div class="sw-cms-list__list">\n\n                        \n                        {% block sw_cms_list_listing_list_grid %}\n                        <div\n                            v-if="listMode === \'grid\'"\n                            class="sw-cms-list__list-grid"\n                        >\n\n                            \n                            {% block sw_cms_list_listing_list_grid_content %}\n                            <div class="sw-cms-list__list-grid-content">\n                                <template v-if="!isLoading">\n                                    \n                                    {% block sw_cms_list_listing_list_item %}\n                                    <sw-cms-list-item\n                                        v-for="(cmsPage, index) in pages"\n                                        :key="cmsPage.id"\n                                        :class="\'sw-cms-list-item--\' + index"\n                                        :page="cmsPage"\n                                        :active="layoutIsLinked(cmsPage.id)"\n                                        :is-default="[defaultProductId, defaultCategoryId].includes(cmsPage.id)"\n                                        @item-click="onListItemClick"\n                                        @preview-image-change="onPreviewChange"\n                                        @cms-page-delete="onDeleteCmsPage"\n                                    >\n                                        <template #contextMenu>\n                                            <sw-context-button class="sw-cms-list-item__options">\n                                                \n                                                {% block sw_cms_list_listing_list_item_option_add_preview %}\n                                                <sw-context-menu-item\n                                                    class="sw-cms-list-item__option-preview"\n                                                    :disabled="!acl.can(\'cms.editor\')"\n                                                    @click="onPreviewChange(cmsPage)"\n                                                >\n                                                    {{ $tc(\'sw-cms.components.cmsListItem.addPreviewImage\') }}\n                                                </sw-context-menu-item>\n                                                {% endblock %}\n\n                                                <sw-context-menu-item\n                                                    v-if="cmsPage.type === \'product_list\' && !(defaultCategoryId === cmsPage.id)"\n                                                    class="sw-cms-list-item__option-set-as-default"\n                                                    :disabled="!acl.can(\'system_config.editor\')"\n                                                    @click="onOpenLayoutSetAsDefault(cmsPage)"\n                                                >\n                                                    {{ $tc(\'sw-cms.components.cmsListItem.setAsDefaultProductList\') }}\n                                                </sw-context-menu-item>\n\n                                                \n                                                <sw-context-menu-item\n                                                    v-else-if="feature.isActive(\'v6.6.0.0\') && cmsPage.type === \'product_detail\' && !(defaultProductId === cmsPage.id)"\n                                                    class="sw-cms-list-item__option-set-as-default"\n                                                    :disabled="!acl.can(\'cms.editor\')"\n                                                    @click="onOpenLayoutSetAsDefault(cmsPage)"\n                                                >\n                                                    {{ $tc(\'sw-cms.components.cmsListItem.setAsDefaultProductDetail\') }}\n                                                </sw-context-menu-item>\n\n                                                \n                                                {% block sw_cms_list_listing_list_item_option_duplicate %}\n                                                <sw-context-menu-item\n                                                    :disabled="!acl.can(\'cms.creator\')"\n                                                    class="sw-cms-list-item__option-duplicate"\n                                                    @click="onDuplicateCmsPage(cmsPage)"\n                                                >\n                                                    {{ $tc(\'sw-cms.components.cmsListItem.duplicate\') }}\n                                                </sw-context-menu-item>\n                                                {% endblock %}\n\n                                                \n                                                {% block sw_cms_list_listing_list_item_option_remove_preview %}\n                                                <sw-context-menu-item\n                                                    v-if="cmsPage.previewMediaId"\n                                                    class="sw-cms-list-item__option-preview"\n                                                    variant="danger"\n                                                    :disabled="!acl.can(\'cms.editor\')"\n                                                    @click="onPreviewImageRemove(cmsPage)"\n                                                >\n                                                    {{ $tc(\'sw-cms.components.cmsListItem.removePreviewImage\') }}\n                                                </sw-context-menu-item>\n                                                {% endblock %}\n\n                                                \n                                                {% block sw_cms_list_listing_list_item_option_delete %}\n                                                <sw-context-menu-item\n                                                    v-if="!cmsPage.locked && !(defaultProductId === cmsPage.id || defaultCategoryId === cmsPage.id)"\n                                                    v-tooltip="deleteDisabledToolTip(cmsPage)"\n                                                    class="sw-cms-list-item__option-delete"\n                                                    variant="danger"\n                                                    :disabled="optionContextDeleteDisabled(cmsPage)"\n                                                    @click="onDeleteCmsPage(cmsPage)"\n                                                >\n                                                    {{ $tc(\'sw-cms.components.cmsListItem.delete\') }}\n                                                </sw-context-menu-item>\n                                            {% endblock %}\n\n                                            </sw-context-button>\n                                        </template>\n                                    </sw-cms-list-item>\n                                    {% endblock %}\n                                </template>\n\n                                <template v-else>\n                                    <sw-skeleton\n                                        v-for="index in 9"\n                                        :key="`cms-list-skeleton-${index}`"\n                                        variant="gallery"\n                                    />\n                                </template>\n                            </div>\n                            {% endblock %}\n\n                            \n                            {% block sw_cms_list_listing_pagination %}\n                            <sw-pagination\n                                v-if="!isLoading"\n                                class="sw-cms-list__list-pagination"\n                                :page="page"\n                                :limit="limit"\n                                :total="total"\n                                :steps="[9]"\n                                @page-change="onPageChange"\n                            />\n                            {% endblock %}\n                        </div>\n                        {% endblock %}\n\n                        \n                        {% block sw_cms_list_listing_list_card %}\n                        <sw-card\n                            v-else-if="listMode === \'list\'"\n                            position-identifier="sw-cms-list-list-mode"\n                            class="sw-cms-list__list-card"\n                        >\n                            <template #grid>\n                                \n                                {% block sw_cms_list_listing_list_data_grid %}\n                                <sw-data-grid\n                                    class="sw-cms-list__list-data-grid"\n                                    identifier="sw-cms-list"\n                                    :is-loading="isLoading"\n                                    :data-source="pages"\n                                    :columns="columnConfig"\n                                    :skeleton-item-amount="limit"\n                                    :sort-by="sortBy"\n                                    :sort-direction="sortDirection"\n                                    :allow-inline-edit="false"\n                                    :allow-column-edit="false"\n                                    show-settings\n                                    :show-selection="false"\n                                >\n\n                                    \n                                    {% block sw_cms_list_listing_list_data_grid_column_name %}\n                                    <template #column-name="{ item }">\n                                        <sw-icon\n                                            v-if="item.locked"\n                                            name="regular-lock"\n                                            class="sw-cms-list__icon-lock"\n                                            size="14"\n                                        />\n                                        <router-link :to="{ name: \'sw.cms.detail\', params: { id: item.id } }">\n                                            {{ item.translated.name }}\n                                        </router-link>\n                                    </template>\n                                    {% endblock %}\n\n                                    \n                                    {% block sw_cms_list_listing_list_data_grid_column_type %}\n                                    <template #column-type="{ item }">\n                                        {{ getPageType(item) }}\n                                    </template>\n                                    {% endblock %}\n\n                                    \n                                    {% block sw_cms_list_listing_list_data_grid_column_assignments %}\n                                    <template #column-assignments="{ item }">\n                                        {{ getPageCount(item) }}\n                                    </template>\n                                    {% endblock %}\n\n                                    \n                                    {% block sw_cms_list_listing_list_data_grid_column_created %}\n                                    <template #column-createdAt="{ item }">\n                                        {{ dateFilter(item.createdAt, { hour: \'2-digit\', minute: \'2-digit\' }) }}\n                                    </template>\n                                    {% endblock %}\n\n                                    \n                                    {% block sw_cms_list_listing_list_data_grid_column_updated %}\n                                    <template #column-updatedAt="{ item }">\n                                        {{ dateFilter(item.updatedAt, { hour: \'2-digit\', minute: \'2-digit\' }) }}\n                                    </template>\n                                    {% endblock %}\n\n                                    \n                                    {% block sw_cms_list_listing_list_data_grid_actions %}\n                                    <template #actions="{ item }">\n                                        \n                                        {% block sw_cms_list_listing_list_data_grid_actions_edit %}\n                                        <sw-context-menu-item\n                                            :router-link="{ name: \'sw.cms.detail\', params: { id: item.id } }"\n                                            class="sw-cms-list__context-menu-item-edit"\n                                            :disabled="!acl.can(\'cms.editor\')"\n                                        >\n                                            {{ $tc(\'sw-cms.components.cmsListItem.edit\') }}\n                                        </sw-context-menu-item>\n                                        {% endblock %}\n\n                                        <sw-context-menu-item\n                                            v-if="item.type === \'product_list\' && !(defaultCategoryId === item.id)"\n                                            class="sw-cms-list-item__option-set-as-default"\n                                            :disabled="!acl.can(\'system_config.editor\')"\n                                            @click="onOpenLayoutSetAsDefault(item)"\n                                        >\n                                            {{ $tc(\'sw-cms.components.cmsListItem.setAsDefaultProductList\') }}\n                                        </sw-context-menu-item>\n\n                                        <sw-context-menu-item\n                                            v-else-if="item.type === \'product_detail\' && !(defaultProductId === item.id)"\n                                            class="sw-cms-list-item__option-set-as-default"\n                                            :disabled="!acl.can(\'cms.editor\')"\n                                            @click="onOpenLayoutSetAsDefault(item)"\n                                        >\n                                            {{ $tc(\'sw-cms.components.cmsListItem.setAsDefaultProductDetail\') }}\n                                        </sw-context-menu-item>\n\n                                        \n                                        {% block sw_cms_list_listing_list_data_grid_actions_edit_duplicate %}\n                                        <sw-context-menu-item\n                                            :disabled="!acl.can(\'cms.creator\')"\n                                            class="sw-cms-list__context-menu-item-duplicate"\n                                            @click="onDuplicateCmsPage(item)"\n                                        >\n                                            {{ $tc(\'sw-cms.components.cmsListItem.duplicate\') }}\n                                        </sw-context-menu-item>\n                                        {% endblock %}\n\n                                        \n                                        {% block sw_cms_list_listing_list_item_option_rename %}\n                                        <sw-context-menu-item\n                                            v-if="!item.locked"\n                                            :disabled="!acl.can(\'cms.editor\')"\n                                            class="sw-cms-list__context-menu-item-rename"\n                                            @click="onRenameCmsPage(item)"\n                                        >\n                                            {{ $tc(\'sw-cms.components.cmsListItem.rename\') }}\n                                        </sw-context-menu-item>\n                                        {% endblock %}\n\n                                        \n                                        {% block sw_cms_list_listing_list_data_grid_actions_edit_delete %}\n                                        <sw-context-menu-item\n                                            v-if="!item.locked && !(defaultProductId === item.id || defaultCategoryId === item.id)"\n                                            v-tooltip="deleteDisabledToolTip(item)"\n                                            variant="danger"\n                                            class="sw-cms-list__context-menu-item-delete"\n                                            :disabled="optionContextDeleteDisabled(item)"\n                                            @click="onDeleteCmsPage(item)"\n                                        >\n                                            {{ $tc(\'sw-cms.components.cmsListItem.delete\') }}\n\n                                        </sw-context-menu-item>\n                                        {% endblock %}\n\n                                    </template>\n                                    {% endblock %}\n\n                                    \n                                    {% block sw_cms_list_listing_list_data_grid_pagination %}\n                                    <template #pagination>\n                                        <sw-pagination\n                                            :page="page"\n                                            :limit="limit"\n                                            :total="total"\n                                            :steps="[5, 10, 25, 50]"\n                                            @page-change="onPageChange"\n                                        />\n                                    </template>\n                                    {% endblock %}\n                                </sw-data-grid>\n                                {% endblock %}\n                            </template>\n                        </sw-card>\n                        {% endblock %}\n                    </div>\n                    {% endblock %}\n\n                    \n                    {% block sw_cms_list_listing_list_empty_state %}\n                    <sw-empty-state\n                        v-if="isValidTerm(term) && !isLoading && !total"\n                        :title="$tc(\'sw-empty-state.messageNoResultTitle\')"\n                        :style="{ minHeight: \'200px\' }"\n                    >\n                        <template #default>\n                            {{ $tc(\'sw-empty-state.messageNoResultSublineBefore\') }}\n                            <router-link\n                                class="sw-empty-state__description-link"\n                                :to="{ name: \'sw.profile.index.searchPreferences\' }"\n                            >\n                                {{ $tc(\'sw-empty-state.messageNoResultSublineLink\') }}\n                            </router-link>\n                            {{ $tc(\'sw-empty-state.messageNoResultSublineAfter\') }}\n                        </template>\n                    </sw-empty-state>\n                    {% endblock %}\n                </div>\n                {% endblock %}\n            </div>\n            {% endblock %}\n\n            \n            {% block sw_cms_list_media_modal %}\n            <sw-media-modal-v2\n                v-if="showMediaModal"\n                :caption="$tc(\'sw-cms.components.cmsListItem.modal.captionMediaUpload\')"\n                :entity-context="\'cms_page\'"\n                :allow-multi-select="false"\n                @media-modal-selection-change="onPreviewImageChange"\n                @modal-close="onModalClose"\n            />\n            {% endblock %}\n\n            <sw-confirm-modal\n                v-if="showLayoutSetAsDefaultModal"\n                class="sw-cms-list__confirm-set-as-default-modal"\n                :title="$tc(\'sw-cms.components.setDefaultLayoutModal.title\')"\n                :text="$tc(\'sw-cms.components.setDefaultLayoutModal.infoText\')"\n                @confirm="onConfirmLayoutSetAsDefault"\n                @cancel="onCloseLayoutSetAsDefault"\n                @close="onCloseLayoutSetAsDefault"\n            />\n\n            \n            {% block sw_cms_list_rename_modal %}\n            <sw-modal\n                v-if="showRenameModal"\n                :title="$tc(\'sw-cms.components.cmsListItem.modal.renameModalTitle\')"\n                variant="small"\n                @modal-close="onCloseRenameModal"\n            >\n\n                \n                {% block sw_cms_list_rename_modal_confirm_rename_input %}\n                <div class="sw_tree__confirm-rename-text">\n                    {{ $tc(\'sw-cms.components.cmsListItem.modal.textRenameConfirm\', 0, { pageName: currentPage.translated.name || currentPage.name }) }}\n                </div>\n                <sw-text-field\n                    {% if VUE3 %}\n                    v-model:value="newName"\n                    {% else %}\n                    v-model="newName"\n                    {% endif %}\n                    class="sw_tree__confirm-rename-text-field"\n                    size="medium"\n                />\n                {% endblock %}\n\n                \n                {% block sw_cms_list_rename_modal_footer %}\n                <template #modal-footer>\n                    \n                    {% block sw_cms_list_rename_modal_cancel %}\n                    <sw-button\n                        size="small"\n                        @click="onCloseRenameModal"\n                    >\n                        {{ $tc(\'sw-cms.components.cmsListItem.modal.buttonCancel\') }}\n                    </sw-button>\n                    {% endblock %}\n\n                    \n                    {% block sw_cms_list_rename_modal_confirm %}\n                    <sw-button\n                        size="small"\n                        variant="primary"\n                        @click="onConfirmPageRename"\n                    >\n                        {{ $tc(\'sw-cms.components.cmsListItem.modal.buttonRename\') }}\n                    </sw-button>\n                    {% endblock %}\n                </template>\n                {% endblock %}\n            </sw-modal>\n            {% endblock %}\n\n            \n            {% block sw_cms_list_delete_modal %}\n            <sw-modal\n                v-if="showDeleteModal"\n                :title="$tc(\'global.default.warning\')"\n                variant="small"\n                @modal-close="onCloseDeleteModal"\n            >\n\n                \n                {% block sw_cms_list_delete_modal_confirm_delete_text %}\n                <div class="sw_tree__confirm-delete-text">\n                    {{ $tc(\'sw-cms.components.cmsListItem.modal.textDeleteConfirm\', 0, { pageName: currentPage.translated.name || currentPage.name }) }}\n                </div>\n                {% endblock %}\n\n                \n                {% block sw_cms_list_delete_modal_footer %}\n                <template #modal-footer>\n                    \n                    {% block sw_cms_list_delete_modal_cancel %}\n                    <sw-button\n                        size="small"\n                        @click="onCloseDeleteModal"\n                    >\n                        {{ $tc(\'sw-cms.components.cmsListItem.modal.buttonCancel\') }}\n                    </sw-button>\n                    {% endblock %}\n\n                    \n                    {% block sw_cms_list_delete_modal_confirm %}\n                    <sw-button\n                        variant="danger"\n                        size="small"\n                        @click="onConfirmPageDelete"\n                    >\n                        {{ $tc(\'sw-cms.components.cmsListItem.modal.buttonDelete\') }}\n                    </sw-button>\n                    {% endblock %}\n                </template>\n                {% endblock %}\n            </sw-modal>\n            {% endblock %}\n\n        </sw-card-view>\n    </template>\n    {% endblock %}\n</sw-page>\n{% endblock %}\n',inject:["repositoryFactory","acl","feature","systemConfigApiService","cmsPageTypeService"],mixins:[m.getByName("listing"),m.getByName("notification"),m.getByName("user-settings")],data:function(){return{pages:[],linkedLayouts:[],isLoading:!1,cardViewIdentifier:"grid.cms.sw-cms-list-grid",sortBy:"createdAt",sortDirection:"DESC",limit:9,limitDefaults:{gridView:10,cardView:9},term:"",currentPageType:null,showMediaModal:!1,currentPage:null,showRenameModal:!1,newName:null,showDeleteModal:!1,defaultMediaFolderId:null,listMode:"grid",assignablePageTypes:["categories","products"],searchConfigEntity:"cms_page",showLayoutSetAsDefaultModal:!1,defaultCategoryId:"",defaultProductId:"",newDefaultLayout:void 0}},metaInfo:function(){return{title:this.$createTitle()}},computed:{pageRepository:function(){return this.repositoryFactory.create("cms_page")},defaultFolderRepository:function(){return this.repositoryFactory.create("media_default_folder")},columnConfig:function(){return this.getColumnConfig()},sortOptions:function(){return[{value:"createdAt:DESC",name:this.$tc("sw-cms.sorting.labelSortByCreatedDsc")},{value:"createdAt:ASC",name:this.$tc("sw-cms.sorting.labelSortByCreatedAsc")},{value:"updatedAt:DESC",name:this.$tc("sw-cms.sorting.labelSortByUpdatedDsc")},{value:"updatedAt:ASC",name:this.$tc("sw-cms.sorting.labelSortByUpdatedAsc")}]},sortPageTypes:function(){var e=this,t={value:"",name:this.$tc("sw-cms.sorting.labelSortByAllPages"),active:!0};return this.cmsPageTypeService.getTypes().reduce((function(t,n){return t.push({value:n.name,name:e.$tc(n.title)}),t}),[t])},listCriteria:function(){var e=new u(this.page,this.limit);return e.addAssociation("previewMedia").addSorting(u.sort(this.sortBy,this.sortDirection)),null!==this.term&&e.setTerm(this.term),null!==this.currentPageType&&e.addFilter(u.equals("cms_page.type",this.currentPageType)),this.addLinkedLayoutsAggregation(e),this.addPageAggregations(e),e},associatedCategoryBuckets:function(){var e,t;return(null===(e=this.pages.aggregations)||void 0===e||null===(t=e.categories)||void 0===t?void 0:t.buckets)||[]},associatedProductBuckets:function(){var e,t;return(null===(e=this.pages.aggregations)||void 0===e||null===(t=e.products)||void 0===t?void 0:t.buckets)||[]},isLinkedCriteria:function(){return[{type:"multi",operator:"OR",queries:this.assignablePageTypes.map((function(e){return u.not("OR",[u.equals("".concat(e,".id"),null)])}))}]},dateFilter:function(){return Shopware.Filter.getByName("date")}},created:function(){this.createdComponent()},methods:{createdComponent:function(){Shopware.State.commit("adminMenu/collapseSidebar"),this.loadGridUserSettings(),this.acl.can("system_config.read")&&this.getDefaultLayouts(),this.setPageContext(),this.resetList()},loadGridUserSettings:function(){var e=this;return c()(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getUserSettings(e.cardViewIdentifier);case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:e.listMode=n.listMode,e.sortBy=n.sortBy,e.sortDirection=n.sortDirection,e.updateLimit();case 9:case"end":return t.stop()}}),t)})))()},updateLimit:function(){this.limit="grid"===this.listMode?this.limitDefaults.cardView:this.limitDefaults.gridView},saveGridUserSettings:function(){this.saveUserSettings(this.cardViewIdentifier,{listMode:this.listMode,sortBy:this.sortBy,sortDirection:this.sortDirection})},setPageContext:function(){var e=this;this.getDefaultFolderId().then((function(t){e.defaultMediaFolderId=t}))},getList:function(){var e=this;return c()(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,e.addQueryScores(e.term,e.listCriteria);case 3:if(n=t.sent,e.entitySearchable){t.next=8;break}return e.isLoading=!1,e.total=0,t.abrupt("return",!1);case 8:return t.abrupt("return",e.pageRepository.search(n).then((function(t){var n;return e.total=t.total,e.pages=t,null!==(n=t.aggregations)&&void 0!==n&&n.linkedLayouts&&(e.linkedLayouts=t.aggregations.linkedLayouts.entities),e.isLoading=!1,e.pages})).catch((function(){e.isLoading=!1})));case 9:case"end":return t.stop()}}),t)})))()},addLinkedLayoutsAggregation:function(e){var t=u.filter("linkedLayoutsFilter",this.isLinkedCriteria,{name:"linkedLayouts",type:"entity",definition:"cms_page",field:"id"});e.addAggregation(t)},addPageAggregations:function(e){return e.addAggregation(u.terms("products","id",null,null,u.count("productCount","products.id"))).addAggregation(u.terms("categories","id",null,null,u.count("categoryCount","categories.id")))},getDefaultLayouts:function(){var e=this;return c()(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.systemConfigApiService.getValues("core.cms");case 2:n=t.sent,e.defaultCategoryId=n["core.cms.default_category_cms_page"],e.defaultProductId=n["core.cms.default_product_cms_page"];case 5:case"end":return t.stop()}}),t)})))()},onOpenLayoutSetAsDefault:function(e){this.newDefaultLayout={id:e.id,type:e.type},this.showLayoutSetAsDefaultModal=!0},onCloseLayoutSetAsDefault:function(){this.newDefaultLayout=void 0,this.showLayoutSetAsDefaultModal=!1},onConfirmLayoutSetAsDefault:function(){var e=this;return c()(d.a.mark((function t(){var n,s,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="category_cms_page",s=e.newDefaultLayout,i=s.id,"product_detail"===s.type?(e.defaultProductId=i,n="product_cms_page"):e.defaultCategoryId=i,t.next=5,e.systemConfigApiService.saveValues(o()({},"core.cms.default_".concat(n),i));case 5:e.showLayoutSetAsDefaultModal=!1;case 6:case"end":return t.stop()}}),t)})))()},layoutIsLinked:function(e){return this.linkedLayouts.some((function(t){return t.id===e}))},resetList:function(){this.page=1,this.pages=[],this.updateRoute({page:this.page,limit:this.limit,term:this.term,sortBy:this.sortBy,sortDirection:this.sortDirection}),this.getList()},getDefaultFolderId:function(){var e=new u(1,1);return e.addAssociation("folder"),e.addFilter(u.equals("entity","cms_page")),this.defaultFolderRepository.search(e).then((function(e){var t,n=e.first();return null!==(t=n.folder)&&void 0!==t&&t.id?n.folder.id:null}))},onChangeLanguage:function(e){Shopware.State.commit("context/setApiLanguageId",e),this.resetList()},onListItemClick:function(e){this.$router.push({name:"sw.cms.detail",params:{id:e.id}})},onSortingChanged:function(e){var t=e.split(":"),n=i()(t,2);this.sortBy=n[0],this.sortDirection=n[1],this.resetList(),this.saveGridUserSettings()},onSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!e.length||e.length<=0?this.term=null:this.term=e,this.resetList()},onSortPageType:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!e.length||e.length<=0?this.currentPageType=null:this.currentPageType=e,this.resetList()},onPageChange:function(e){var t=e.page,n=e.limit;this.page=t,this.limit=n,this.getList(),this.updateRoute({page:this.page,limit:this.limit})},onCreateNewLayout:function(){this.$router.push({name:"sw.cms.create"})},onListModeChange:function(){this.listMode="grid"===this.listMode?"list":"grid",this.updateLimit(),this.resetList(),this.saveGridUserSettings()},onPreviewChange:function(e){this.showMediaModal=!0,this.currentPage=e},onPreviewImageRemove:function(e){e.previewMediaId=null,e.previewMedia=null,this.saveCmsPage(e)},onModalClose:function(){this.showMediaModal=!1,this.currentPage=null},onPreviewImageChange:function(e){var t=i()(e,1)[0];this.currentPage.previewMediaId=t.id,this.saveCmsPage(this.currentPage),this.currentPage.previewMedia=t},onRenameCmsPage:function(e){this.currentPage=e,this.showRenameModal=!0},onCloseRenameModal:function(){this.currentPage=null,this.showRenameModal=!1},onConfirmPageRename:function(){this.newName&&(this.currentPage.name=this.newName,this.saveCmsPage(this.currentPage),this.getList()),this.newName=null,this.currentPage=null,this.showRenameModal=!1},onDeleteCmsPage:function(e){this.currentPage=e,this.showDeleteModal=!0},onDuplicateCmsPage:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{overwrites:{}};n.overwrites||(n.overwrites={}),n.overwrites.name||(n.overwrites.name="".concat(e.name," - ").concat(this.$tc("global.default.copy"))),this.isLoading=!0,this.pageRepository.clone(e.id,Shopware.Context.api,n).then((function(){t.resetList(),t.isLoading=!1})).catch((function(){t.isLoading=!1,t.createNotificationError({message:t.$tc("global.notification.unspecifiedSaveErrorMessage")})}))},onCloseDeleteModal:function(){this.currentPage=null,this.showDeleteModal=!1},onConfirmPageDelete:function(){this.deleteCmsPage(this.currentPage),this.currentPage=null,this.showDeleteModal=!1},saveCmsPage:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Shopware.Context.api;return this.isLoading=!0,this.pageRepository.save(e,n).then((function(){t.isLoading=!1})).catch((function(){t.isLoading=!1}))},deleteCmsPage:function(e){var t=this,n=this.$tc("sw-cms.components.cmsListItem.notificationDeleteErrorMessage");return this.isLoading=!0,this.pageRepository.delete(e.id).then((function(){t.resetList()})).catch((function(){t.isLoading=!1,t.createNotificationError({message:n})}))},getColumnConfig:function(){return[{property:"name",label:this.$tc("sw-cms.list.gridHeaderName"),inlineEdit:"string",primary:!0,sortable:!1},{property:"type",label:this.$tc("sw-cms.list.gridHeaderType"),sortable:!1},{property:"assignments",label:this.$tc("sw-cms.list.gridHeaderAssignments"),sortable:!1},{property:"createdAt",label:this.$tc("sw-cms.list.gridHeaderCreated"),sortable:!1},{property:"updatedAt",label:this.$tc("sw-cms.list.gridHeaderUpdated"),sortable:!1,visible:!1}]},deleteDisabledToolTip:function(e){return"product_detail"===e.type?{showDelay:300,message:this.$tc("sw-cms.general.deleteDisabledProductToolTip"),disabled:!this.layoutIsLinked(e.id)}:{showDelay:300,message:this.$tc("sw-cms.general.deleteDisabledToolTip"),disabled:!this.layoutIsLinked(e.id)}},getPageType:function(e){var t,n=[this.defaultProductId,this.defaultCategoryId].includes(e.id),s=this.$tc("sw-cms.components.cmsListItem.defaultLayout"),i=this.$tc(null===(t=this.cmsPageTypeService.getType(e.type))||void 0===t?void 0:t.title);return n?"".concat(s," - ").concat(i):i},getPageCategoryCount:function(e){var t,n;return(null===(t=Object.values(this.associatedCategoryBuckets).find((function(t){return t.key===e.id})))||void 0===t||null===(n=t.categoryCount)||void 0===n?void 0:n.count)||0},getPageProductCount:function(e){var t,n;return(null===(t=Object.values(this.associatedProductBuckets).find((function(t){return t.key===e.id})))||void 0===t||null===(n=t.productCount)||void 0===n?void 0:n.count)||0},getPageCount:function(e){var t=this.getPageCategoryCount(e)+this.getPageProductCount(e);return t>0?t:"-"},optionContextDeleteDisabled:function(e){return this.getPageCategoryCount(e)>0||this.getPageProductCount(e)>0||!this.acl.can("cms.deleter")}}}},H2xK:function(e,t,n){}}]);
//# sourceMappingURL=9c80af5cc97d9022eb99.js.map