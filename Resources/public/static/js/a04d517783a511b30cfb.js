(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[34],{"3i+3":function(e,i,n){},TJzs:function(e,i,n){"use strict";n.r(i);var t=n("7yzw"),s=n.n(t),a=n("CsSd"),l=n.n(a),o=n("92Mt"),d=n.n(o);n("uNQU");function r(e,i){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);i&&(t=t.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),n.push.apply(n,t)}return n}function c(e){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?r(Object(n),!0).forEach((function(i){l()(e,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))}))}return e}var u=Shopware,m=u.Context,f=u.Utils,h=Shopware.Data.Criteria;i.default={template:'\n{% block sw_media_field %}\n<div class="sw-media-field">\n    \n    {% block sw_media_field_label %}\n    \n    <label\n        v-if="showLabel"\n        class="sw-media-field__label"\n    >\n        <slot name="label">\n            {{ label }}\n        </slot>\n    </label>\n    {% endblock %}\n\n    \n    {% block sw_media_field_input %}\n    <div\n        class="sw-media-field__input-container"\n        :class="mediaFieldClasses"\n    >\n        \n        {% block sw_media_field_preview %}\n        <sw-media-media-item\n            v-if="mediaEntity"\n            class="sw-media-field__media-list-item sw-media-field__input"\n            :item="mediaEntity"\n            :is-list="true"\n            :show-context-menu-button="false"\n            :editable="false"\n        />\n        <div\n            v-else\n            class="sw-media-field__empty-preview sw-media-field__input"\n        ></div>\n        {% endblock %}\n\n        \n        {% block sw_media_field_toggle_button %}\n        <sw-button\n            class="sw-media-field__toggle-button"\n            square\n            :disabled="disabled"\n            @click="onTogglePicker"\n        >\n            \n            {% block sw_media_field_media_icon %}\n            <sw-icon name="regular-image" />\n            {% endblock %}\n\n            \n            {% block sw_media_field_media_popover %}\n            <sw-popover\n                v-if="showPicker"\n                :z-index="1000"\n                popover-class="sw-media-field__expanded-content"\n                class="sw-media-field__popover"\n            >\n                <div @click.stop>\n                    \n                    {% block sw_media_field_action_bar %}\n                    <div class="sw-media-field__actions_bar">\n                        \n                        {% block sw_media_field_action_bar_button_toggle %}\n                        <sw-button\n                            class="sw-media-field__action-button"\n                            @click="toggleUploadField"\n                        >\n                            <sw-icon\n                                class="sw-media-field__icon-add"\n                                name="regular-plus"\n                                small\n                            />\n                            {{ toggleButtonLabel }}\n                        </sw-button>\n                        {% endblock %}\n\n                        \n                        {% block sw_media_field_action_bar_button_unlink %}\n                        <sw-button\n                            v-if="mediaId"\n                            class="sw-media-field__action-button is--remove"\n                            @click="removeLink"\n                        >\n                            <sw-icon\n                                class="sw-media-field__icon-remove"\n                                name="regular-times-circle-s"\n                                small\n                            />\n                            {{ $tc(\'global.sw-media-field.labelUnlink\') }}\n                        </sw-button>\n                        {% endblock %}\n                    </div>\n                    {% endblock %}\n\n                    \n                    {% block sw_media_field_upload_component %}\n                    <sw-upload-listener\n                        :upload-tag="uploadTag"\n                        auto-upload\n                        @media-upload-finish="exposeNewId"\n                    />\n\n                    <sw-media-upload-v2\n                        v-if="showUploadField"\n                        variant="regular"\n                        :file-accept="fileAccept"\n                        :default-folder="defaultFolder"\n                        :allow-multi-select="false"\n                        :upload-tag="uploadTag"\n                        :disabled="disabled"\n                    />\n                    {% endblock %}\n\n                    <div\n                        v-else\n                        class="sw-media-field__media-selection"\n                    >\n                        \n                        {% block sw_media_field_search_field %}\n                        <sw-simple-search-field\n                            v-model="searchTerm"\n                            @search-term-change="onSearchTermChange"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_media_field_media_list %}\n                        <sw-loader\n                            v-if="isLoadingSuggestions"\n                            class="sw-media-field__picker-loader"\n                        />\n\n                        <ul\n                            v-else\n                            class="sw-media-field__suggestion-list"\n                        >\n                            <li\n                                v-for="suggestion in suggestedItems"\n                                :key="suggestion.id"\n                                class="sw-media-field__suggestion-list-entry"\n                            >\n                                \n                                {% block sw_media_field_suggestion_preview %}\n                                <sw-media-media-item\n                                    class="sw-media-field__media-list-item"\n                                    :item="suggestion"\n                                    :is-list="true"\n                                    :show-context-menu-button="false"\n                                    @media-item-click="mediaItemChanged(suggestion.id)"\n                                />\n                                {% endblock %}\n                            </li>\n                        </ul>\n                        {% endblock %}\n\n                        <sw-pagination\n                            v-bind="{ page, limit, total }"\n                            :total-visible="4"\n                            :steps="[5]"\n                            @page-change="onPageChange"\n                        />\n                    </div>\n                </div>\n            </sw-popover>\n            {% endblock %}\n        </sw-button>\n        {% endblock %}\n    </div>\n    {% endblock %}\n</div>\n{% endblock %}\n',inject:["repositoryFactory","feature"],model:{prop:"mediaId",event:"media-id-change"},props:c(c({value:{type:String,required:!1,default:null},disabled:{type:Boolean,default:!1,required:!1}},window._features_.vue3?{}:{mediaId:{type:String,required:!1,default:null}}),{},{label:{type:String,required:!1,default:null},defaultFolder:{type:String,required:!1,validator:function(e){return e.length>0},default:null},fileAccept:{type:String,required:!1,default:"*/*"}}),data:function(){return{searchTerm:"",mediaEntity:null,showPicker:!1,showUploadField:!1,suggestedItems:[],isLoadingSuggestions:!1,pickerClasses:{},uploadTag:f.createId(),page:1,limit:5,total:0}},computed:c(c({},window._features_.vue3?{mediaId:{get:function(){return this.value},set:function(e){this.$emit("update:value",e)}}}:{}),{},{mediaRepository:function(){return this.repositoryFactory.create("media")},mediaFieldClasses:function(){return{"is--active":this.showPicker}},toggleButtonLabel:function(){return this.showUploadField?this.$tc("global.sw-media-field.labelToggleSearchExisting"):this.$tc("global.sw-media-field.labelToggleUploadNew")},suggestionCriteria:function(){var e=new h(this.page,this.limit);return e.addFilter(h.not("AND",[h.equals("uploadedAt",null)])),this.searchTerm&&e.addFilter(h.multi("OR",[h.contains("fileName",this.searchTerm),h.contains("fileExtension",this.searchTerm)])),this.defaultFolder&&e.addFilter(h.equals("mediaFolder.defaultFolder.entity",this.defaultFolder)),e}}),watch:{mediaId:function(e){this.fetchItem(e),this.feature.isActive("VUE3")?this.$emit("update:value",e):this.$emit("media-id-change",e)}},created:function(){this.createdComponent()},methods:{createdComponent:function(){this.fetchItem()},onSearchTermChange:function(e){this.searchTerm=e,this.page=1,this.fetchSuggestions()},fetchItem:function(){var e=arguments,i=this;return s()(d.a.mark((function n(){var t;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.length>0&&void 0!==e[0]?e[0]:i.mediaId){n.next=4;break}return i.mediaEntity=null,n.abrupt("return");case 4:return n.next=6,i.mediaRepository.get(t,m.api);case 6:i.mediaEntity=n.sent;case 7:case"end":return n.stop()}}),n)})))()},fetchSuggestions:function(){var e=this;return s()(d.a.mark((function i(){return d.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return e.isLoadingSuggestions=!0,i.prev=1,i.next=4,e.mediaRepository.search(e.suggestionCriteria,m.api);case 4:e.suggestedItems=i.sent,e.total=e.suggestedItems.total,i.next=11;break;case 8:throw i.prev=8,i.t0=i.catch(1),new Error(i.t0);case 11:return i.prev=11,e.isLoadingSuggestions=!1,i.finish(11);case 14:case"end":return i.stop()}}),i,null,[[1,8,11,14]])})))()},onTogglePicker:function(){this.page=1,this.limit=5,this.total=0,this.showPicker=!this.showPicker,this.showPicker&&(this.showUploadField=!1,this.computePickerPositionAndStyle(),this.fetchSuggestions())},mediaItemChanged:function(e){this.feature.isActive("VUE3")?this.$emit("update:value",e):this.$emit("media-id-change",e),this.onTogglePicker()},removeLink:function(){this.feature.isActive("VUE3")?this.$emit("update:value",null):this.$emit("media-id-change",null)},computePickerPositionAndStyle:function(){if(this.$el){var e=this.$el.getBoundingClientRect();this.pickerClasses={top:"".concat(e.height+5,"px")}}else this.pickerClasses={}},toggleUploadField:function(){this.showUploadField=!this.showUploadField},exposeNewId:function(e){var i=e.targetId;this.feature.isActive("VUE3")?this.$emit("update:value",i):this.$emit("media-id-change",i),this.showUploadField=!1,this.showPicker=!1},showLabel:function(){var e,i;return!!this.label||!!this.$slots.label||!(null===(e=this.$scopedSlots)||void 0===e||null===(i=e.label)||void 0===i||!i.call(e))},onPageChange:function(e){var i=e.page,n=e.limit;this.page=i,this.limit=n,this.fetchSuggestions()}}}},uNQU:function(e,i,n){var t=n("3i+3");t.__esModule&&(t=t.default),"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);(0,n("P8hj").default)("6aa329a6",t,!0,{})}}]);