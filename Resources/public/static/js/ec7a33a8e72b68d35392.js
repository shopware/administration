(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[55],{TDog:function(e,t,n){},ZrDV:function(e,t,n){var s=n("TDog");s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,n("ydqr").default)("cf2fe5b6",s,!0,{})},sTHG:function(e,t,n){"use strict";n.r(t);var s=n("HZZ/"),o=n.n(s),c=n("hJxD"),a=n.n(c),i=(n("ZrDV"),Shopware.Data.Criteria);t.default={template:'\n{% block sw_bulk_edit_save_modal_success %}\n<div class="sw-bulk-edit-save-modal-success">\n    \n    {% block sw_bulk_edit_save_modal_success_icon %}\n    <sw-label\n        class="sw-bulk-edit-save-modal__icon"\n        appearance="pill"\n        variant="success"\n    >\n        <sw-icon\n            name="regular-check-circle"\n            size="30px"\n        />\n    </sw-label>\n    {% endblock %}\n\n    \n    {% block sw_bulk_edit_save_modal_error_content %}\n    <p\n        class="sw-bulk-edit-save-modal__help-text"\n        v-html="description"\n    >\n    </p>\n    {% endblock %}\n\n    \n    {% block sw_bulk_edit_save_modal_success_download_document %}\n    <ul\n        v-if="selectedDocumentTypes.length > 0"\n        class="sw-bulk-edit-save-modal-success__download-document-container"\n    >\n        <li\n            v-for="selectedDocumentType in selectedDocumentTypes"\n            :key="selectedDocumentType.id"\n            class="sw-bulk-edit-save-modal-success__download-document"\n            :class="`is--${selectedDocumentType.technicalName}`"\n        >\n            <span class="label">\n                {{ selectedDocumentType.translated.name }}\n            </span>\n            <sw-button\n                class="action"\n                size="small"\n                :disabled="document[selectedDocumentType.technicalName].isDownloading"\n                @click="downloadDocument(selectedDocumentType.technicalName)"\n            >\n                {{ $tc(\'sw-bulk-edit.modal.success.buttonDownload\') }}\n            </sw-button>\n        </li>\n    </ul>\n    {% endblock %}\n</div>\n{% endblock %}\n',inject:["repositoryFactory","orderDocumentApiService"],mixins:[Shopware.Mixin.getByName("notification")],data:function(){return{latestDocuments:{},document:{invoice:{isDownloading:!1},storno:{isDownloading:!1},delivery_note:{isDownloading:!1},credit_note:{isDownloading:!1}}}},computed:{documentRepository:function(){return this.repositoryFactory.create("document")},selectedIds:function(){return Shopware.State.get("shopwareApps").selectedIds},downloadOrderDocuments:function(){var e,t;return null===(e=Shopware.State.get("swBulkEdit"))||void 0===e||null===(t=e.orderDocuments)||void 0===t?void 0:t.download},latestDocumentsCriteria:function(){var e=new i(1,null);return e.addFilter(i.equalsAny("documentTypeId",this.selectedDocumentTypes.map((function(e){return e.id})))),e.addFilter(i.equalsAny("orderId",this.selectedIds)),e.addSorting(i.sort("createdAt","DESC")),e},selectedDocumentTypes:function(){return this.downloadOrderDocuments&&this.downloadOrderDocuments.isChanged?this.downloadOrderDocuments.value.length<=0?[]:this.downloadOrderDocuments.value.filter((function(e){return e.selected})):[]},description:function(){return this.selectedDocumentTypes.length>0?this.$tc("sw-bulk-edit.modal.success.instruction"):this.$tc("sw-bulk-edit.modal.success.description")}},created:function(){this.createdComponent()},methods:{createdComponent:function(){var e=this;return o()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.updateButtons(),e.setTitle(),t.next=4,e.getLatestDocuments();case 4:case"end":return t.stop()}}),t)})))()},setTitle:function(){this.$emit("title-set",this.$tc("sw-bulk-edit.modal.success.title"))},updateButtons:function(){var e=[{key:"close",label:this.$tc("global.sw-modal.labelClose"),position:"right",variant:"primary",action:"",disabled:!1}];this.$emit("buttons-update",e)},getLatestDocuments:function(){var e=this;return o()(a.a.mark((function t(){var n,s,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.selectedDocumentTypes.length<=0)){t.next=2;break}return t.abrupt("return");case 2:return n={},s=e.selectedIds.length,t.next=6,e.documentRepository.search(e.latestDocumentsCriteria);case 6:o=t.sent,e.selectedDocumentTypes.forEach((function(e){var t,c;null!==(c=n[t=e.technicalName])&&void 0!==c||(n[t]=[]);var a=n[e.technicalName],i=o.filter((function(t){return t.documentTypeId===e.id})),d={};i.forEach((function(e){Object.values(a).length!==s&&(d.hasOwnProperty(e.orderId)||(d[e.orderId]=e.id,a.push(e.id)))}))})),e.latestDocuments=n;case 9:case"end":return t.stop()}}),t)})))()},downloadDocument:function(e){var t=this,n=this.latestDocuments[e];return n&&0!==n.length?(this.$set(this.document[e],"isDownloading",!0),this.orderDocumentApiService.download(n).then((function(e){if(e.data){var t=e.headers["content-disposition"].split("filename=")[1],n=document.createElement("a");n.href=URL.createObjectURL(e.data),n.download=t,n.dispatchEvent(new MouseEvent("click")),n.remove()}})).catch((function(e){t.createNotificationError({message:e.message})})).finally((function(){t.$set(t.document[e],"isDownloading",!1)}))):(this.createNotificationInfo({message:this.$tc("sw-bulk-edit.modal.success.messageNoDocumentsFound")}),Promise.resolve())}}}}}]);