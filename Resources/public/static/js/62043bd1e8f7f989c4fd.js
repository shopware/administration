(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[535],{WlCM:function(t,n,i){"use strict";i.r(n);var e=i("HZZ/"),o=i.n(e),s=i("hJxD"),a=i.n(s),r=Shopware.Data.Criteria,c=Shopware.Utils.types;n.default=Shopware.Component.wrapComponentConfig({template:'<sw-page\n    :header-border-color="entityAccentColor"\n    class="sw-generic-custom-entity-list"\n>\n    <template #search-bar>\n        <sw-search-bar\n            :key="customEntityName"\n            :initial-search-type="customEntityName"\n            :initial-search="term"\n            :entity-search-color="entityAccentColor"\n            @search="onSearch"\n        />\n    </template>\n\n    <template #smart-bar-header>\n        <h2 class="sw-generic-custom-entity-list__title">\n            {{ $tc(`${customEntityName}.moduleTitle`) }}\n\n            <span v-if="!isLoading">\n                ({{ total }})\n            </span>\n        </h2>\n    </template>\n\n    <template #smart-bar-actions>\n        <sw-button\n            class="sw-generic-custom-entity-list__button-add"\n            :router-link="{ name: \'sw.custom.entity.create\' }"\n            variant="primary"\n        >\n            {{ $tc(\'global.default.add\') }}\n        </sw-button>\n    </template>\n\n    <template #language-switch>\n        <sw-language-switch @on-change="onChangeLanguage" />\n    </template>\n\n    <template #content>\n        <div class="sw-generic-custom-entity-list__content">\n            <sw-entity-listing\n                v-if="!isLoading && customEntityDefinition && customEntityInstances.length > 0"\n                class="sw-generic-custom-entity-list__content-list"\n                :repository="customEntityRepository"\n                :items="customEntityInstances"\n                :allow-inline-edit="false"\n                :allow-column-edit="false"\n                :columns="columnConfig"\n                :sort-by="sortBy"\n                :sort-direction="sortDirection"\n                :natural-sorting="naturalSorting"\n                :criteria-limit="limit"\n                :disable-data-fetching="true"\n                :is-loading="isLoading"\n                @column-sort="onColumnSort"\n                @page-change="onPageChange"\n                @update-records="onUpdateRecords"\n            />\n\n            <sw-empty-state\n                v-else\n                class="sw-generic-custom-entity-list__content-empty-state"\n                :title="emptyStateTitle"\n                :subline="emptyStateSubline"\n            >\n                <template #icon>\n                    <img\n                        :src="\'/administration/static/img/empty-states/custom-entity-empty-state.svg\' | asset"\n                        :alt="emptyStateTitle"\n                    >\n                </template>\n            </sw-empty-state>\n        </div>\n    </template>\n</sw-page>\n',inject:["customEntityDefinitionService","repositoryFactory","acl"],data:function(){return{customEntityInstances:null,page:1,limit:25,total:0,term:"",sortBy:"",sortDirection:"ASC",naturalSorting:!1,isLoading:!1}},created:function(){this.createdComponent()},computed:{customEntityName:function(){var t,n=this.$route.params.entityName,i=null!==(t=this.customEntityDefinitionService.getDefinitionByName(n))&&void 0!==t?t:null;return i?i.entity:""},customEntityDefinition:function(){var t;return null!==(t=this.customEntityDefinitionService.getDefinitionByName(this.customEntityName))&&void 0!==t?t:null},customEntityRepository:function(){return null===this.customEntityDefinition?null:this.repositoryFactory.create(this.customEntityDefinition.entity)},adminConfig:function(){var t;return null===(t=this.customEntityDefinition)||void 0===t?void 0:t.flags["admin-ui"]},entityAccentColor:function(){var t;return null===(t=this.adminConfig)||void 0===t?void 0:t.color},columnConfig:function(){var t=this;return this.customEntityDefinition?this.customEntityDefinition.flags["admin-ui"].listing.columns.map((function(n){var i="".concat(t.customEntityName,".list.").concat(n.ref);return{label:t.$tc(i),property:n.ref,routerLink:"sw.custom.entity.detail",visible:!n.hidden}})):[]},customEntityCriteria:function(){var t=new r(this.page,this.limit);return t.setTerm(this.term),t.addSorting({field:this.sortBy,naturalSorting:this.naturalSorting,order:this.sortDirection}),t},emptyStateTitle:function(){var t="".concat(this.customEntityName,".list.emptyState");return this.$te(t)?this.$tc(t):this.$tc("sw-custom-entity.general.emptyState")},emptyStateSubline:function(){var t="".concat(this.customEntityName,".list.emptyStateSubline");return this.$te(t)?this.$tc(t):this.$tc("sw-custom-entity.general.emptyStateSubline")}},watch:{$route:function(){c.isEmpty(this.$route.query)&&this.updateRoute({}),this.parseRoute(),this.getList()}},methods:{createdComponent:function(){var t,n,i,e,o,s;null!==this.adminConfig&&(this.sortBy=null!==(t=null===(n=this.adminConfig)||void 0===n||null===(i=n.listing)||void 0===i||null===(e=i.columns)||void 0===e||null===(o=e[0])||void 0===o?void 0:o.ref)&&void 0!==t?t:"",this.$route.meta.$module.icon=null===(s=this.adminConfig)||void 0===s?void 0:s.icon);this.parseRoute(),this.getList()},getList:function(){var t=this;return o()(a.a.mark((function n(){var i,e;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.customEntityRepository){n.next=2;break}return n.abrupt("return");case 2:return t.isLoading=!0,n.next=5,t.customEntityRepository.search(t.customEntityCriteria);case 5:e=n.sent,t.customEntityInstances=e,t.total=null!==(i=e.total)&&void 0!==i?i:0,t.isLoading=!1;case 9:case"end":return n.stop()}}),n)})))()},onChangeLanguage:function(t){Shopware.State.commit("context/setApiLanguageId",t),this.getList()},parseSortDirection:function(t){return"ASC"===t||"DESC"===t?t:this.sortDirection},parseRoute:function(){var t=this.$route.query;this.page=t.page?parseInt(t.page,10):this.page,this.limit=t.limit?parseInt(t.limit,10):this.limit,this.term=t.term||this.term,this.sortBy=t.sortBy||this.sortBy,this.sortDirection=this.parseSortDirection(t.sortDirection),this.naturalSorting=t.naturalSorting?"true"===t.naturalSorting:this.naturalSorting},updateRoute:function(t){this.$router.replace({query:{limit:(t.limit||this.limit).toString(),page:(t.page||this.page).toString(),term:t.term||this.term,sortBy:t.sortBy||this.sortBy,sortDirection:t.sortDirection||this.sortDirection,naturalSorting:t.naturalSorting||this.naturalSorting?"true":"false"}})},onSearch:function(t){this.updateRoute({term:t})},onColumnSort:function(t){var n=t.dataIndex,i=t.naturalSorting;this.sortBy===n?this.updateRoute({sortDirection:"ASC"===this.sortDirection?"DESC":"ASC"}):this.updateRoute({sortBy:n,sortDirection:"ASC",naturalSorting:i})},onPageChange:function(t){var n=t.page,i=t.limit;this.updateRoute({page:n,limit:i})},onUpdateRecords:function(t){var n;this.customEntityInstances=t,this.total=null!==(n=t.total)&&void 0!==n?n:0}}})}}]);