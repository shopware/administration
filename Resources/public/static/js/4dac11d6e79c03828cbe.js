(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[314],{E9GS:function(e,t,n){var o=n("H4d4");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,n("P8hj").default)("2d54f924",o,!0,{})},H4d4:function(e,t,n){},mHOs:function(e,t,n){"use strict";n.r(t);var o=n("7yzw"),r=n.n(o),i=n("CsSd"),s=n.n(i),a=n("92Mt"),d=n.n(a),c=(n("E9GS"),n("JvCW"));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=Shopware,p=m.Component,h=m.State,v=m.Mixin,b=m.Service;t.default=p.wrapComponentConfig({template:'\n{% block sw_order_create_modal %}\n<sw-modal\n    class="sw-order-create-initial-modal"\n    :closable="false"\n    :title="$tc(\'sw-order.initialModal.titleNewOrder\')"\n    variant="large"\n    @modal-close="onCloseModal"\n>\n    <template #default>\n        \n        {% block sw_order_create_modal_tabs %}\n        <sw-tabs\n            class="sw-order-create-initial-modal__tabs"\n            default-item="customer"\n            position-identifier="sw-order-create-initial-modal"\n        >\n            <template #default="{ active }">\n                \n                {% block sw_order_create_modal_tabs_customer %}\n                <sw-tabs-item\n                    class="sw-order-create-initial-modal__tab-customer"\n                    name="customer"\n                    :active-tab="active"\n                >\n                    {{ $tc(\'sw-order.initialModal.tabCustomer\') }}\n                </sw-tabs-item>\n                {% endblock %}\n\n                \n                {% block sw_order_create_modal_tabs_products %}\n                <sw-tabs-item\n                    class="sw-order-create-initial-modal__tab-product"\n                    name="products"\n                    :active-tab="active"\n                    :disabled="!customer"\n                >\n                    {{ $tc(\'sw-order.initialModal.tabProducts\') }}\n                </sw-tabs-item>\n                {% endblock %}\n\n                \n                {% block sw_order_create_modal_tabs_options %}\n                <sw-tabs-item\n                    class="sw-order-create-initial-modal__tab-options"\n                    name="options"\n                    :active-tab="active"\n                    :disabled="!customer"\n                >\n                    {{ $tc(\'sw-order.initialModal.tabOptions\') }}\n                </sw-tabs-item>\n                {% endblock %}\n\n                \n                {% block sw_order_create_modal_tabs_extension %}{% endblock %}\n            </template>\n\n            <template #content="{ active }">\n                \n                {% block sw_order_create_modal_tabs_content %}\n                <div class="sw-order-create-initial-modal__content">\n                    \n                    {% block sw_order_create_modal_tabs_content_customer %}\n                    <sw-order-customer-grid\n                        v-show="active === \'customer\'"\n                    />\n                    {% endblock %}\n\n                    \n                    {% block sw_order_create_modal_tabs_content_products %}\n                    <sw-order-line-items-grid-sales-channel\n                        v-show="active === \'products\'"\n                        :is-loading="isProductGridLoading"\n                        :sales-channel-id="salesChannelId"\n                        :cart="cart"\n                        :currency="currency"\n                        :is-customer-active="isCustomerActive"\n                        @on-save-item="onSaveItem"\n                        @on-remove-items="onRemoveItems"\n                    />\n                    {% endblock %}\n\n                    \n                    {% block sw_order_create_modal_tabs_content_options %}\n                    <sw-order-create-options\n                        v-if="active === \'options\'"\n                        :disabled="!customer"\n                        :disabled-auto-promotion="disabledAutoPromotion"\n                        :promotion-codes="promotionCodes"\n                        :context="context"\n                        @promotions-change="updatePromotion"\n                        @auto-promotion-toggle="updateAutoPromotionToggle"\n                        @shipping-cost-change="updateShippingCost"\n                    />\n                    {% endblock %}\n                </div>\n                {% endblock %}\n            </template>\n        </sw-tabs>\n        {% endblock %}\n    </template>\n\n    <template #modal-footer>\n        \n        {% block sw_order_create_modal_footer_modal_footer_cancel %}\n        <sw-button\n            class="sw-order-create-initial-modal__button-cancel"\n            size="small"\n            @click="onCloseModal"\n        >\n            {{ $tc(\'global.default.cancel\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_order_create_modal_footer_modal_footer_preview_order %}\n        <sw-button\n            class="sw-order-create-initial-modal__button-preview"\n            size="small"\n            variant="primary"\n            :disabled="!customer"\n            :is-loading="isLoading"\n            @click="onPreviewOrder"\n        >\n            {{ $tc(\'sw-order.initialModal.buttonPreviewOrder\') }}\n        </sw-button>\n        {% endblock %}\n    </template>\n\n</sw-modal>\n{% endblock %}\n',mixins:[v.getByName("notification"),v.getByName("cart-notification")],data:function(){return{productItems:[],promotionCodes:[],isLoading:!1,isProductGridLoading:!1,disabledAutoPromotion:!1,shippingCosts:null,context:{currencyId:"",paymentMethodId:"",shippingMethodId:"",languageId:"",billingAddressId:"",shippingAddressId:""}}},computed:{salesChannelId:function(){var e,t;return null!==(e=null===(t=this.customer)||void 0===t?void 0:t.salesChannelId)&&void 0!==e?e:""},salesChannelContext:function(){return h.get("swOrder").context},currency:function(){return this.salesChannelContext.currency},cart:function(){return h.get("swOrder").cart},customer:function(){return h.get("swOrder").customer},isCustomerActive:function(){return h.getters["swOrder/isCustomerActive"]},promotionCodeItems:function(){return this.promotionCodes.map((function(e){return{type:c.a.PROMOTION,referencedId:e}}))},cartDelivery:function(){var e;return null===(e=this.cart)||void 0===e?void 0:e.deliveries[0]}},watch:{salesChannelContext:function(e){var t,n,o,r,i,s;this.context=u(u({},this.context),{},{currencyId:e.context.currencyId,languageId:e.context.languageIdChain[0],shippingMethodId:e.shippingMethod.id,paymentMethodId:e.paymentMethod.id,billingAddressId:null!==(t=null===(n=e.customer)||void 0===n||null===(o=n.activeBillingAddress)||void 0===o?void 0:o.id)&&void 0!==t?t:"",shippingAddressId:null!==(r=null===(i=e.customer)||void 0===i||null===(s=i.activeShippingAddress)||void 0===s?void 0:s.id)&&void 0!==r?r:""})}},methods:{onCloseModal:function(){var e=this;this.customer&&this.cart.token?this.cancelCart().then((function(){e.$emit("modal-close")})):this.$emit("modal-close")},onPreviewOrder:function(){var e=this;return r()(d.a.mark((function t(){var n,o,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],e.isLoading=!0,r.push(e.updateOrderContext()),e.disabledAutoPromotion&&r.push(e.disableAutoAppliedPromotions()),e.promotionCodes.length&&r.push(e.addPromotionCodes()),null!==e.shippingCosts&&e.shippingCosts!==(null===(n=e.cartDelivery)||void 0===n||null===(o=n.shippingCosts)||void 0===o?void 0:o.totalPrice)&&r.push(e.modifyShippingCost(e.shippingCosts)),t.prev=6,t.next=9,Promise.all(r);case 9:t.sent&&e.$emit("order-preview");case 11:return t.prev=11,e.isLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[6,,11,14]])})))()},onSaveItem:function(e){var t=this;return r()(d.a.mark((function n(){return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.isProductGridLoading=!0,n.prev=1,n.next=4,h.dispatch("swOrder/saveLineItem",{salesChannelId:t.salesChannelId,contextToken:t.cart.token,item:e});case 4:return n.prev=4,t.isProductGridLoading=!1,n.finish(4);case 7:case"end":return n.stop()}}),n,null,[[1,,4,7]])})))()},addPromotionCodes:function(){var e;return h.dispatch("swOrder/saveMultipleLineItems",{salesChannelId:null===(e=this.customer)||void 0===e?void 0:e.salesChannelId,contextToken:this.cart.token,items:this.promotionCodeItems})},updatePromotion:function(e){this.promotionCodes=e},onRemoveItems:function(e){var t=this;return r()(d.a.mark((function n(){return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.isProductGridLoading=!0,n.prev=1,n.next=4,h.dispatch("swOrder/removeLineItems",{salesChannelId:t.salesChannelId,contextToken:t.cart.token,lineItemKeys:e});case 4:return n.prev=4,t.isProductGridLoading=!1,n.finish(4);case 7:case"end":return n.stop()}}),n,null,[[1,,4,7]])})))()},updateAutoPromotionToggle:function(e){this.disabledAutoPromotion=e},updateShippingCost:function(e){this.shippingCosts=e},updateOrderContext:function(){return h.dispatch("swOrder/updateOrderContext",{context:this.context,salesChannelId:this.salesChannelId,contextToken:this.cart.token})},disableAutoAppliedPromotions:function(){var e={salesChannelId:this.salesChannelId};return b("cartStoreService").disableAutomaticPromotions(this.cart.token,e).then((function(){h.commit("swOrder/setDisabledAutoPromotion",!0)}))},modifyShippingCost:function(e){var t,n;if(!this.cartDelivery)return Promise.resolve();var o=Math.abs(e);return this.cartDelivery.shippingCosts.unitPrice=o,this.cartDelivery.shippingCosts.totalPrice=o,h.dispatch("swOrder/modifyShippingCosts",{salesChannelId:null===(t=this.customer)||void 0===t?void 0:t.salesChannelId,contextToken:this.cart.token,shippingCosts:null===(n=this.cartDelivery)||void 0===n?void 0:n.shippingCosts})},cancelCart:function(){var e=this;return h.dispatch("swOrder/cancelCart",{salesChannelId:this.salesChannelId,contextToken:this.cart.token}).then((function(){e.$emit("modal-close")}))}}})}}]);