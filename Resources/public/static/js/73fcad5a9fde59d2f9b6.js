(window.webpackJsonpAdministration=window.webpackJsonpAdministration||[]).push([[5533],{64097:function(){},5533:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return a}}),t(727187);let{Component:r,Mixin:s}=Shopware,{mapPropertyErrors:c}=r.getComponentHelper(),{Criteria:o}=Shopware.Data;var a={template:'\n{% block sw_settings_country_general %}\n<div>\n    \n    {% block sw_settings_country_general_card %}\n    <sw-card\n        position-identifier="sw-settings-country-detail-general"\n        :title="$tc(\'sw-settings-country.detail.titleCard\')"\n        :is-loading="isLoading"\n    >\n        <sw-container\n            columns="repeat(auto-fit, minmax(250px, 1fr))"\n            gap="0px 30px"\n        >\n\n            \n            {% block sw_settings_country_general_content_field_name %}\n            <sw-text-field\n                v-model:value="country.name"\n                name="sw-field--country-name"\n                required\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelName\')"\n                :placeholder="placeholder(country, \'name\', $tc(\'sw-settings-country.detail.placeholderName\'))"\n                :error="countryNameError"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_country_general_content_field_position %}\n            <sw-number-field\n                v-model:value="country.position"\n                name="sw-field--country-position"\n                number-type="int"\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelPosition\')"\n                :placeholder="placeholder(country, \'position\', $tc(\'sw-settings-country.detail.placeholderPosition\'))"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_country_general_content_field_iso %}\n            <sw-text-field\n                v-model:value="country.iso"\n                name="sw-field--country-iso"\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelIso\')"\n                :placeholder="placeholder(country, \'iso\', $tc(\'sw-settings-country.detail.placeholderIso\'))"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_country_general_content_field_iso3 %}\n            <sw-text-field\n                v-model:value="country.iso3"\n                name="sw-field--country-iso3"\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelIso3\')"\n                :placeholder="placeholder(country, \'iso3\', $tc(\'sw-settings-country.detail.placeholderIso3\'))"\n            />\n            {% endblock %}\n        </sw-container>\n    </sw-card>\n    {% endblock %}\n\n    \n    {% block sw_settings_country_general_options_card %}\n    <sw-card\n        position-identifier="sw-settings-country-general"\n        :title="$tc(\'sw-settings-country.detail.titleOptions\')"\n        :is-loading="isLoading"\n    >\n        <sw-container class="sw-settings-country-general__options-container">\n\n            \n            {% block sw_settings_country_general_content_field_active %}\n            <sw-switch-field\n                v-model:value="country.active"\n                name="sw-field--country-active"\n                class="sw-settings-country-general__option-items"\n                bordered\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelActive\')"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_country_general_content_field_shipping_available %}\n            <sw-switch-field\n                v-model:value="country.shippingAvailable"\n                name="sw-field--country-shippingAvailable"\n                class="sw-settings-country-general__option-items"\n                bordered\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelShippingAvailable\')"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_country_general_content_field_tax_free %}\n            <sw-switch-field\n                v-model:value="country.customerTax.enabled"\n                name="sw-field--country-customerTax-enabled"\n                class="sw-settings-country-general__option-items switch-field-customer-tax-free"\n                bordered\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelTaxFree\')"\n            />\n            {% endblock %}\n\n            <sw-container\n                v-if="country.customerTax.enabled"\n                class="sw-settings-country-general-customer-tax"\n            >\n\n                \n                {% block sw_settings_country_general_content_field_tax_free_from_customer %}\n                \n                {% block sw_settings_country_general_content_field_tax_free_from_customer_value %}\n                <sw-number-field\n                    v-model:value="country.customerTax.amount"\n                    name="sw-field--country-customerTax-amount"\n                    class="sw-settings-country-general__input-amount customer-tax-amount"\n                    :min="0"\n                    :label="$tc(\'sw-settings-country.detail.taxFreeFrom\')"\n                    :help-text="$tc(\'sw-settings-country.detail.taxFreeFromHelpText\')"\n                    :disabled="!acl.can(\'country.editor\')"\n                >\n                    <template #suffix>\n                        <sw-entity-single-select\n                            v-model:value="country.customerTax.currencyId"\n                            name="sw-field--country-customerTax-currencyId"\n                            class="sw-settings-country-general__customer-select-currency sw-settings-country-general__select"\n                            entity="currency"\n                            bordered\n                            show-clearable-button\n                            :disabled="!acl.can(\'country.editor\')"\n                        />\n                    </template>\n                </sw-number-field>\n                {% endblock %}\n                {% endblock %}\n\n                \n                {% block sw_settings_country_general_content_show_tax_free_currency_dependent_values %}\n                <sw-container\n                    columns="1fr"\n                    justify="end"\n                >\n                    <a\n                        class="sw-settings-country-general__currency-dependent-modal"\n                        role="button"\n                        tabindex="0"\n                        @click="openCustomerTaxModal"\n                        @keydown.enter="openCustomerTaxModal"\n                    >\n                        {{ $tc(\'sw-settings-country.detail.currencyDependentValues\') }}\n                        <sw-icon\n                            name="regular-long-arrow-right"\n                            small\n                        />\n                    </a>\n                </sw-container>\n                {% endblock %}\n\n            </sw-container>\n\n            \n            {% block sw_settings_country_general_content_field_tax_free_companies %}\n            <sw-switch-field\n                v-model:value="country.companyTax.enabled"\n                name="sw-field--country-companyTax-enabled"\n                class="sw-settings-country-general__option-items switch-field-company-tax-free"\n                bordered\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelCompanyTaxFree\')"\n                :help-text="$tc(\'sw-settings-country.detail.helpTextCompanyTaxFree\')"\n            />\n            {% endblock %}\n\n            <sw-container\n                v-if="country.companyTax.enabled"\n                class="sw-settings-country-general-company-tax"\n            >\n\n                \n                {% block sw_settings_country_general_content_field_tax_free_from_companies %}\n                \n                {% block sw_settings_country_general_content_field_tax_free_from_companies_value %}\n                <sw-number-field\n                    v-model:value="country.companyTax.amount"\n                    name="sw-field--country-companyTax-amount"\n                    class="sw-settings-country-general__input-amount"\n                    :min="0"\n                    :label="$tc(\'sw-settings-country.detail.taxFreeFrom\')"\n                    :help-text="$tc(\'sw-settings-country.detail.taxFreeFromHelpText\')"\n                    :disabled="!acl.can(\'country.editor\')"\n                >\n                    <template #suffix>\n                        <sw-entity-single-select\n                            v-model:value="country.companyTax.currencyId"\n                            name="sw-field--country-companyTax-currencyId"\n                            class="sw-settings-country-general__company-select-currency sw-settings-country-general__select"\n                            entity="currency"\n                            show-clearable-button\n                            :disabled="!acl.can(\'country.editor\')"\n                        />\n                    </template>\n                </sw-number-field>\n                {% endblock %}\n                {% endblock %}\n\n                \n                {% block sw_settings_country_general_content_show_company_tax_free_currency_dependent_values %}\n                <sw-container\n                    columns="1fr"\n                    justify="end"\n                >\n                    <a\n                        class="sw-settings-country-general__currency-dependent-modal"\n                        role="button"\n                        tabindex="0"\n                        @click="openCompanyTaxModal"\n                        @keydown.enter="openCompanyTaxModal"\n                    >\n                        {{ $tc(\'sw-settings-country.detail.currencyDependentValues\') }}\n                        <sw-icon\n                            name="regular-long-arrow-right"\n                            small\n                        />\n                    </a>\n                </sw-container>\n                {% endblock %}\n            </sw-container>\n\n            \n            {% block sw_settings_country_general_content_show_currency_dependent_modal %}\n            <sw-settings-country-currency-dependent-modal\n                v-if="showCurrencyModal"\n                :currency-depends-value="currencyDependsValue"\n                :country-id="countryId"\n                :is-loading="isLoading"\n                :menu-options="menuOptions"\n                :user-config="userConfig"\n                :user-config-values="userConfigValues"\n                :tax-free-type="taxFreeType"\n                @modal-close="onToggleCurrencyModal"\n                @modal-save="saveCountryCurrencyDependent"\n                @base-item-change="changeBaseItem"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_country_general_content_field_check_vat_id_format %}\n            <sw-switch-field\n                v-model:value="country.checkVatIdPattern"\n                name="sw-field--country-checkVatIdPattern"\n                class="sw-settings-country-general__field-check-vatid-format sw-settings-country-general__option-items"\n                bordered\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelCheckVatIdFormat\')"\n                :help-text="$tc(\'sw-settings-country.detail.helpTextCheckVatIdFormat\')"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_country_general_content_field_vat_id_required %}\n            <sw-switch-field\n                v-model:value="country.vatIdRequired"\n                name="sw-field--country-vatIdRequired"\n                class="sw-settings-country-general__vat-id-required sw-settings-country-general__option-items"\n                bordered\n                :disabled="!acl.can(\'country.editor\')"\n                :label="$tc(\'sw-settings-country.detail.labelVatIdRequired\')"\n                :help-text="$tc(\'sw-settings-country.detail.helpTextLabelVatIdRequired\')"\n            />\n            {% endblock %}\n        </sw-container>\n    </sw-card>\n    {% endblock %}\n\n</div>\n{% endblock %}\n',inject:["repositoryFactory","acl"],mixins:[s.getByName("notification"),s.getByName("placeholder"),s.getByName("discard-detail-page-changes")("country")],props:{country:{type:Object,required:!0},isLoading:{type:Boolean,required:!0},userConfig:{type:Object,required:!0},userConfigValues:{type:Object,required:!0}},data(){return{showCurrencyModal:!1,currencyDependsValue:[],currencies:[],menuOptions:[],taxFreeType:"",countryId:"",baseCurrencyId:""}},computed:{countryRepository(){return this.repositoryFactory.create("country")},currencyRepository(){return this.repositoryFactory.create("currency")},...c("country",["name"])},created(){this.createdComponent()},methods:{createdComponent(){this.$route.params.id&&(this.countryId=this.$route.params.id,this.loadCurrencies())},loadCurrencies(){return this.currencyRepository.search(new o(1,25),Shopware.Context.api).then(e=>{this.currencies=e})},openCustomerTaxModal(){this.onToggleCurrencyModal("customerTax")},openCompanyTaxModal(){this.onToggleCurrencyModal("companyTax")},onToggleCurrencyModal(e){if(this.taxFreeType=e,this.showCurrencyModal=!this.showCurrencyModal,this.showCurrencyModal){this.createDataModal();return}this.clearMenuOptions()},changeBaseItem(e){["customerTax","companyTax"].includes(this.taxFreeType)&&(this.country[this.taxFreeType]=e)},createDataModal(){("companyTax"===this.taxFreeType||"customerTax"===this.taxFreeType)&&(this.currencyDependsValue=[this.country[this.taxFreeType]]),this.baseCurrencyId=this.currencyDependsValue[0].currencyId,Object.keys(this.userConfigValues).length>0&&this.pushDataFromUserConfig(),this.addCheckedHamburgerMenu(),this.addDisabledBaseCurrencyCheckBox(),this.sortCurrencyCheckBox()},clearMenuOptions(){this.menuOptions.forEach(e=>{delete e.checked,delete e.disabled})},addCheckedHamburgerMenu(){this.menuOptions=[...this.currencies],this.menuOptions.forEach(e=>{let n=this.currencyDependsValue.find(n=>e.id===n.currencyId);e.checked=!!n})},addDisabledBaseCurrencyCheckBox(){this.menuOptions.forEach(e=>{e.disabled=e.id===this.baseCurrencyId})},sortCurrencyCheckBox(){this.menuOptions.sort((e,n)=>n.checked-e.checked||n.disabled-e.disabled)},pushDataFromUserConfig(){this.userConfigValues[this.taxFreeType]&&this.userConfigValues[this.taxFreeType].forEach(e=>{let n={};n.amount=this.calculateInheritedPrice(e),n.currencyId=e,n.enabled=!1,this.currencyDependsValue.find(n=>n.currencyId===e)||this.currencyDependsValue.push(n)})},calculateInheritedPrice(e){let n=this.currencyDependsValue.find(e=>!0===e.enabled);return n?this.getPriceByCurrency(n,e):0},getPriceByCurrency(e,n){let t=this.getCurrencyById(n),r=this.getCurrencyById(e.currencyId);return r.factor&&t.factor?e.amount/r.factor*t.factor:0},getCurrencyById(e){return this.currencies.find(n=>n.id===e)||{}},saveCountryCurrencyDependent(){this.$emit("modal-save")}}}},727187:function(e,n,t){var r=t(64097);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),t(745346).Z("be5565c6",r,!0,{})}}]);