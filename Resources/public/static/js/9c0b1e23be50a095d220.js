(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[381],{V8WL:function(t,e,n){"use strict";n.r(e);var o=n("J58c"),i=n.n(o);n("lqvm");function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c=Shopware,r=c.Component,d=c.State,u=c.Context,l=c.Utils,p=Shopware.Data.Criteria,g=r.getComponentHelper(),m=g.mapState,f=g.mapGetters,h=l.object,y=h.cloneDeep,w=h.merge,P=h.get;e.default={template:'\n{% block sw_product_detail_layout %}\n<div v-if="isLoading">\n    <sw-skeleton variant="detail-bold" />\n    <sw-skeleton />\n</div>\n\n<div\n    v-else\n    class="sw-product-detail-layout"\n>\n    \n    {% block sw_product_detail_layout_assignment %}\n    <sw-card\n        position-identifier="sw-product-detail-layout-assignment"\n        :title="$tc(\'sw-product.layout.title\')"\n        :subtitle="$tc(\'sw-product.layout.subtitle\')"\n    >\n\n        \n        {% block sw_product_detail_layout_content %}\n        <sw-product-layout-assignment\n            :cms-page="currentPage"\n            @modal-layout-open="onOpenLayoutModal"\n            @button-edit-click="onOpenInPageBuilder"\n            @button-delete-click="onResetLayout"\n        />\n        {% endblock %}\n\n        \n        {% block sw_product_detail_layout_modal %}\n        <sw-cms-layout-modal\n            v-if="showLayoutModal"\n            :headline="$tc(\'sw-product.layoutAssignment.subtitle\')"\n            :pre-selection="currentPage"\n            :cms-page-types="[\'product_detail\']"\n            @modal-layout-select="onSelectLayout"\n            @modal-close="onCloseLayoutModal"\n        />\n        {% endblock %}\n    </sw-card>\n    {% endblock %}\n\n    \n    {% block sw_product_detail_layout_cms_config %}\n    <template v-if="acl.can(\'product.editor\') && currentPage">\n        \n        {% block sw_product_detail_layout_cms_config_form %}\n        <sw-cms-page-form\n            v-if="showCmsForm"\n            :page="currentPage"\n        />\n\n        <sw-card\n            v-else\n            class="sw-product-detail-layout__no-config"\n            position-identifier="sw-product-detail-layout-no-config"\n            :is-loading="isConfigLoading"\n        >\n            <p>{{ $tc(\'sw-product.layout.textNoConfig\') }}</p>\n        </sw-card>\n        {% endblock %}\n\n        \n        {% block sw_product_detail_layout_cms_content_info %}\n        <sw-card\n            hero\n            position-identifier="sw-product-detail-layout-cms-info"\n        >\n            <p class="sw-product-detail-layout__content-info">\n                {{ $tc(\'sw-product.layout.textContentInfo\') }}\n            </p>\n        </sw-card>\n        {% endblock %}\n    </template>\n    {% endblock %}\n</div>\n{% endblock %}\n',inject:["repositoryFactory","cmsService","feature","acl"],data:function(){return{showLayoutModal:!1,isConfigLoading:!1}},computed:s(s(s(s({cmsPageRepository:function(){return this.repositoryFactory.create("cms_page")},cmsPageId:function(){return P(this.product,"cmsPageId",null)},showCmsForm:function(){return!(this.isLoading&&this.isConfigLoading||this.currentPage.locked)}},m("swProductDetail",["product"])),f("swProductDetail",["isLoading"])),m("cmsPageState",["currentPage"])),{},{cmsPageCriteria:function(){var t=new p(1,25);return t.addAssociation("previewMedia"),t.addAssociation("sections"),t.getAssociation("sections").addSorting(p.sort("position")),t.addAssociation("sections.blocks"),t.getAssociation("sections.blocks").addSorting(p.sort("position","ASC")).addAssociation("slots"),t}}),watch:{cmsPageId:function(){d.dispatch("cmsPageState/resetCmsPageState"),this.handleGetCmsPage()},product:{deep:!0,handler:function(t){t&&this.updateCmsPageDataMapping()}}},created:function(){this.createdComponent()},methods:{createdComponent:function(){var t,e;(null!==(t=null===(e=this.currentPage)||void 0===e?void 0:e.sections)&&void 0!==t?t:[]).length||this.handleGetCmsPage()},onOpenLayoutModal:function(){this.acl.can("product.editor")&&(this.showLayoutModal=!0)},onCloseLayoutModal:function(){this.showLayoutModal=!1},onOpenInPageBuilder:function(){this.currentPage?this.$router.push({name:"sw.cms.detail",params:{id:this.currentPage.id}}):this.$router.push({name:"sw.cms.create"})},onSelectLayout:function(t){this.product&&(this.product.cmsPageId=t,this.product.slotConfig=null,d.commit("swProductDetail/setProduct",this.product))},handleGetCmsPage:function(){var t=this;this.cmsPageId&&(this.isConfigLoading=!0,this.cmsPageRepository.get(this.cmsPageId,u.api,this.cmsPageCriteria).then((function(e){t.product.slotConfig&&e&&e.sections.forEach((function(e){e.blocks.forEach((function(e){e.slots.forEach((function(e){t.product.slotConfig[e.id]&&(e.config=e.config||{},w(e.config,y(t.product.slotConfig[e.id])))}))}))})),d.commit("cmsPageState/setCurrentPage",e),t.updateCmsPageDataMapping(),t.isConfigLoading=!1})))},updateCmsPageDataMapping:function(){Shopware.State.commit("cmsPageState/setCurrentMappingEntity","product"),Shopware.State.commit("cmsPageState/setCurrentMappingTypes",this.cmsService.getEntityMappingTypes("product")),Shopware.State.commit("cmsPageState/setCurrentDemoEntity",this.product)},onResetLayout:function(){this.onSelectLayout(null)}}}},VewF:function(t,e,n){},lqvm:function(t,e,n){var o=n("VewF");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,n("ydqr").default)("e45fe160",o,!0,{})}}]);