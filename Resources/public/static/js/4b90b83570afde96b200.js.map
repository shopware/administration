{"version":3,"sources":["webpack:///./src/module/sw-promotion-v2/view/sw-promotion-v2-detail-base/index.js","webpack:///./src/module/sw-promotion-v2/view/sw-promotion-v2-detail-base/sw-promotion-v2-detail-base.html.twig"],"names":["Mixin","Shopware","mapPropertyErrors","Component","getComponentHelper","template","inject","mixins","getByName","props","promotion","type","Object","required","default","isLoading","Boolean","isCreateMode","data","selectedCodeType","isGenerating","isGenerateSuccessful","codeSortProperty","codeSortDirection","CODE_TYPES","freeze","NONE","FIXED","INDIVIDUAL","customFieldSets","computed","_objectSpread","codeTypeOptions","_this","entries","this","map","create","label","$tc","concat","toLowerCase","value","showCustomFields","length","watch","createdComponent","created","methods","loadCustomFieldSets","useCodes","useIndividualCodes","setNewCodeType","initialSort","_this2","individualCodes","sort","a","b","aValue","bValue","isBigger","toUpperCase","onChangeCodeType","hasInactiveIndividualCodes","hasInactiveFixedCode","code","$emit","_this3","customFieldDataProviderService","getCustomFieldSets","then","sets","onGenerateCodeFixed","_this4","promotionCodeApiService","generateCodeFixed","finally","generateFinish"],"mappings":"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","file":"static/js/4b90b83570afde96b200.js","sourcesContent":["/**\n * @package buyers-experience\n */\nimport template from './sw-promotion-v2-detail-base.html.twig';\n\nconst { Mixin } = Shopware;\nconst { mapPropertyErrors } = Shopware.Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: [\n        'acl',\n        'promotionCodeApiService',\n        'customFieldDataProviderService',\n    ],\n\n    mixins: [\n        Mixin.getByName('placeholder'),\n    ],\n\n    props: {\n        promotion: {\n            type: Object,\n            required: false,\n            default() {\n                return null;\n            },\n        },\n\n        isLoading: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n\n        isCreateMode: {\n            type: Boolean,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            selectedCodeType: '0',\n            isGenerating: false,\n            isGenerateSuccessful: false,\n            codeSortProperty: 'code',\n            codeSortDirection: 'ASC',\n            CODE_TYPES: Object.freeze({\n                NONE: '0',\n                FIXED: '1',\n                INDIVIDUAL: '2',\n            }),\n            customFieldSets: null,\n        };\n    },\n\n    computed: {\n        codeTypeOptions() {\n            return Object.entries(this.CODE_TYPES).map(type => Object.create({\n                label: this.$tc(`sw-promotion-v2.detail.base.codes.${type[0].toLowerCase()}.description`),\n                value: type[1],\n            }));\n        },\n\n        ...mapPropertyErrors('promotion', ['name', 'validUntil']),\n\n        showCustomFields() {\n            return this.customFieldSets && this.customFieldSets.length > 0;\n        },\n    },\n\n    watch: {\n        promotion() {\n            this.createdComponent();\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            if (!this.promotion) {\n                return;\n            }\n\n            this.loadCustomFieldSets();\n\n            if (this.promotion.useCodes && this.promotion.useIndividualCodes) {\n                this.setNewCodeType(this.CODE_TYPES.INDIVIDUAL);\n                this.initialSort();\n\n                return;\n            }\n\n            this.setNewCodeType(this.promotion.useCodes ? this.CODE_TYPES.FIXED : this.CODE_TYPES.NONE);\n        },\n\n        initialSort() {\n            this.promotion.individualCodes.sort((a, b) => {\n                const aValue = a[this.codeSortProperty];\n                const bValue = b[this.codeSortProperty];\n\n                let isBigger = null;\n\n                if (typeof aValue === 'string' && typeof bValue === 'string') {\n                    isBigger = aValue.toUpperCase() > bValue.toUpperCase();\n                }\n\n                if (typeof aValue === 'number' && typeof bValue === 'number') {\n                    isBigger = (aValue - bValue) > 0;\n                }\n\n                if (isBigger !== null) {\n                    if (this.codeSortDirection === 'DESC') {\n                        return isBigger ? -1 : 1;\n                    }\n\n                    return isBigger ? 1 : -1;\n                }\n\n                return 0;\n            });\n        },\n\n        onChangeCodeType(value) {\n            const hasInactiveIndividualCodes = value !== this.CODE_TYPES.INDIVIDUAL &&\n                (this.promotion.individualCodes !== null && this.promotion.individualCodes.length > 0);\n            const hasInactiveFixedCode = value !== this.CODE_TYPES.FIXED &&\n                (this.promotion.code !== null && this.promotion.code.length > 0);\n\n            this.$emit('clean-up-codes', hasInactiveIndividualCodes, hasInactiveFixedCode);\n            this.setNewCodeType(value);\n        },\n\n        setNewCodeType(value) {\n            this.promotion.useCodes = value !== this.CODE_TYPES.NONE;\n            this.promotion.useIndividualCodes = value === this.CODE_TYPES.INDIVIDUAL;\n\n            this.selectedCodeType = value;\n        },\n\n        loadCustomFieldSets() {\n            this.customFieldDataProviderService.getCustomFieldSets('promotion').then((sets) => {\n                this.customFieldSets = sets;\n            });\n        },\n\n        onGenerateCodeFixed() {\n            this.isGenerating = true;\n            this.promotionCodeApiService.generateCodeFixed().then((code) => {\n                this.promotion.code = code;\n                this.isGenerateSuccessful = true;\n            }).finally(() => {\n                this.isGenerating = false;\n            });\n        },\n\n        generateFinish() {\n            this.isGenerateSuccessful = false;\n        },\n    },\n};\n","export default \"\\n{% block sw_promotion_v2_detail_base %}\\n<div class=\\\"sw-promotion-v2-detail-base\\\">\\n\\n    \\n    {% block sw_promotion_v2_detail_base_general_card %}\\n    <sw-card\\n        v-if=\\\"promotion\\\"\\n        position-identifier=\\\"sw-promotion-detail-base-general\\\"\\n        class=\\\"sw-promotion-v2-detail-base__card-general\\\"\\n        :is-loading=\\\"isLoading\\\"\\n        :title=\\\"$tc('sw-promotion-v2.detail.base.general.cardTitle')\\\"\\n    >\\n\\n        \\n        {% block sw_promotion_v2_detail_base_general_name %}\\n        <sw-container\\n            columns=\\\"2fr 1fr\\\"\\n            gap=\\\"0 32px\\\"\\n        >\\n            <sw-text-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"promotion.name\\\"\\n                {% else %}\\n                v-model=\\\"promotion.name\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-detail-base__field-name\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.general.nameLabel')\\\"\\n                :disabled=\\\"!acl.can('promotion.editor')\\\"\\n                required\\n                :error=\\\"promotionNameError\\\"\\n                :placeholder=\\\"placeholder(promotion, 'name', $tc('sw-promotion-v2.detail.base.general.namePlaceholder'))\\\"\\n            />\\n\\n            <sw-number-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"promotion.priority\\\"\\n                {% else %}\\n                v-model=\\\"promotion.priority\\\"\\n                {% endif %}\\n                :disabled=\\\"!acl.can('promotion.editor')\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.general.priorityLabel')\\\"\\n            />\\n        </sw-container>\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_detail_base_general_valid_container %}\\n        <sw-container\\n            columns=\\\"1fr 1fr\\\"\\n            gap=\\\"0 32px\\\"\\n        >\\n\\n            \\n            {% block sw_promotion_v2_detail_base_general_valid_from %}\\n            <sw-datepicker\\n                {% if VUE3 %}\\n                v-model:value=\\\"promotion.validFrom\\\"\\n                {% else %}\\n                v-model=\\\"promotion.validFrom\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-detail-base__field-valid-from\\\"\\n                date-type=\\\"datetime\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.general.validFromLabel')\\\"\\n                :placeholder-text=\\\"$tc('sw-promotion-v2.detail.base.general.validFromPlaceholder')\\\"\\n                :disabled=\\\"!acl.can('promotion.editor')\\\"\\n            />\\n            {% endblock %}\\n\\n            \\n            {% block sw_promotion_v2_detail_base_general_valid_until %}\\n            <sw-datepicker\\n                {% if VUE3 %}\\n                v-model:value=\\\"promotion.validUntil\\\"\\n                {% else %}\\n                v-model=\\\"promotion.validUntil\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-detail-base__field-valid-until\\\"\\n                date-type=\\\"datetime\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.general.validUntilLabel')\\\"\\n                :placeholder-text=\\\"$tc('sw-promotion-v2.detail.base.general.validUntilPlaceholder')\\\"\\n                :disabled=\\\"!acl.can('promotion.editor')\\\"\\n                :error=\\\"promotionValidUntilError\\\"\\n            />\\n            {% endblock %}\\n\\n        </sw-container>\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_detail_base_general_max_uses %}\\n        <sw-container\\n            columns=\\\"1fr 1fr\\\"\\n            gap=\\\"0 32px\\\"\\n        >\\n\\n            \\n            {% block sw_promotion_v2_detail_base_general_max_uses_global %}\\n            <sw-number-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"promotion.maxRedemptionsGlobal\\\"\\n                {% else %}\\n                v-model=\\\"promotion.maxRedemptionsGlobal\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-detail-base__field-max-uses-global\\\"\\n                number-type=\\\"int\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.general.maxUsesGlobalLabel')\\\"\\n                :placeholder=\\\"$tc('sw-promotion-v2.detail.base.general.maxUsesGlobalPlaceholder')\\\"\\n                :disabled=\\\"!acl.can('promotion.editor')\\\"\\n                allow-empty\\n            />\\n            {% endblock %}\\n\\n            \\n            {% block sw_promotion_v2_detail_base_general_max_uses_customer %}\\n            <sw-number-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"promotion.maxRedemptionsPerCustomer\\\"\\n                {% else %}\\n                v-model=\\\"promotion.maxRedemptionsPerCustomer\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-detail-base__field-max-uses-per-customer\\\"\\n                number-type=\\\"int\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.general.maxUsesPerCustomerLabel')\\\"\\n                :placeholder=\\\"$tc('sw-promotion-v2.detail.base.general.maxUsesPerCustomerPlaceholder')\\\"\\n                :disabled=\\\"!acl.can('promotion.editor')\\\"\\n                allow-empty\\n            />\\n            {% endblock %}\\n\\n        </sw-container>\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_detail_base_general_active %}\\n        <sw-switch-field\\n            {% if VUE3 %}\\n            v-model:value=\\\"promotion.active\\\"\\n            {% else %}\\n            v-model=\\\"promotion.active\\\"\\n            {% endif %}\\n            class=\\\"sw-promotion-v2-detail-base__field-active\\\"\\n            :label=\\\"$tc('sw-promotion-v2.detail.base.general.activeLabel')\\\"\\n            :disabled=\\\"!acl.can('promotion.editor')\\\"\\n            bordered\\n        />\\n        {% endblock %}\\n\\n    </sw-card>\\n    {% endblock %}\\n\\n    \\n    {% block sw_promotion_v2_detail_base_codes_card %}\\n    <sw-card\\n        v-if=\\\"promotion && !isCreateMode\\\"\\n        class=\\\"sw-promotion-v2-detail-base__card-codes\\\"\\n        position-identifier=\\\"sw-promotion-detail-base-codes\\\"\\n        :is-loading=\\\"isLoading\\\"\\n        :title=\\\"$tc('sw-promotion-v2.detail.base.codes.cardTitle')\\\"\\n    >\\n\\n        \\n        {% block sw_promotion_v2_detail_base_codes_select %}\\n        <sw-select-field\\n            class=\\\"sw-promotion-v2-detail-base__field-code-type\\\"\\n            :label=\\\"$tc('sw-promotion-v2.detail.base.codes.codeTypeLabel')\\\"\\n            :disabled=\\\"!acl.can('promotion.editor')\\\"\\n            :value=\\\"selectedCodeType\\\"\\n            {% if VUE3 %}\\n            @update:value=\\\"onChangeCodeType\\\"\\n            {% else %}\\n            @change=\\\"onChangeCodeType\\\"\\n            {% endif %}\\n        >\\n\\n            \\n            {% block sw_promotion_v2_detail_base_codes_select_options %}\\n            <option\\n                v-for=\\\"option in codeTypeOptions\\\"\\n                :key=\\\"option.value\\\"\\n                :value=\\\"option.value\\\"\\n                :selected=\\\"option.value === selectedCodeType\\\"\\n            >\\n                {{ option.label }}\\n            </option>\\n            {% endblock %}\\n\\n        </sw-select-field>\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_detail_base_codes_type_fixed %}\\n        <template v-if=\\\"selectedCodeType === CODE_TYPES.FIXED\\\">\\n\\n            \\n            {% block sw_promotion_v2_detail_base_codes_type_fixed_code %}\\n            <sw-text-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"promotion.code\\\"\\n                {% else %}\\n                v-model=\\\"promotion.code\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-detail-base__fixed-field-code\\\"\\n                :disabled=\\\"!acl.can('promotion.editor')\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.codes.fixed.codeLabel')\\\"\\n                :placeholder=\\\"$tc('sw-promotion-v2.detail.base.codes.fixed.codePlaceholder')\\\"\\n                copyable\\n            />\\n            {% endblock %}\\n\\n            \\n            {% block sw_promotion_v2_detail_base_codes_type_fixed_generate %}\\n            <sw-button-process\\n                class=\\\"sw-promotion-v2-detail-base__fixed-generate-button\\\"\\n                :is-loading=\\\"isGenerating\\\"\\n                :disabled=\\\"!acl.can('promotion.editor')\\\"\\n                :process-success=\\\"isGenerateSuccessful\\\"\\n                {% if VUE3 %}\\n                @update:process-success=\\\"generateFinish\\\"\\n                {% else %}\\n                @process-finish=\\\"generateFinish\\\"\\n                {% endif %}\\n                @click.prevent=\\\"onGenerateCodeFixed\\\"\\n            >\\n                {{ $tc('sw-promotion-v2.detail.base.codes.fixed.generateButton') }}\\n            </sw-button-process>\\n            {% endblock %}\\n\\n        </template>\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_detail_base_codes_type_individual %}\\n        <template v-else-if=\\\"selectedCodeType === CODE_TYPES.INDIVIDUAL\\\">\\n\\n            \\n            {% block sw_promotion_v2_detail_base_codes_type_individual_codes_behavior %}\\n            <sw-promotion-v2-individual-codes-behavior\\n                :promotion=\\\"promotion\\\"\\n                @generate-finish=\\\"$emit('generate-individual-codes-finish')\\\"\\n                @delete-finish=\\\"$emit('delete-individual-codes-finish')\\\"\\n            />\\n            {% endblock %}\\n\\n        </template>\\n        {% endblock %}\\n\\n    </sw-card>\\n    {% endblock %}\\n\\n    \\n    {% block sw_promotion_detail_custom_field_sets %}\\n    <sw-card\\n        v-if=\\\"showCustomFields\\\"\\n        position-identifier=\\\"sw-promotion-detail-base-custom-field-sets\\\"\\n        :title=\\\"$tc('sw-settings-custom-field.general.mainMenuItemGeneral')\\\"\\n        :is-loading=\\\"isLoading\\\"\\n    >\\n        <sw-custom-field-set-renderer\\n            :entity=\\\"promotion\\\"\\n            :disabled=\\\"!acl.can('promotion.editor')\\\"\\n            :sets=\\\"customFieldSets\\\"\\n        />\\n    </sw-card>\\n    {% endblock %}\\n</div>\\n{% endblock %}\\n\";"],"sourceRoot":""}