{"version":3,"sources":["webpack:///./src/app/asyncComponent/media/sw-media-field/index.js","webpack:///./src/app/asyncComponent/media/sw-media-field/sw-media-field.html.twig","webpack:///./src/app/asyncComponent/media/sw-media-field/sw-media-field.scss"],"names":["_Shopware","Shopware","Context","Utils","Criteria","Data","template","inject","model","prop","event","props","_objectSpread","value","type","String","required","default","disabled","Boolean","window","_features_","vue3","mediaId","label","defaultFolder","validator","length","fileAccept","data","searchTerm","mediaEntity","showPicker","showUploadField","suggestedItems","isLoadingSuggestions","pickerClasses","uploadTag","createId","computed","get","this","set","newValue","$emit","mediaRepository","repositoryFactory","create","mediaFieldClasses","toggleButtonLabel","$tc","suggestionCriteria","criteria","addFilter","not","equals","multi","contains","watch","fetchItem","feature","isActive","created","createdComponent","methods","onSearchTermChange","fetchSuggestions","_arguments","arguments","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","id","wrap","_context","prev","next","undefined","abrupt","api","sent","stop","_this2","_callee2","_context2","search","t0","Error","finish","onTogglePicker","computePickerPositionAndStyle","mediaItemChanged","newMediaId","removeLink","$el","clientRect","getBoundingClientRect","top","concat","height","toggleUploadField","exposeNewId","_ref","targetId","showLabel","_this$$scopedSlots","_this$$scopedSlots$la","$slots","$scopedSlots","call","content","__esModule","module","i","locals","exports","add"],"mappings":"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","file":"static/js/ff1a533f0c17b495b027.js","sourcesContent":["import template from './sw-media-field.html.twig';\nimport './sw-media-field.scss';\n\nconst { Context, Utils } = Shopware;\nconst { Criteria } = Shopware.Data;\n\n/**\n * @status ready\n * @description The <u>sw-media-field</u> component is used to bind your\n * @package content\n * @example-type code-only\n * @component-example\n * <sw-media-field v-model=\"manufacturer.mediaId\"></sw-media-field>\n */\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: ['repositoryFactory', 'feature'],\n\n    model: {\n        prop: 'mediaId',\n        event: 'media-id-change',\n    },\n\n    props: {\n        // need to be \"value\" instead of \"modelValue\" because of the compat build\n        value: {\n            type: String,\n            required: false,\n            default: null,\n        },\n\n        disabled: {\n            type: Boolean,\n            default: false,\n            required: false,\n        },\n\n        ...(() => {\n            if (window._features_.vue3) {\n                return {};\n            }\n\n            return {\n                mediaId: {\n                    type: String,\n                    required: false,\n                    default: null,\n                },\n            };\n        })(),\n\n        label: {\n            type: String,\n            required: false,\n            default: null,\n        },\n\n        defaultFolder: {\n            type: String,\n            required: false,\n            validator(value) {\n                return value.length > 0;\n            },\n            default: null,\n        },\n\n        fileAccept: {\n            type: String,\n            required: false,\n            default: '*/*',\n        },\n    },\n\n    data() {\n        return {\n            searchTerm: '',\n            mediaEntity: null,\n            showPicker: false,\n            showUploadField: false,\n            suggestedItems: [],\n            isLoadingSuggestions: false,\n            pickerClasses: {},\n            uploadTag: Utils.createId(),\n        };\n    },\n\n    computed: {\n        ...(() => {\n            if (window._features_.vue3) {\n                return {\n                    mediaId: {\n                        get() {\n                            return this.value;\n                        },\n                        set(newValue) {\n                            this.$emit('update:value', newValue);\n                        },\n                    },\n                };\n            }\n            return {};\n        })(),\n\n        mediaRepository() {\n            return this.repositoryFactory.create('media');\n        },\n        mediaFieldClasses() {\n            return {\n                'is--active': this.showPicker,\n            };\n        },\n\n        toggleButtonLabel() {\n            return this.showUploadField ?\n                this.$tc('global.sw-media-field.labelToggleSearchExisting') :\n                this.$tc('global.sw-media-field.labelToggleUploadNew');\n        },\n\n        suggestionCriteria() {\n            const criteria = new Criteria(1, 5);\n\n            criteria.addFilter(Criteria.not(\n                'AND',\n                [Criteria.equals('uploadedAt', null)],\n            ));\n\n            if (this.searchTerm) {\n                criteria.addFilter(Criteria.multi(\n                    'OR',\n                    [\n                        Criteria.contains('fileName', this.searchTerm),\n                        Criteria.contains('fileExtension', this.searchTerm),\n                    ],\n                ));\n            }\n\n            if (this.defaultFolder) {\n                criteria.addFilter(Criteria.equals('mediaFolder.defaultFolder.entity', this.defaultFolder));\n            }\n\n            return criteria;\n        },\n    },\n\n    watch: {\n        mediaId(newValue) {\n            this.fetchItem(newValue);\n            if (this.feature.isActive('VUE3')) {\n                this.$emit('update:value', newValue);\n            } else {\n                this.$emit('media-id-change', newValue);\n            }\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.fetchItem();\n        },\n\n        onSearchTermChange(searchTerm) {\n            this.searchTerm = searchTerm;\n            this.fetchSuggestions();\n        },\n\n        async fetchItem(id = this.mediaId) {\n            if (!id) {\n                this.mediaEntity = null;\n                return;\n            }\n            this.mediaEntity = await this.mediaRepository.get(id, Context.api);\n        },\n\n        async fetchSuggestions() {\n            this.isLoadingSuggestions = true;\n\n            try {\n                this.suggestedItems = await this.mediaRepository.search(this.suggestionCriteria, Context.api);\n            } catch (e) {\n                throw new Error(e);\n            } finally {\n                this.isLoadingSuggestions = false;\n            }\n        },\n\n        onTogglePicker() {\n            this.showPicker = !this.showPicker;\n\n            if (this.showPicker) {\n                this.showUploadField = false;\n                this.computePickerPositionAndStyle();\n                this.fetchSuggestions();\n            }\n        },\n\n        mediaItemChanged(newMediaId) {\n            if (this.feature.isActive('VUE3')) {\n                this.$emit('update:value', newMediaId);\n            } else {\n                this.$emit('media-id-change', newMediaId);\n            }\n            this.onTogglePicker();\n        },\n\n        removeLink() {\n            if (this.feature.isActive('VUE3')) {\n                this.$emit('update:value', null);\n            } else {\n                this.$emit('media-id-change', null);\n            }\n        },\n\n        computePickerPositionAndStyle() {\n            if (!this.$el) {\n                this.pickerClasses = {};\n                return;\n            }\n\n            const clientRect = this.$el.getBoundingClientRect();\n            this.pickerClasses = {\n                top: `${clientRect.height + 5}px`,\n            };\n        },\n\n        toggleUploadField() {\n            this.showUploadField = !this.showUploadField;\n        },\n\n        exposeNewId({ targetId }) {\n            if (this.feature.isActive('VUE3')) {\n                this.$emit('update:value', targetId);\n            } else {\n                this.$emit('media-id-change', targetId);\n            }\n            this.showUploadField = false;\n            this.showPicker = false;\n        },\n\n        showLabel() {\n            return !!this.label || !!this.$slots.label || !!this.$scopedSlots?.label?.();\n        },\n    },\n};\n","export default \"\\n{% block sw_media_field %}\\n<div class=\\\"sw-media-field\\\">\\n    \\n    {% block sw_media_field_label %}\\n    \\n    <label\\n        v-if=\\\"showLabel\\\"\\n        class=\\\"sw-media-field__label\\\"\\n    >\\n        <slot name=\\\"label\\\">\\n            {{ label }}\\n        </slot>\\n    </label>\\n    {% endblock %}\\n\\n    \\n    {% block sw_media_field_input %}\\n    <div\\n        class=\\\"sw-media-field__input-container\\\"\\n        :class=\\\"mediaFieldClasses\\\"\\n    >\\n        \\n        {% block sw_media_field_preview %}\\n        <sw-media-media-item\\n            v-if=\\\"mediaEntity\\\"\\n            class=\\\"sw-media-field__media-list-item sw-media-field__input\\\"\\n            :item=\\\"mediaEntity\\\"\\n            :is-list=\\\"true\\\"\\n            :show-context-menu-button=\\\"false\\\"\\n            :editable=\\\"false\\\"\\n        />\\n        <div\\n            v-else\\n            class=\\\"sw-media-field__empty-preview sw-media-field__input\\\"\\n        ></div>\\n        {% endblock %}\\n\\n        \\n        {% block sw_media_field_toggle_button %}\\n        <sw-button\\n            class=\\\"sw-media-field__toggle-button\\\"\\n            square\\n            :disabled=\\\"disabled\\\"\\n            @click=\\\"onTogglePicker\\\"\\n        >\\n            \\n            {% block sw_media_field_media_icon %}\\n            <sw-icon name=\\\"regular-image\\\" />\\n            {% endblock %}\\n\\n            \\n            {% block sw_media_field_media_popover %}\\n            <sw-popover\\n                v-if=\\\"showPicker\\\"\\n                :z-index=\\\"1000\\\"\\n                popover-class=\\\"sw-media-field__expanded-content\\\"\\n                class=\\\"sw-media-field__popover\\\"\\n            >\\n                <div @click.stop>\\n                    \\n                    {% block sw_media_field_action_bar %}\\n                    <div class=\\\"sw-media-field__actions_bar\\\">\\n                        \\n                        {% block sw_media_field_action_bar_button_toggle %}\\n                        <sw-button\\n                            class=\\\"sw-media-field__action-button\\\"\\n                            @click=\\\"toggleUploadField\\\"\\n                        >\\n                            <sw-icon\\n                                class=\\\"sw-media-field__icon-add\\\"\\n                                name=\\\"regular-plus\\\"\\n                                small\\n                            />\\n                            {{ toggleButtonLabel }}\\n                        </sw-button>\\n                        {% endblock %}\\n\\n                        \\n                        {% block sw_media_field_action_bar_button_unlink %}\\n                        <sw-button\\n                            v-if=\\\"mediaId\\\"\\n                            class=\\\"sw-media-field__action-button is--remove\\\"\\n                            @click=\\\"removeLink\\\"\\n                        >\\n                            <sw-icon\\n                                class=\\\"sw-media-field__icon-remove\\\"\\n                                name=\\\"regular-times-circle-s\\\"\\n                                small\\n                            />\\n                            {{ $tc('global.sw-media-field.labelUnlink') }}\\n                        </sw-button>\\n                        {% endblock %}\\n                    </div>\\n                    {% endblock %}\\n\\n                    \\n                    {% block sw_media_field_upload_component %}\\n                    <sw-upload-listener\\n                        :upload-tag=\\\"uploadTag\\\"\\n                        auto-upload\\n                        @media-upload-finish=\\\"exposeNewId\\\"\\n                    />\\n                    <sw-media-upload-v2\\n                        v-if=\\\"showUploadField\\\"\\n                        variant=\\\"regular\\\"\\n                        :file-accept=\\\"fileAccept\\\"\\n                        :default-folder=\\\"defaultFolder\\\"\\n                        :allow-multi-select=\\\"false\\\"\\n                        :upload-tag=\\\"uploadTag\\\"\\n                        :disabled=\\\"disabled\\\"\\n                    />\\n                    {% endblock %}\\n\\n                    <div\\n                        v-else\\n                        class=\\\"sw-media-field__media-selection\\\"\\n                    >\\n                        \\n                        {% block sw_media_field_search_field %}\\n                        <sw-simple-search-field\\n                            v-model=\\\"searchTerm\\\"\\n                            @search-term-change=\\\"onSearchTermChange\\\"\\n                        />\\n                        {% endblock %}\\n\\n                        \\n                        {% block sw_media_field_media_list %}\\n                        <sw-loader\\n                            v-if=\\\"isLoadingSuggestions\\\"\\n                            class=\\\"sw-media-field__picker-loader\\\"\\n                        />\\n\\n                        <ul\\n                            v-else\\n                            class=\\\"sw-media-field__suggestion-list\\\"\\n                        >\\n                            <li\\n                                v-for=\\\"suggestion in suggestedItems\\\"\\n                                :key=\\\"suggestion.id\\\"\\n                                class=\\\"sw-media-field__suggestion-list-entry\\\"\\n                            >\\n                                \\n                                {% block sw_media_field_suggestion_preview %}\\n                                <sw-media-media-item\\n                                    class=\\\"sw-media-field__media-list-item\\\"\\n                                    :item=\\\"suggestion\\\"\\n                                    :is-list=\\\"true\\\"\\n                                    :show-context-menu-button=\\\"false\\\"\\n                                    @media-item-click=\\\"mediaItemChanged(suggestion.id)\\\"\\n                                />\\n                                {% endblock %}\\n                            </li>\\n                        </ul>\\n                        {% endblock %}\\n                    </div>\\n                </div>\\n            </sw-popover>\\n            {% endblock %}\\n        </sw-button>\\n        {% endblock %}\\n    </div>\\n    {% endblock %}\\n</div>\\n{% endblock %}\\n\";","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-media-field.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6aa329a6\", content, true, {});"],"sourceRoot":""}