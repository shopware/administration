(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[40],{"8z3Y":function(e,t,n){},Kh29:function(e,t,n){"use strict";n.r(t);var i=n("CsSd"),a=n.n(i),s=n("7yzw"),o=n.n(s),l=n("92Mt"),r=n.n(l);n("wBHZ");function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=Shopware,u=m.Context,f=m.Mixin,g=m.Filter;t.default={template:'\n{% block sw_media_modal_delete %}\n<sw-modal\n    variant="small"\n    class="sw-media-modal-delete"\n    :title="snippets.modalTitle"\n    @modal-close="closeDeleteModal($event)"\n>\n\n    \n    {% block sw_media_modal_body %}\n    <div v-if="mediaQuickInfo">\n        <p>{{ $tc(\'global.sw-media-modal-delete.mediaQuickInfoMessage\') }}</p>\n        <sw-media-quickinfo-usage\n            :item="mediaQuickInfo"\n            router-link-target="_blank"\n        />\n    </div>\n    <div v-if="mediaInUsages && mediaInUsages.length > 0">\n        <p>{{ $tc(\'global.sw-media-modal-delete.mediaInUsagesMessage\') }}</p>\n        <sw-media-media-item\n            v-for="mediaInUsage in mediaInUsages"\n            :key="`sw-media-modal-delete-${mediaInUsage.id}`"\n            class="sw-media-modal-delete__media-list-item"\n            :item="mediaInUsage"\n            :is-list="true"\n            :editable="false"\n            :selected="false"\n            :show-selection-indicator="false"\n            :show-context-menu-button="false"\n        />\n    </div>\n    <p v-html="$sanitize(snippets.deleteMessage)"></p>\n    {% endblock %}\n\n    \n    {% block sw_media_modal_footer %}\n    <template #modal-footer>\n\n        \n        {% block sw_media_modal_delete_cancel_button %}\n        <sw-button\n            size="small"\n            @click="closeDeleteModal($event)"\n        >\n            {{ $tc(\'global.default.cancel\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_media_modal_delete_confirm_button %}\n        <sw-button\n            class="sw-media-modal-delete__confirm"\n            size="small"\n            variant="danger"\n            @click="deleteSelection($event)"\n        >\n            {{ $tc(\'global.default.delete\') }}\n        </sw-button>\n        {% endblock %}\n\n    </template>\n    {% endblock %}\n</sw-modal>\n{% endblock %}\n',inject:["repositoryFactory"],mixins:[f.getByName("notification")],props:{itemsToDelete:{required:!0,type:Array,validator:function(e){return 0!==e.length}}},data:function(){return{mediaItems:[],folders:[],notificationId:null}},computed:{mediaRepository:function(){return this.repositoryFactory.create("media")},mediaFolderRepository:function(){return this.repositoryFactory.create("media_folder")},mediaNameFilter:function(){return g.getByName("mediaName")},snippets:function(){return this.mediaItems.length>0&&this.folders.length>0?{successOverall:"global.sw-media-modal-delete.notification.successOverall.message.mediaAndFolder",errorOverall:this.$tc("global.sw-media-modal-delete.notification.errorOverall.message.mediaAndFolder"),modalTitle:this.$tc("global.default.warning"),deleteMessage:this.$tc("global.sw-media-modal-delete.deleteMessage.mediaAndFolder",this.itemsToDelete.length,{mediaCount:this.mediaItems.length,folderCount:this.folders.length})}:this.mediaItems.length>0?{successOverall:"global.sw-media-modal-delete.notification.successOverall.message.media",errorOverall:this.$tc("global.sw-media-modal-delete.notification.errorOverall.message.media"),modalTitle:this.$tc("global.default.warning"),deleteMessage:this.$tc("global.sw-media-modal-delete.deleteMessage.media",this.mediaItems.length,{name:this.mediaNameFilter(this.mediaItems[0]),count:this.mediaItems.length})}:{successOverall:"global.sw-media-modal-delete.notification.successOverall.message.folder",errorOverall:this.$tc("global.sw-media-modal-delete.notification.errorOverall.message.folder"),modalTitle:this.$tc("global.default.warning"),deleteMessage:this.$tc("global.sw-media-modal-delete.deleteMessage.folder",this.folders.length,{name:this.folders[0].name,count:this.folders.length})}},mediaQuickInfo:function(){return 1===this.mediaItems.length&&this._checkInUsage(this.mediaItems[0])?this.mediaItems[0]:null},mediaInUsages:function(){var e=this;return this.mediaItems.length<=1?[]:this.mediaItems.filter((function(t){return e._checkInUsage(t)}))}},created:function(){this.createdComponent()},methods:{createdComponent:function(){this.mediaItems=this.itemsToDelete.filter((function(e){return"media"===e.getEntityName()})),this.folders=this.itemsToDelete.filter((function(e){return"media_folder"===e.getEntityName()}))},closeDeleteModal:function(e){this.$emit("media-delete-modal-close",{originalDomEvent:e})},getEntityRepository:function(e){return"media"===e?this.mediaRepository:"media_folder"===e?this.mediaFolderRepository:null},_deleteSelection:function(e){var t=this,n=e.getEntityName(),i=this.getEntityRepository(n);return e.isLoading=!0,i.delete(e.id,u.api).then((function(){return!0})).catch((function(){var n="global.sw-media-modal-delete.notification.errorSingle.message",i="media"===e.getEntityName()?t.$tc("".concat(n,".media"),1,{name:t.mediaNameFilter(e)}):t.$tc("".concat(n,".folder"),1,{name:e.name});return t.createNotificationError({message:i}),!1})).finally((function(){e.isLoading=!1}))},deleteSelection:function(){var e=this;return o()(r.a.mark((function t(){var n,i,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.itemsToDelete.map((function(t){return e._deleteSelection(t).catch((function(){return!1}))})),t.next=3,Promise.all(n);case 3:i=t.sent,(a=i.reduce((function(e,t){return e.success=t?e.success+=1:e.success,e.failure=t?e.failure:e.failure+=1,e}),{success:0,failure:0})).success>0&&e.updateSuccessNotification(a.success,a.failure,i.length),e.$emit("media-delete-modal-items-delete",{mediaIds:e.mediaItems.map((function(e){return e.id})),folderIds:e.folders.map((function(e){return e.id}))});case 7:case"end":return t.stop()}}),t)})))()},updateSuccessNotification:function(e,t,n){var i=this;return o()(r.a.mark((function a(){var s,o;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s={message:i.$tc(i.snippets.successOverall,e,{count:e,total:n}),growl:e+t===n},null===i.notificationId){a.next=6;break}return a.next=4,Shopware.State.dispatch("notification/updateNotification",c({uuid:i.notificationId},s));case 4:return e+t===n&&(i.notificationId=null),a.abrupt("return");case 6:return a.next=8,Shopware.State.dispatch("notification/createNotification",c({variant:"success"},s));case 8:o=a.sent,e+t<n&&(i.notificationId=o);case 10:case"end":return a.stop()}}),a)})))()},_checkInUsage:function(e){if(e.avatarUsers)return!0;return["categories","productMedia","productManufacturers","mailTemplateMedia","documentBaseConfigs","paymentMethods","shippingMethods","cmsBlocks","cmsSections","cmsPages"].some((function(t){return e[t].length>0}))}}}},wBHZ:function(e,t,n){var i=n("8z3Y");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n("P8hj").default)("6adc66f0",i,!0,{})}}]);