"use strict";(window.webpackJsonpAdministration=window.webpackJsonpAdministration||[]).push([[14242],{714242:function(e,t,s){s.r(t),s.d(t,{default:function(){return n}});let{Mixin:a}=Shopware,i=Shopware.Utils;var n={template:'\n{% block sw_cms_detail_toolbar_language_switch %}\n\n<template #language-switch>\n    <sw-language-switch disabled />\n</template>\n{% endblock %}\n\n\n{% block sw_cms_detail_toolbar_actions_sales_channel %}\n{% endblock %}\n\n\n{% block sw_cms_detail_toolbar_actions_save %}\n<sw-button-process\n    v-tooltip.bottom="tooltipSave"\n    class="sw-cms-detail__save-action"\n    :is-loading="isLoading"\n    :process-success="isSaveSuccessful"\n    :disabled="true"\n    variant="primary"\n>\n    {{ $tc(\'sw-cms.detail.label.buttonSave\') }}\n</sw-button-process>\n{% endblock %}\n\n\n{% block sw_cms_detail_stage_container %}\n<sw-cms-create-wizard\n    :page="page"\n    @on-section-select="onAddSection($event, 0)"\n    @wizard-complete="onWizardComplete"\n/>\n{% endblock %}\n',compatConfig:Shopware.compatConfig,mixins:[a.getByName("placeholder")],data(){return{wizardComplete:!1}},beforeRouteEnter(e,t,s){e.name.includes("sw.cms.create")&&!e.params.id&&(e.params.id=i.createId()),s()},computed:{pageHasSections(){return this.page.sections.length>0&&this.wizardComplete},categoryRepository(){return this.repositoryFactory.create("category")}},methods:{createdComponent(){Shopware.State.commit("adminMenu/collapseSidebar");let e=Shopware.State.getters["context/isSystemDefaultLanguage"];e||(Shopware.State.commit("context/resetLanguageToDefault"),this.$store.commit("cmsPageState/setIsSystemDefaultLanguage",e)),this.page=this.pageRepository.create(),this.page.sections=new Shopware.Data.EntityCollection(`/cms-page/${this.page.id}/sections`,"cms_section",Shopware.Context.api)},async onSave(){return(this.isSaveSuccessful=!1,(!this.isSystemDefaultLanguage||this.page.name)&&this.page.type)?(this.page=await this.assignToEntity(this.page),this.deleteEntityAndRequiredConfigKey(this.page.sections),this.isLoading=!0,this.pageRepository.save(this.page).then(()=>{this.isLoading=!1,this.isSaveSuccessful=!0,this.$router.push({name:"sw.cms.detail",params:{id:this.page.id}})}).catch(e=>(this.isLoading=!1,this.createNotificationError({message:e.message}),Promise.reject(e)))):(this.createNotificationWarning({message:this.$tc("sw-cms.detail.notification.messageMissingFields")}),Promise.reject())},async assignToEntity(e){let{type:t,id:s}=this.$route.params;if(!s||!t)return e;try{if("category"===t){let t=await this.categoryRepository.get(s);t&&e.categories.push(t)}if(t.startsWith("ce_")||t.startsWith("custom_entity_")){let a=this.repositoryFactory.create(t),n=await a.get(s);n&&e.extensions[`${i.string.camelCase(t)}SwCmsPage`].push(n)}}catch(e){this.createNotificationError({message:this.$tc("sw-cms.create.notification.assignToEntityError")})}return e},onWizardComplete(){("product_list"===this.page.type||"product_detail"===this.page.type)&&this.onPageTypeChange(this.page.type),this.wizardComplete=!0,this.onSave()}}}}}]);