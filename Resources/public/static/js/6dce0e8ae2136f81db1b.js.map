{"version":3,"sources":["webpack:///./src/module/sw-order/component/sw-order-document-card/index.js","webpack:///./src/module/sw-order/component/sw-order-document-card/sw-order-document-card.html.twig","webpack:///./src/module/sw-order/component/sw-order-document-card/sw-order-document-card.scss"],"names":["Mixin","Shopware","Criteria","Data","mapGetters","Component","getComponentHelper","template","inject","mixins","getByName","props","order","type","Object","required","isLoading","Boolean","default","attachView","data","documentsLoading","cardLoading","documents","documentTypes","showModal","currentDocumentType","documentNumber","documentComment","term","attachment","isLoadingDocument","isLoadingPreview","showSelectDocumentTypeModal","showSendDocumentModal","sendDocument","computed","_objectSpread","creditItems","items","this","lineItems","forEach","lineItem","push","documentTypeRepository","repositoryFactory","create","documentRepository","documentsEmpty","length","documentModal","subComponentName","technicalName","replace","feature","isActive","concat","getCurrentInstance","appContext","components","$options","documentCardStyles","documentTypeCriteria","criteria","addSorting","sort","documentCriteria","page","limit","addAssociation","addFilter","equals","id","setTerm","addQuery","contains","searchRankingPoint","HIGH_SEARCH_RANKING","getDocumentColumns","columns","property","dataIndex","label","allowResize","primary","align","isDataLoading","showCardFilter","_this$order","_this$order$documents","showCreateDocumentButton","_this$order2","_this$order2$document","emptyStateTitle","_this$order3","_this$order3$document","$tc","tooltipCreateDocumentButton","acl","can","assetFilter","Filter","dateFilter","watch","handler","value","$emit","created","createdComponent","methods","_this","search","then","response","documentService","setListener","convertStoreEventToVueEvent","_ref","_this2","action","payload","DocumentEvents","DOCUMENT_FAILED","errorMessage","detail","code","meta","parameters","createNotificationError","message","DOCUMENT_FINISHED","$nextTick","getList","_this3","total","Promise","resolve","documentTypeAvailable","documentType","invoiceExists","some","document","onSearchTermChange","searchTerm","createDocument","orderId","documentTypeName","params","referencedDocumentId","file","onCancelCreation","onPrepareDocument","openDocument","documentId","documentDeepLink","getDocument","Context","api","link","createElement","href","URL","createObjectURL","target","dispatchEvent","MouseEvent","remove","downloadDocument","filename","headers","split","download","markDocumentAsSent","_this4","get","sent","save","markDocumentAsUnsent","_this5","onCreateDocument","additionalAction","_arguments","arguments","_this6","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_response$data","_response$data2","documentData","wrap","_context","prev","next","undefined","abrupt","Array","isArray","documentMediaFileId","finish","stop","onPreview","_this7","getDocumentPreview","deepLinkCode","finally","onOpenDocument","deepLink","onDownload","onSendDocument","onMarkDocumentAsSent","onMarkDocumentAsUnsent","onCloseSendDocumentModal","onDocumentSent","onLoadingDocument","onLoadingPreview","onShowSelectDocumentTypeModal","onCloseSelectDocumentTypeModal","persist","content","__esModule","module","i","locals","exports","add"],"mappings":"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","file":"static/js/6dce0e8ae2136f81db1b.js","sourcesContent":["import { DocumentEvents } from 'src/core/service/api/document.api.service';\nimport { searchRankingPoint } from 'src/app/service/search-ranking.service';\nimport { getCurrentInstance } from 'vue';\nimport template from './sw-order-document-card.html.twig';\nimport './sw-order-document-card.scss';\n\n/**\n * @package checkout\n */\n\nconst { Mixin } = Shopware;\nconst { Criteria } = Shopware.Data;\nconst { mapGetters } = Shopware.Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: [\n        'documentService',\n        'numberRangeService',\n        'repositoryFactory',\n        'feature',\n        'acl',\n    ],\n\n    mixins: [\n        Mixin.getByName('listing'),\n        Mixin.getByName('placeholder'),\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        order: {\n            type: Object,\n            required: true,\n        },\n        isLoading: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n        attachView: {\n            type: Boolean,\n            required: false,\n            default: false,\n        },\n    },\n\n    data() {\n        return {\n            documentsLoading: false,\n            cardLoading: false,\n            documents: [],\n            documentTypes: null,\n            showModal: false,\n            currentDocumentType: null,\n            documentNumber: null,\n            documentComment: '',\n            term: '',\n            attachment: {},\n            isLoadingDocument: false,\n            isLoadingPreview: false,\n            showSelectDocumentTypeModal: false,\n            showSendDocumentModal: false,\n            sendDocument: null,\n        };\n    },\n\n    computed: {\n        ...mapGetters('swOrderDetail', [\n            'isEditing',\n        ]),\n\n        creditItems() {\n            const items = [];\n\n            this.order.lineItems.forEach((lineItem) => {\n                if (lineItem.type === 'credit') {\n                    items.push(lineItem);\n                }\n            });\n\n            return items;\n        },\n\n        documentTypeRepository() {\n            return this.repositoryFactory.create('document_type');\n        },\n\n        documentRepository() {\n            return this.repositoryFactory.create('document');\n        },\n\n        documentsEmpty() {\n            return this.documents.length === 0;\n        },\n\n        documentModal() {\n            const subComponentName = this.currentDocumentType.technicalName.replace(/_/g, '-');\n\n            if (this.feature.isActive('VUE3')) {\n                if (\n                    `sw-order-document-settings-${subComponentName}-modal` in getCurrentInstance().appContext.components\n                ) {\n                    return `sw-order-document-settings-${subComponentName}-modal`;\n                }\n            } else if (this.$options.components[`sw-order-document-settings-${subComponentName}-modal`]) {\n                return `sw-order-document-settings-${subComponentName}-modal`;\n            }\n\n            return 'sw-order-document-settings-modal';\n        },\n\n        documentCardStyles() {\n            return `sw-order-document-card ${this.documentsEmpty ? 'sw-order-document-card--is-empty' : ''}`;\n        },\n\n        documentTypeCriteria() {\n            const criteria = new Criteria(1, 100);\n            criteria.addSorting(Criteria.sort('name', 'ASC'));\n\n            return criteria;\n        },\n\n        documentCriteria() {\n            const criteria = new Criteria(this.page, this.limit);\n            criteria.addSorting(Criteria.sort('createdAt', 'DESC'));\n            criteria.addAssociation('documentType');\n            criteria.addFilter(Criteria.equals('order.id', this.order.id));\n\n            if (!this.term) {\n                return criteria;\n            }\n\n            criteria.setTerm(this.term);\n            criteria.addQuery(\n                Criteria.contains('config.documentDate', this.term),\n                searchRankingPoint.HIGH_SEARCH_RANKING,\n            );\n            criteria.addQuery(\n                Criteria.equals('config.documentNumber', this.term),\n                searchRankingPoint.HIGH_SEARCH_RANKING,\n            );\n\n            return criteria;\n        },\n\n        getDocumentColumns() {\n            const columns = [{\n                property: 'createdAt',\n                dataIndex: 'createdAt',\n                label: 'sw-order.documentCard.labelDate',\n                allowResize: false,\n                primary: true,\n            }, {\n                property: 'config.documentNumber',\n                dataIndex: 'config.documentNumber',\n                label: 'sw-order.documentCard.labelNumber',\n                allowResize: false,\n            }, {\n                property: 'documentType.name',\n                dataIndex: 'documentType.name',\n                label: 'sw-order.documentCard.labelType',\n                allowResize: false,\n            }, {\n                property: 'sent',\n                dataIndex: 'sent',\n                label: 'sw-order.documentCard.labelSent',\n                allowResize: false,\n                align: 'center',\n            }];\n\n            if (this.attachView) {\n                columns.push({\n                    property: 'attach',\n                    dataIndex: 'attach',\n                    label: 'sw-order.documentCard.labelAttach',\n                    allowResize: false,\n                    align: 'center',\n                });\n            }\n\n            return columns;\n        },\n\n        isDataLoading() {\n            return this.isLoading || this.documentsLoading || this.cardLoading;\n        },\n\n        showCardFilter() {\n            return this.order?.documents?.length > 0;\n        },\n\n        showCreateDocumentButton() {\n            return !this.order?.documents?.length;\n        },\n\n        emptyStateTitle() {\n            return this.order?.documents?.length > 0\n                ? this.$tc('sw-order.documentCard.messageNoDocumentFound')\n                : this.$tc('sw-order.documentCard.messageEmptyTitle');\n        },\n\n        tooltipCreateDocumentButton() {\n            if (!this.acl.can('document.viewer')) {\n                return this.$tc('sw-privileges.tooltip.warning');\n            }\n\n            return this.$tc('sw-order.documentTab.tooltipSaveBeforeCreateDocument');\n        },\n\n        assetFilter() {\n            return Shopware.Filter.getByName('asset');\n        },\n\n        dateFilter() {\n            return Shopware.Filter.getByName('date');\n        },\n    },\n\n    watch: {\n        isDataLoading: {\n            handler(value) {\n                this.$emit('update-loading', value);\n            },\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.cardLoading = true;\n\n            this.documentTypeRepository.search(this.documentTypeCriteria).then((response) => {\n                this.documentTypes = response;\n                this.cardLoading = false;\n            });\n\n            this.documentService.setListener(this.convertStoreEventToVueEvent);\n        },\n\n        convertStoreEventToVueEvent({ action, payload }) {\n            if (action === DocumentEvents.DOCUMENT_FAILED) {\n                let errorMessage = payload.detail;\n                if (payload.code === 'DOCUMENT__NUMBER_ALREADY_EXISTS') {\n                    const translationKey = 'sw-order.documentCard.error.DOCUMENT__NUMBER_ALREADY_EXISTS';\n                    errorMessage = this.$tc(translationKey, 1, payload.meta.parameters || {});\n                }\n\n                this.createNotificationError({\n                    message: errorMessage,\n                });\n            } else if (action === DocumentEvents.DOCUMENT_FINISHED) {\n                this.showModal = false;\n                this.$nextTick().then(() => {\n                    this.getList().then(() => {\n                        this.$emit('document-save');\n                    });\n                });\n            }\n        },\n\n        getList() {\n            this.documentsLoading = true;\n\n            return this.documentRepository.search(this.documentCriteria).then((response) => {\n                this.total = response.total;\n                this.documents = response;\n                this.documentsLoading = false;\n                return Promise.resolve();\n            });\n        },\n\n        documentTypeAvailable(documentType) {\n            return (\n                (\n                    documentType.technicalName !== 'storno' &&\n                    documentType.technicalName !== 'credit_note'\n                ) ||\n                (\n                    (\n                        documentType.technicalName === 'storno' ||\n                        (\n                            documentType.technicalName === 'credit_note' &&\n                            this.creditItems.length !== 0\n                        )\n                    ) && this.invoiceExists()\n                )\n            );\n        },\n\n        invoiceExists() {\n            return this.documents.some((document) => {\n                return (document.documentType.technicalName === 'invoice');\n            });\n        },\n\n        onSearchTermChange(searchTerm) {\n            this.term = searchTerm;\n            this.getList();\n        },\n\n        createDocument(orderId, documentTypeName, params, referencedDocumentId, file) {\n            return this.documentService.createDocument(\n                orderId,\n                documentTypeName,\n                params,\n                referencedDocumentId,\n                {},\n                {},\n                file,\n            );\n        },\n\n        onCancelCreation() {\n            this.showModal = false;\n            this.currentDocumentType = null;\n        },\n\n        onPrepareDocument() {\n            this.showModal = true;\n        },\n\n        openDocument(documentId, documentDeepLink) {\n            this.documentService.getDocument(\n                documentId,\n                documentDeepLink,\n                Shopware.Context.api,\n                true,\n            ).then((response) => {\n                if (response.data) {\n                    const link = document.createElement('a');\n                    link.href = URL.createObjectURL(response.data);\n                    link.target = '_blank';\n                    link.dispatchEvent(new MouseEvent('click'));\n                    link.remove();\n                }\n            });\n        },\n\n        downloadDocument(documentId, documentDeepLink) {\n            this.documentService.getDocument(\n                documentId,\n                documentDeepLink,\n                Shopware.Context.api,\n                true,\n            ).then((response) => {\n                if (response.data) {\n                    const filename = response.headers['content-disposition'].split('filename=')[1];\n                    const link = document.createElement('a');\n                    link.href = URL.createObjectURL(response.data);\n                    link.download = filename;\n                    link.dispatchEvent(new MouseEvent('click'));\n                    link.remove();\n                }\n            });\n        },\n\n        markDocumentAsSent(documentId) {\n            const document = this.documents.get(documentId);\n            document.sent = true;\n\n            this.documentRepository.save(document).then(() => {\n                this.getList();\n            });\n        },\n\n        markDocumentAsUnsent(documentId) {\n            const document = this.documents.get(documentId);\n            document.sent = false;\n\n            this.documentRepository.save(document).then(() => {\n                this.getList();\n            });\n        },\n\n        async onCreateDocument(params, additionalAction, referencedDocumentId = null, file = null) {\n            this.isLoadingDocument = true;\n\n            await this.$nextTick();\n\n            try {\n                const response = await this.createDocument(\n                    this.order.id,\n                    this.currentDocumentType.technicalName,\n                    params,\n                    referencedDocumentId,\n                    file,\n                );\n\n                if (!response) {\n                    return;\n                }\n\n                const documentId = Array.isArray(response)\n                    ? response[0].documentId\n                    : response?.data?.documentId;\n\n                const documentDeepLink = Array.isArray(response)\n                    ? response[0].documentDeepLink\n                    : response?.data?.documentDeepLink;\n\n                if (params.documentMediaFileId) {\n                    const documentData = await this.documentRepository.get(documentId, Shopware.Context.api);\n                    documentData.documentMediaFileId = params.documentMediaFileId;\n                    await this.documentRepository.save(documentData);\n                }\n\n                if (additionalAction === 'download') {\n                    this.downloadDocument(documentId, documentDeepLink);\n                } else if (additionalAction === 'send') {\n                    const criteria = new Criteria(null, null);\n                    criteria.addAssociation('documentType');\n\n                    this.documentRepository.get(documentId, Shopware.Context.api, criteria)\n                        .then((documentData) => {\n                            if (!documentData) {\n                                return;\n                            }\n\n                            this.sendDocument = documentData;\n                            this.showSendDocumentModal = true;\n                        });\n                }\n            } finally {\n                this.isLoadingDocument = false;\n            }\n        },\n\n        onPreview(params) {\n            this.isLoadingPreview = true;\n\n            return this.documentService.getDocumentPreview(\n                this.order.id,\n                this.order.deepLinkCode,\n                this.currentDocumentType.technicalName,\n                params,\n            ).then((response) => {\n                if (response.data) {\n                    const link = document.createElement('a');\n                    link.href = URL.createObjectURL(response.data);\n                    link.target = '_blank';\n                    link.dispatchEvent(new MouseEvent('click'));\n                    link.remove();\n                }\n\n                return response;\n            }).finally(() => {\n                this.isLoadingPreview = false;\n            });\n        },\n\n        onOpenDocument(id, deepLink) {\n            this.openDocument(id, deepLink);\n        },\n\n        onDownload(id, deepLink) {\n            this.downloadDocument(id, deepLink);\n        },\n\n        onSendDocument(id) {\n            this.sendDocument = this.documents.get(id);\n            this.showSendDocumentModal = true;\n        },\n\n        onMarkDocumentAsSent(id) {\n            this.markDocumentAsSent(id);\n        },\n\n        onMarkDocumentAsUnsent(id) {\n            this.markDocumentAsUnsent(id);\n        },\n\n        onCloseSendDocumentModal() {\n            this.sendDocument = null;\n            this.showSendDocumentModal = false;\n        },\n\n        onDocumentSent() {\n            this.markDocumentAsSent(this.sendDocument.id);\n            this.onCloseSendDocumentModal();\n        },\n\n        onLoadingDocument() {\n            this.isLoadingDocument = true;\n        },\n\n        onLoadingPreview() {\n            this.isLoadingPreview = true;\n        },\n\n        onShowSelectDocumentTypeModal() {\n            this.showSelectDocumentTypeModal = true;\n        },\n\n        onCloseSelectDocumentTypeModal(persist) {\n            this.showSelectDocumentTypeModal = false;\n\n            if (persist) {\n                this.onPrepareDocument();\n            }\n        },\n    },\n};\n","export default \"\\n{% block sw_order_document_card %}\\n<sw-card\\n    {% if VUE3 %}\\n    v-show=\\\"!isDataLoading\\\"\\n    {% endif %}\\n    position-identifier=\\\"sw-order-document-card\\\"\\n    :title=\\\"$tc('sw-order.documentCard.cardTitle')\\\"\\n    :class=\\\"documentCardStyles\\\"\\n    :is-loading=\\\"isDataLoading\\\"\\n    {% if VUE3 %}\\n    class=\\\"sw-order-detail-base__document-grid\\\"\\n    {% endif %}\\n>\\n    <template #grid>\\n        \\n        {% block sw_order_document_card_header %}\\n        <sw-card-section\\n            divider=\\\"bottom\\\"\\n            :secondary=\\\"showCardFilter\\\"\\n            slim\\n        >\\n\\n            \\n            {% block sw_order_document_card_header_filter %}\\n            <sw-card-filter\\n                v-if=\\\"showCardFilter\\\"\\n                :placeholder=\\\"$tc('sw-order.documentCard.searchBarPlaceholder')\\\"\\n                @sw-card-filter-term-change=\\\"onSearchTermChange\\\"\\n            >\\n\\n                <template #filter>\\n                    \\n                    {% block sw_order_document_card_header_create_document_context_button %}\\n                    <sw-button\\n                        v-if=\\\"!attachView\\\"\\n                        v-tooltip=\\\"{\\n                            message: tooltipCreateDocumentButton,\\n                            disabled: acl.can('document.viewer') && !isEditing,\\n                            showOnDisabledElements: true\\n                        }\\\"\\n                        size=\\\"small\\\"\\n                        variant=\\\"ghost\\\"\\n                        :disabled=\\\"!acl.can('document.viewer') || isEditing\\\"\\n                        class=\\\"sw-order-document-grid-button\\\"\\n                        @click=\\\"onShowSelectDocumentTypeModal\\\"\\n                    >\\n\\n                        \\n                        {% block sw_order_document_card_header_create_document_button_label %}\\n                        {{ $tc('sw-order.documentCard.labelCreateNew') }}\\n                        {% endblock %}\\n\\n                    </sw-button>\\n                    {% endblock %}\\n\\n                </template>\\n            </sw-card-filter>\\n            {% endblock %}\\n\\n        </sw-card-section>\\n        {% endblock %}\\n\\n        \\n        {% block sw_order_document_card_grid %}\\n        <sw-data-grid\\n            v-if=\\\"!documentsEmpty\\\"\\n            :data-source=\\\"documents\\\"\\n            :columns=\\\"getDocumentColumns\\\"\\n            :full-page=\\\"false\\\"\\n            :show-settings=\\\"false\\\"\\n            :show-selection=\\\"false\\\"\\n            :show-actions=\\\"!attachView\\\"\\n            :is-loading=\\\"isLoading\\\"\\n            :allow-column-edit=\\\"false\\\"\\n            :allow-inline-edit=\\\"false\\\"\\n            identifier=\\\"sw-order-document-grid\\\"\\n        >\\n\\n            \\n            {% block sw_order_document_card_grid_column_date %}\\n            <template #column-createdAt=\\\"{ item }\\\">\\n                \\n                {% block sw_order_document_card_grid_column_date_label %}\\n                {{ dateFilter(item.createdAt, { hour: '2-digit', minute: '2-digit' }) }}\\n                {% endblock %}\\n            </template>\\n            {% endblock %}\\n\\n            \\n            {% block sw_order_document_card_grid_column_sent %}\\n            <template #column-sent=\\\"{ item }\\\">\\n                \\n                {% block sw_order_document_card_grid_column_sent_label %}\\n                <sw-data-grid-column-boolean\\n                    v-model=\\\"item.sent\\\"\\n                    :is-inline-edit=\\\"false\\\"\\n                />\\n                {% endblock %}\\n            </template>\\n            {% endblock %}\\n\\n            \\n            {% block sw_order_document_card_grid_column_attach %}\\n            <template\\n                v-if=\\\"attachView\\\"\\n                #column-attach=\\\"{ item }\\\"\\n            >\\n                \\n                {% block sw_order_document_card_grid_column_attach_label %}\\n                <sw-data-grid-column-boolean\\n                    v-model=\\\"item.attach\\\"\\n                    :is-inline-edit=\\\"true\\\"\\n                />\\n                {% endblock %}\\n            </template>\\n            {% endblock %}\\n\\n            \\n            {% block sw_order_document_card_grid_actions %}\\n            <template\\n                v-if=\\\"!attachView\\\"\\n                #actions=\\\"{ item }\\\"\\n            >\\n                \\n                {% block sw_order_document_card_grid_action_open %}\\n                <sw-context-menu-item\\n                    :disabled=\\\"!acl.can('document.viewer')\\\"\\n                    @click=\\\"onOpenDocument(item.id, item.deepLinkCode)\\\"\\n                >\\n                    \\n                    {% block sw_order_document_card_grid_action_open_label %}\\n                    {{ $tc('sw-order.documentCard.labelOpenDocument') }}\\n                    {% endblock %}\\n                </sw-context-menu-item>\\n                {% endblock %}\\n\\n                \\n                {% block sw_order_document_card_grid_action_download %}\\n                <sw-context-menu-item\\n                    :disabled=\\\"!acl.can('document.viewer')\\\"\\n                    @click=\\\"onDownload(item.id, item.deepLinkCode)\\\"\\n                >\\n                    \\n                    {% block sw_order_document_card_grid_action_download_label %}\\n                    {{ $tc('sw-order.documentCard.labelDownloadPdf') }}\\n                    {% endblock %}\\n                </sw-context-menu-item>\\n                {% endblock %}\\n\\n                \\n                {% block sw_order_document_card_grid_action_send %}\\n                <sw-context-menu-item\\n                    :disabled=\\\"!acl.can('document.viewer')\\\"\\n                    @click=\\\"onSendDocument(item.id)\\\"\\n                >\\n                    \\n                    {% block sw_order_document_card_grid_action_send_label %}\\n                    {{ $tc('sw-order.documentCard.labelSendDocument') }}\\n                    {% endblock %}\\n                </sw-context-menu-item>\\n                {% endblock %}\\n\\n                \\n                {% block sw_order_document_card_grid_action_mark_sent %}\\n                <sw-context-menu-item\\n                    :disabled=\\\"!acl.can('document.viewer') || item.sent\\\"\\n                    @click=\\\"onMarkDocumentAsSent(item.id)\\\"\\n                >\\n                    \\n                    {% block sw_order_document_card_grid_action_mark_sent_label %}\\n                    {{ $tc('sw-order.documentCard.labelMarkAsSent') }}\\n                    {% endblock %}\\n                </sw-context-menu-item>\\n                {% endblock %}\\n\\n                \\n                {% block sw_order_document_card_grid_action_mark_unsent %}\\n                <sw-context-menu-item\\n                    :disabled=\\\"!acl.can('document.viewer') || !item.sent\\\"\\n                    @click=\\\"onMarkDocumentAsUnsent(item.id)\\\"\\n                >\\n                    \\n                    {% block sw_order_document_card_grid_action_mark_unsent_label %}\\n                    {{ $tc('sw-order.documentCard.labelMarkAsUnsent') }}\\n                    {% endblock %}\\n                </sw-context-menu-item>\\n                {% endblock %}\\n            </template>\\n            {% endblock %}\\n\\n        </sw-data-grid>\\n        {% endblock %}\\n\\n    </template>\\n\\n    \\n    {% block sw_order_document_card_grid_column_modal %}\\n    {% if VUE3 %}\\n    <div v-if=\\\"showModal\\\">\\n    {% endif %}\\n        <component\\n            :is=\\\"documentModal\\\"\\n            {% if VUE2 %}\\n            v-if=\\\"showModal\\\"\\n            {% endif %}\\n            :current-document-type=\\\"currentDocumentType\\\"\\n            :order=\\\"order\\\"\\n            :is-loading-document=\\\"isLoadingDocument\\\"\\n            :is-loading-preview=\\\"isLoadingPreview\\\"\\n            @loading-document=\\\"onLoadingDocument\\\"\\n            @loading-preview=\\\"onLoadingPreview\\\"\\n            @page-leave=\\\"onCancelCreation\\\"\\n            @document-create=\\\"onCreateDocument\\\"\\n            @preview-show=\\\"onPreview\\\"\\n        />\\n    {% if VUE3 %}\\n    </div>\\n    {% endif %}\\n    {% endblock %}\\n\\n    \\n    {% block sw_order_document_card_grid_column_document_type_modal %}\\n    <sw-order-select-document-type-modal\\n        v-if=\\\"showSelectDocumentTypeModal\\\"\\n        {% if VUE3 %}\\n        v-model:value=\\\"currentDocumentType\\\"\\n        {% else %}\\n        v-model=\\\"currentDocumentType\\\"\\n        {% endif %}\\n        :order=\\\"order\\\"\\n        @modal-close=\\\"onCloseSelectDocumentTypeModal\\\"\\n    />\\n    {% endblock %}\\n\\n    \\n    {% block sw_order_document_card_grid_column_document_send_modal %}\\n    <sw-order-send-document-modal\\n        v-if=\\\"showSendDocumentModal\\\"\\n        :document=\\\"sendDocument\\\"\\n        :order=\\\"order\\\"\\n        @modal-close=\\\"onCloseSendDocumentModal\\\"\\n        @document-sent=\\\"onDocumentSent\\\"\\n    />\\n    {% endblock %}\\n\\n    \\n    {% block sw_order_document_card_empty_state %}\\n    <sw-empty-state\\n        v-if=\\\"documentsEmpty\\\"\\n        :title=\\\"emptyStateTitle\\\"\\n        :show-description=\\\"false\\\"\\n    >/\\n        <template #icon>\\n            <img\\n                :src=\\\"assetFilter('/administration/static/img/empty-states/order-empty-state.svg')\\\"\\n                :alt=\\\"$tc('sw-order.list.messageEmpty')\\\"\\n            >\\n        </template>\\n\\n        <template #actions>\\n            <sw-button\\n                v-if=\\\"showCreateDocumentButton\\\"\\n                v-tooltip=\\\"{\\n                    message: tooltipCreateDocumentButton,\\n                    disabled: acl.can('document.viewer') && !isEditing,\\n                    showOnDisabledElements: true\\n                }\\\"\\n                size=\\\"small\\\"\\n                variant=\\\"ghost\\\"\\n                :disabled=\\\"!acl.can('document.viewer') || isEditing\\\"\\n                class=\\\"sw-order-document-grid-button\\\"\\n                @click=\\\"onShowSelectDocumentTypeModal\\\"\\n            >\\n\\n                \\n                {% block sw_order_document_card_header_create_document_button_label %}\\n                {{ $tc('sw-order.documentCard.labelCreateNew') }}\\n                {% endblock %}\\n\\n            </sw-button>\\n        </template>\\n    </sw-empty-state>\\n    {% endblock %}\\n</sw-card>\\n{% endblock %}\\n\";","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-order-document-card.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"044c9c27\", content, true, {});"],"sourceRoot":""}