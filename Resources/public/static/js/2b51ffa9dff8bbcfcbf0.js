(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[306],{"0laC":function(e,n,t){},M0WV:function(e,n,t){"use strict";t.r(n);var i=t("7yzw"),a=t.n(i),o=t("92Mt"),d=t.n(o),l=(t("oeLk"),Shopware),s=l.Context,r=l.Utils;n.default={template:'\n{% block sw_media_modal_v2 %}\n<sw-modal\n    ref="swMediaModal"\n    class="sw-media-modal-v2"\n    variant="full"\n    :title="$tc(\'sw-media.sw-media-modal-v2.titleModal\')"\n    @modal-close="onEmitModalClosed"\n>\n\n    \n    {% block sw_media_modal_v2_content %}\n    <div class="sw-media-modal-v2__content">\n\n        \n        {% block sw_media_modal_v2_tabs %}\n        <sw-tabs\n            position-identifier="sw-media-modal"\n            variant="minimal"\n            :default-item="defaultTab"\n            class="sw-media-modal-v2__tabs"\n        >\n            <template #default="{ active }">\n\n                \n                {% block sw_media_modal_v2_tab_items %}\n                \n                {% block sw_media_modal_v2_tab_item_library %}\n                <sw-tabs-item\n                    :name="tabNameLibrary"\n                    :active-tab="active"\n                    :disabled="hasUploads"\n                >\n                    {{ $tc(\'sw-media.sw-media-modal-v2.labelTabItemLibrary\') }}\n                </sw-tabs-item>\n                {% endblock %}\n\n                \n                {% block sw_media_modal_v2_tab_item_upload %}\n                <sw-tabs-item\n                    :name="tabNameUpload"\n                    :active-tab="active"\n                    @click="resetSelection"\n                >\n                    {{ $tc(\'sw-media.sw-media-modal-v2.labelTabItemUpload\') }}\n                </sw-tabs-item>\n                {% endblock %}\n                {% endblock %}\n            </template>\n\n            <template #content="{ active }">\n\n                \n                {% block sw_media_modal_v2_tab_content %}\n                <div class="sw-media-modal-v2__tab-content">\n\n                    \n                    {% block sw_media_modal_v2_tab_content_library %}\n                    <template v-if="active === tabNameLibrary">\n\n                        \n                        {% block sw_media_modal_v2_navigation_and_search %}\n                        <div\n                            class="sw-media-modal-v2__breadcrumbs-and-search"\n                            :class="{\'sw-media-modal-v2__breadcrumbs-and-search--compact\': compact}"\n                        >\n\n                            \n                            {% block sw_media_modal_v2_folder_breadcrumbs %}\n                            <sw-media-breadcrumbs\n                                {% if VUE3 %}\n                                v-model:currentFolderId="folderId"\n                                {% else %}\n                                v-model="folderId"\n                                {% endif %}\n                                :small="compact"\n                            />\n                            {% endblock %}\n\n                            \n                            {% block sw_media_modal_v2_search_field %}\n                            <sw-simple-search-field v-model="term" />\n                            {% endblock %}\n                        </div>\n                        {% endblock %}\n\n                        \n                        {% block sw_media_modal_v2_media_library %}\n                        <sw-media-library\n                            ref="mediaLibrary"\n                            :selection="selection"\n                            :folder-id="folderId"\n                            :term="term"\n                            :compact="compact"\n                            :allow-multi-select="allowMultiSelect"\n                            {% if VUE3 %}\n                            @update:selection="selection = $event"\n                            {% else %}\n                            @media-selection-change="selection = $event"\n                            {% endif %}\n                            @media-folder-change="folderId = $event"\n                        />\n                        {% endblock %}\n                    </template>\n                    {% endblock %}\n\n                    \n                    {% block sw_media_modal_v2_tab_content_upload %}\n                    <div\n                        v-if="active === tabNameUpload"\n                        class="sw-media-modal-v2__uploads-content"\n                    >\n\n                        \n                        {% block sw_media_modal_v2_upload_component %}\n                        <sw-upload-listener\n                            :upload-tag="uploadTag"\n                            @media-upload-add="onUploadsAdded"\n                            @media-upload-finish="onUploadFinished"\n                            @media-upload-fail="onUploadFailed"\n                        />\n\n                        <sw-media-upload-v2\n                            class="sw-media-modal-v2__upload-container"\n                            variant="regular"\n                            :file-accept="fileAccept"\n                            :upload-tag="uploadTag"\n                            :default-folder="entityContext"\n                            :target-folder="folderId"\n                            :allow-multi-select="allowMultiSelect"\n                        />\n                        {% endblock %}\n\n                        \n                        {% block sw_media_modal_v2_uploaded_items %}\n                        <sw-media-grid\n                            :presentation="compact ? \'list-preview\' : \'medium-preview\'"\n                            :class="{\'sw-media-modal-v2__upload-media-grid--compact\': compact }"\n                        >\n                            <sw-media-media-item\n                                v-for="upload in uploads"\n                                :key="`sw-media-modal-v2-upload-${upload.id}`"\n                                :item="upload"\n                                :show-context-menu-button="false"\n                                :show-selection-indicator="allowMultiSelect"\n                                :allow-multi-select="allowMultiSelect"\n                                :selected="checkMediaItem(upload)"\n                                :editable="false"\n                                :is-list="compact"\n                                @media-item-selection-remove="onMediaRemoveSelected"\n                                @media-item-selection-add="onMediaAddSelected"\n                                @media-item-click="onMediaItemSelect"\n                            />\n                        </sw-media-grid>\n                        {% endblock %}\n                    </div>\n                    {% endblock %}\n                </div>\n            </template>\n            {% endblock %}\n        </sw-tabs>\n        {% endblock %}\n\n        \n        {% block sw_media_modal_v2_media_sidebar %}\n        <sw-media-sidebar\n            :items="selection"\n            :current-folder-id="null"\n            @media-sidebar-items-delete="onItemsDeleted"\n            @media-sidebar-folder-items-dissolve="onMediaFoldersDissolved"\n            @media-sidebar-items-move="refreshList"\n            @media-item-selection-remove="onMediaRemoveSelected"\n        />\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    \n    {% block sw_media_modal_v2_modal_footer %}\n    <template #modal-footer>\n        \n        {% block sw_media_modal_v2_button_cancel %}\n        <sw-button @click="onEmitModalClosed">\n            {{ $tc(\'sw-media.sw-media-modal-v2.labelButtonCancel\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_media_modal_v2_button_confirm_selection %}\n        <sw-button\n            variant="primary"\n            @click="onEmitSelection"\n        >\n            {{ $tc(\'sw-media.sw-media-modal-v2.labelButtonSaveSelection\') }}\n        </sw-button>\n        {% endblock %}\n    </template>\n    {% endblock %}\n</sw-modal>\n{% endblock %}\n',inject:["repositoryFactory","mediaService"],props:{initialFolderId:{type:String,required:!1,default:null},entityContext:{type:String,required:!1,default:null},defaultTab:{type:String,required:!1,validValues:["upload","library"],default:"library",validator:function(e){return["upload","library"].includes(e)}},allowMultiSelect:{type:Boolean,required:!1,default:!0},fileAccept:{type:String,required:!1,default:"image/*"}},data:function(){return{selection:[],uploads:[],folderId:this.initialFolderId,currentFolder:null,compact:!1,term:"",id:r.createId(),selectedMediaItem:{}}},computed:{mediaRepository:function(){return this.repositoryFactory.create("media")},mediaFolderRepository:function(){return this.repositoryFactory.create("media_folder")},tabNameUpload:function(){return"upload"},tabNameLibrary:function(){return"library"},hasUploads:function(){return this.uploads.length>0},uploadTag:function(){return"sw-media-modal-v2--".concat(this.id)}},watch:{folderId:function(){this.fetchCurrentFolder()}},created:function(){this.createdComponent()},mounted:function(){this.mountedComponent()},beforeDestroy:function(){this.beforeDestroyComponent()},methods:{createdComponent:function(){this.fetchCurrentFolder(),this.addResizeListener()},mountedComponent:function(){this.getComponentWidth()},beforeDestroyComponent:function(){this.removeOnResizeListener()},fetchCurrentFolder:function(){var e=this;return a()(d.a.mark((function n(){return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.folderId){n.next=3;break}return e.currentFolder=null,n.abrupt("return");case 3:return n.next=5,e.mediaFolderRepository.get(e.folderId,s.api);case 5:e.currentFolder=n.sent;case 6:case"end":return n.stop()}}),n)})))()},addResizeListener:function(){window.addEventListener("resize",this.getComponentWidth)},removeOnResizeListener:function(){window.removeEventListener("resize",this.getComponentWidth)},getComponentWidth:function(){var e=this.$el.getBoundingClientRect().width;this.compact=e<=900},onEmitModalClosed:function(){this.$emit("modal-close")},onEmitSelection:function(){var e=this.selection.filter((function(e){return"media"===e.getEntityName()}));this.$emit("media-modal-selection-change",e),this.onEmitModalClosed()},refreshList:function(){this.$refs.mediaLibrary.refreshList()},onMediaRemoveSelected:function(e){var n=e.item,t=this.selection.findIndex((function(e){return n.id===e.id}));-1!==t&&this.selection.splice(t,1)},onMediaAddSelected:function(e){var n=e.item;this.selection.includes(n)||this.selection.push(n)},onMediaItemSelect:function(e){var n=e.item;this.allowMultiSelect||(this.selection=[n],this.selectedMediaItem=n)},resetSelection:function(){this.selection.splice(0,this.selection.length)},onItemsDeleted:function(e){this.onMediaFoldersDissolved(e.folderIds)},onMediaFoldersDissolved:function(e){var n=this;this.currentFolder&&(e.some((function(e){return e===n.currentFolder.id}))&&(this.folderId=this.currentFolder.parentId),this.refreshList())},onUploadsAdded:function(e){var n=this;return a()(d.a.mark((function t(){var i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.data,t.next=3,n.mediaService.runUploads(n.uploadTag);case 3:return t.next=5,Promise.all(i.map((function(e){var t=e.targetId;return new Promise((function(e){n.mediaRepository.get(t,s.api).then((function(t){n.uploads.push(t),e()}))}))})));case 5:case"end":return t.stop()}}),t)})))()},onUploadFinished:function(e){var n=this;return a()(d.a.mark((function t(){var i,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.targetId,t.next=3,n.mediaRepository.get(i,s.api);case 3:a=t.sent,n.selectedMediaItem=a,n.uploads.some((function(e){return a.id===e.id}))||n.uploads.push(a),n.allowMultiSelect?n.selection.some((function(e){return a.id===e.id}))||n.selection.push(a):n.selection=[a];case 7:case"end":return t.stop()}}),t)})))()},onUploadFailed:function(e){this.uploads=this.uploads.filter((function(n){return n.id!==e.targetId}))},selectMediaItem:function(e){this.allowMultiSelect||(this.selectedMediaItem=e,this.selection=[e])},checkMediaItem:function(e){return this.allowMultiSelect?this.selection.includes(e):e.id===this.selectedMediaItem.id}}}},oeLk:function(e,n,t){var i=t("0laC");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t("P8hj").default)("ec3352ca",i,!0,{})}}]);
//# sourceMappingURL=2b51ffa9dff8bbcfcbf0.js.map