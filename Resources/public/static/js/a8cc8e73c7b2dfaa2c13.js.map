{"version":3,"sources":["webpack:///./src/module/sw-promotion-v2/helper/promotion.helper.js","webpack:///./src/module/sw-order/component/sw-order-create-promotion-modal/index.js","webpack:///./src/module/sw-order/component/sw-order-create-promotion-modal/sw-order-create-promotion-modal.html.twig","webpack:///./src/module/sw-order/component/sw-order-create-promotion-modal/sw-order-create-promotion-modal.scss"],"names":["DiscountTypes","PERCENTAGE","ABSOLUTE","FIXED","FIXED_UNIT","DiscountScopes","CART","DELIVERY","SET","SETGROUP","PromotionPermissions","isEditingAllowed","promotion","undefined","hasOwnProperty","Error","hasOrders","_Shopware","Shopware","State","Utils","Service","format","template","props","currency","type","Object","required","salesChannelId","String","default","data","isLoading","computed","cart","get","cartAutomaticPromotionItems","this","lineItems","filter","item","payload","code","hasNoAutomaticPromotions","length","methods","onCancel","$emit","onSave","disableAutomaticPromotions","_this","additionalParams","token","then","getDescription","totalPrice","price","_item$payload","value","discountScope","discountType","groupId","snippet","concat","Math","abs","$tc","Number","shortName","discountValue","content","__esModule","module","i","locals","exports","add"],"mappings":"oHAAA,sHAQaA,EAAgB,CACzBC,WAAY,aACZC,SAAU,WACVC,MAAO,QACPC,WAAY,cAMHC,EAAiB,CAC1BC,KAAM,OACNC,SAAU,WACVC,IAAK,MACLC,SAAU,YAMDC,EAAuB,CAChCC,iBAUJ,SAA0BC,GACtB,GAAkB,OAAdA,EACA,OAAO,EAGX,QAAkBC,IAAdD,EACA,OAAO,EAGX,IAAKE,YAAeF,EAAW,aAC3B,MAAM,IAAIG,MAAM,gFAGpB,OAAQH,EAAUI,a,yDC5CtBC,G,UAAkCC,UAA1BC,EAAKF,EAALE,MAAOC,EAAKH,EAALG,MAAOC,EAAOJ,EAAPI,QACdC,EAAWF,EAAXE,OAGO,WACXC,SCbW,m5DDeXC,MAAO,CACHC,SAAU,CACNC,KAAMC,OACNC,UAAU,GAEdC,eAAgB,CACZH,KAAMI,OACNF,UAAU,EACVG,QAAS,OAIjBC,KAAI,WACA,MAAO,CACHC,WAAW,IAInBC,SAAU,CACNC,KAAI,WACA,OAAOhB,EAAMiB,IAAI,WAAWD,MAGhCE,4BAA2B,WACvB,OAAOC,KAAKH,KAAKI,UAAUC,QAAO,SAACC,GAC/B,MAAqB,cAAdA,EAAKf,MAA8C,KAAtBe,EAAKC,QAAQC,SAIzDC,yBAAwB,WACpB,OAAmD,IAA5CN,KAAKD,4BAA4BQ,SAIhDC,QAAS,CACLC,SAAQ,WACJT,KAAKU,MAAM,UAGfC,OAAM,WACFX,KAAKY,8BAGTA,2BAA0B,WAAI,IAADC,EAAA,KACzBb,KAAKL,WAAY,EACjB,IAAMmB,EAAmB,CAAEvB,eAAgBS,KAAKT,gBAEhDR,EAAQ,oBAAoB6B,2BAA2BZ,KAAKH,KAAKkB,MAAOD,GAAkBE,MAAK,WAC3FH,EAAKlB,WAAY,EACjBkB,EAAKH,MAAM,YAInBO,eAAc,SAACd,GACX,IAAQe,EAAef,EAAKgB,MAApBD,WACRE,EAAwDjB,EAAKC,QAArDiB,EAAKD,EAALC,MAAOC,EAAaF,EAAbE,cAAeC,EAAYH,EAAZG,aAAcC,EAAOJ,EAAPI,QACtCC,EAAO,gDAAAC,OAAmDJ,GAEhE,GAAIA,IAAkBvD,IAAeC,MACjCuD,IAAiB7D,IAAcE,UAC/B+D,KAAKC,IAAIV,GAAcG,EACvB,OAAOrB,KAAK6B,IAAI,GAADH,OAAID,EAAO,iBAAiB,EAAG,CAC1CJ,MAAOrC,EAAOG,SAAS2C,OAAOT,GAAQrB,KAAKb,SAAS4C,WACpDb,WAAYlC,EAAOG,SAASwC,KAAKC,IAAIV,GAAalB,KAAKb,SAAS4C,aAIxE,IAAMC,EAAgBT,IAAiB7D,IAAcC,WAC/C0D,EACArC,EAAOG,SAAS2C,OAAOT,GAAQrB,KAAKb,SAAS4C,WAEnD,OAAO/B,KAAK6B,IAAI,GAADH,OAAID,EAAO,KAAAC,OAAIH,GAAgB,EAAG,CAAEF,MAAOW,EAAeR,gB,qBEnFrF,IAAIS,EAAU,EAAQ,QACnBA,EAAQC,aAAYD,EAAUA,EAAQxC,SACnB,iBAAZwC,IAAsBA,EAAU,CAAC,CAACE,EAAOC,EAAIH,EAAS,MAC7DA,EAAQI,SAAQF,EAAOG,QAAUL,EAAQI,SAG/BE,EADH,EAAQ,QAAwE9C,SACzE,WAAYwC,GAAS,EAAM,K","file":"static/js/a8cc8e73c7b2dfaa2c13.js","sourcesContent":["/**\n * @package buyers-experience\n */\nimport { hasOwnProperty } from 'src/core/service/utils/object.utils';\n\n/**\n * @private\n */\nexport const DiscountTypes = {\n    PERCENTAGE: 'percentage',\n    ABSOLUTE: 'absolute',\n    FIXED: 'fixed',\n    FIXED_UNIT: 'fixed_unit',\n};\n\n/**\n * @private\n */\nexport const DiscountScopes = {\n    CART: 'cart',\n    DELIVERY: 'delivery',\n    SET: 'set',\n    SETGROUP: 'setgroup',\n};\n\n/**\n * @private\n */\nexport const PromotionPermissions = {\n    isEditingAllowed,\n};\n\n/**\n * Gets if the editing of the promotion is allowed,\n * or if it's forbidden to change anything because\n * it has already been used.\n *\n * @param {Object} promotion\n */\nfunction isEditingAllowed(promotion) {\n    if (promotion === null) {\n        return false;\n    }\n\n    if (promotion === undefined) {\n        return false;\n    }\n\n    if (!hasOwnProperty(promotion, 'hasOrders')) {\n        throw new Error('Promotion Property hasOrders does not exist. Please use the Hydrator before!');\n    }\n\n    return !promotion.hasOrders;\n}\n","import { DiscountTypes, DiscountScopes } from 'src/module/sw-promotion-v2/helper/promotion.helper';\nimport template from './sw-order-create-promotion-modal.html.twig';\nimport './sw-order-create-promotion-modal.scss';\n\n/**\n * @package checkout\n */\n\nconst { State, Utils, Service } = Shopware;\nconst { format } = Utils;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    props: {\n        currency: {\n            type: Object,\n            required: true,\n        },\n        salesChannelId: {\n            type: String,\n            required: false,\n            default: null,\n        },\n    },\n\n    data() {\n        return {\n            isLoading: false,\n        };\n    },\n\n    computed: {\n        cart() {\n            return State.get('swOrder').cart;\n        },\n\n        cartAutomaticPromotionItems() {\n            return this.cart.lineItems.filter((item) => {\n                return item.type === 'promotion' && item.payload.code === '';\n            });\n        },\n\n        hasNoAutomaticPromotions() {\n            return this.cartAutomaticPromotionItems.length === 0;\n        },\n    },\n\n    methods: {\n        onCancel() {\n            this.$emit('close');\n        },\n\n        onSave() {\n            this.disableAutomaticPromotions();\n        },\n\n        disableAutomaticPromotions() {\n            this.isLoading = true;\n            const additionalParams = { salesChannelId: this.salesChannelId };\n\n            Service('cartStoreService').disableAutomaticPromotions(this.cart.token, additionalParams).then(() => {\n                this.isLoading = false;\n                this.$emit('save');\n            });\n        },\n\n        getDescription(item) {\n            const { totalPrice } = item.price;\n            const { value, discountScope, discountType, groupId } = item.payload;\n            const snippet = `sw-order.createBase.textPromotionDescription.${discountScope}`;\n\n            if (discountScope === DiscountScopes.CART &&\n                discountType === DiscountTypes.ABSOLUTE &&\n                Math.abs(totalPrice) < value) {\n                return this.$tc(`${snippet}.absoluteUpto`, 0, {\n                    value: format.currency(Number(value), this.currency.shortName),\n                    totalPrice: format.currency(Math.abs(totalPrice), this.currency.shortName),\n                });\n            }\n\n            const discountValue = discountType === DiscountTypes.PERCENTAGE\n                ? value\n                : format.currency(Number(value), this.currency.shortName);\n\n            return this.$tc(`${snippet}.${discountType}`, 0, { value: discountValue, groupId });\n        },\n    },\n};\n","export default \"\\n{% block sw_order_create_promotion_modal %}\\n<sw-modal\\n    :title=\\\"$tc('sw-order.promotionModal.labelTitle')\\\"\\n    class=\\\"sw-order-create-promotion-modal\\\"\\n    @modal-close=\\\"onCancel\\\"\\n>\\n    \\n    {% block sw_order_create_promotion_modal_body %}\\n    \\n    {% block sw_order_create_promotion_modal_message %}\\n    <p>{{ hasNoAutomaticPromotions ? $tc('sw-order.promotionModal.messageNoItems') : $tc('sw-order.promotionModal.message') }}</p>\\n    {% endblock %}\\n\\n    \\n    {% block sw_order_create_promotion_modal_promotions %}\\n    <div\\n        v-for=\\\"(item, index) in cartAutomaticPromotionItems\\\"\\n        :key=\\\"index\\\"\\n        class=\\\"sw-order-create-promotion-modal__promotion\\\"\\n    >\\n        \\n        {% block sw_order_create_promotion_modal_promotion_name %}\\n        <strong class=\\\"sw-order-create-promotion-modal__promotion-name\\\">{{ item.label }}</strong>\\n        {% endblock %}\\n\\n        \\n        {% block sw_order_create_promotion_modal_promotion_description %}\\n        <p>{{ getDescription(item) }}</p>\\n        {% endblock %}\\n    </div>\\n    {% endblock %}\\n    {% endblock %}\\n\\n    \\n    {% block sw_order_create_promotion_modal_footer %}\\n    <template #modal-footer>\\n        \\n        {% block sw_order_create_promotion_modal_footer_button_cancel %}\\n        <sw-button\\n            size=\\\"small\\\"\\n            @click=\\\"onCancel\\\"\\n        >\\n            {{ $tc('global.default.cancel') }}\\n        </sw-button>\\n        {% endblock %}\\n\\n        \\n        {% block sw_order_create_promotion_modal_footer_button_save %}\\n        <sw-button\\n            size=\\\"small\\\"\\n            variant=\\\"primary\\\"\\n            :is-loading=\\\"isLoading\\\"\\n            :disabled=\\\"hasNoAutomaticPromotions\\\"\\n            @click=\\\"onSave\\\"\\n        >\\n            {{ $tc('sw-order.promotionModal.buttonDisable') }}\\n        </sw-button>\\n        {% endblock %}\\n    </template>\\n    {% endblock %}\\n</sw-modal>\\n{% endblock %}\\n\";","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-order-create-promotion-modal.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6aaa0176\", content, true, {});"],"sourceRoot":""}