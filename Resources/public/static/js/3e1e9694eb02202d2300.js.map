{"version":3,"sources":["webpack:///./src/module/sw-order/component/sw-order-document-settings-storno-modal/index.js","webpack:///./src/module/sw-order/component/sw-order-document-settings-storno-modal/sw-order-document-settings-storno-modal.html.twig"],"names":["template","inject","props","order","type","Object","required","currentDocumentType","data","documentConfig","custom","stornoNumber","invoiceNumber","documentNumber","documentComment","documentDate","computed","documentPreconditionsFulfilled","this","invoices","documents","filter","document","documentType","technicalName","created","createdComponent","methods","_this","numberRangeService","reserve","concat","salesChannelId","then","response","number","documentNumberPreview","Date","toISOString","onCreateDocument","_this2","additionalAction","arguments","length","undefined","$emit","selectedInvoice","item","config","createNotificationInfo","message","$tc","callDocumentCreate","id","onPreview","$super"],"mappings":"4HAOe,WACXA,SCRW,6uDDUXC,OAAQ,CAAC,WAETC,MAAO,CACHC,MAAO,CACHC,KAAMC,OACNC,UAAU,GAEdC,oBAAqB,CACjBH,KAAMC,OACNC,UAAU,IAIlBE,KAAI,WACA,MAAO,CACHC,eAAgB,CACZC,OAAQ,CACJC,aAAc,GACdC,cAAe,IAEnBC,eAAgB,EAChBC,gBAAiB,GACjBC,aAAc,MAK1BC,SAAU,CACNC,+BAA8B,WAC1B,QAASC,KAAKT,eAAeC,OAAOE,eAGxCO,SAAQ,WACJ,OAAOD,KAAKf,MAAMiB,UAAUC,QAAO,SAACC,GAChC,MAA+C,YAAxCA,EAASC,aAAaC,mBAKzCC,QAAO,WACHP,KAAKQ,oBAGTC,QAAS,CACLD,iBAAgB,WAAI,IAADE,EAAA,KACfV,KAAKW,mBAAmBC,QAAQ,YAADC,OACfb,KAAKX,oBAAoBiB,eACrCN,KAAKf,MAAM6B,gBACX,GACFC,MAAK,SAACC,GACJN,EAAKnB,eAAeI,eAAiBqB,EAASC,OAC9CP,EAAKQ,sBAAwBR,EAAKnB,eAAeI,eACjDe,EAAKnB,eAAeM,cAAgB,IAAIsB,MAAQC,kBAIxDC,iBAAgB,WAA4B,IAADC,EAAA,KAA1BC,EAAgBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAC7BxB,KAAK2B,MAAM,oBAEX,IAAMC,EAAkB5B,KAAKC,SAASE,QAAO,SAAC0B,GAC1C,OAAOA,EAAKC,OAAOtC,OAAOE,gBAAkB4B,EAAK/B,eAAeC,OAAOE,iBACxE,GAECM,KAAKkB,wBAA0BlB,KAAKT,eAAeI,eACnDK,KAAKW,mBAAmBC,QAAQ,YAADC,OACfb,KAAKX,oBAAoBiB,eACrCN,KAAKf,MAAM6B,gBACX,GACFC,MAAK,SAACC,GACJM,EAAK/B,eAAeC,OAAOC,aAAeuB,EAASC,OAC/CD,EAASC,SAAWK,EAAK/B,eAAeI,gBACxC2B,EAAKS,uBAAuB,CACxBC,QAASV,EAAKW,IAAI,6DAG1BX,EAAK/B,eAAeI,eAAiBqB,EAASC,OAC9CK,EAAKY,mBAAmBX,EAAkBK,EAAgBO,QAG9DnC,KAAKT,eAAeC,OAAOC,aAAeO,KAAKT,eAAeI,eAC9DK,KAAKkC,mBAAmBX,EAAkBK,EAAgBO,MAIlEC,UAAS,WACLpC,KAAK2B,MAAM,mBACX3B,KAAKT,eAAeC,OAAOC,aAAeO,KAAKT,eAAeI,eAC9DK,KAAKqC,OAAO","file":"static/js/3e1e9694eb02202d2300.js","sourcesContent":["import template from './sw-order-document-settings-storno-modal.html.twig';\n\n/**\n * @package checkout\n */\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: ['feature'],\n\n    props: {\n        order: {\n            type: Object,\n            required: true,\n        },\n        currentDocumentType: {\n            type: Object,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            documentConfig: {\n                custom: {\n                    stornoNumber: '',\n                    invoiceNumber: '',\n                },\n                documentNumber: 0,\n                documentComment: '',\n                documentDate: '',\n            },\n        };\n    },\n\n    computed: {\n        documentPreconditionsFulfilled() {\n            return !!this.documentConfig.custom.invoiceNumber;\n        },\n\n        invoices() {\n            return this.order.documents.filter((document) => {\n                return document.documentType.technicalName === 'invoice';\n            });\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.numberRangeService.reserve(\n                `document_${this.currentDocumentType.technicalName}`,\n                this.order.salesChannelId,\n                true,\n            ).then((response) => {\n                this.documentConfig.documentNumber = response.number;\n                this.documentNumberPreview = this.documentConfig.documentNumber;\n                this.documentConfig.documentDate = (new Date()).toISOString();\n            });\n        },\n\n        onCreateDocument(additionalAction = false) {\n            this.$emit('loading-document');\n\n            const selectedInvoice = this.invoices.filter((item) => {\n                return item.config.custom.invoiceNumber === this.documentConfig.custom.invoiceNumber;\n            })[0];\n\n            if (this.documentNumberPreview === this.documentConfig.documentNumber) {\n                this.numberRangeService.reserve(\n                    `document_${this.currentDocumentType.technicalName}`,\n                    this.order.salesChannelId,\n                    false,\n                ).then((response) => {\n                    this.documentConfig.custom.stornoNumber = response.number;\n                    if (response.number !== this.documentConfig.documentNumber) {\n                        this.createNotificationInfo({\n                            message: this.$tc('sw-order.documentCard.info.DOCUMENT__NUMBER_WAS_CHANGED'),\n                        });\n                    }\n                    this.documentConfig.documentNumber = response.number;\n                    this.callDocumentCreate(additionalAction, selectedInvoice.id);\n                });\n            } else {\n                this.documentConfig.custom.stornoNumber = this.documentConfig.documentNumber;\n                this.callDocumentCreate(additionalAction, selectedInvoice.id);\n            }\n        },\n\n        onPreview() {\n            this.$emit('loading-preview');\n            this.documentConfig.custom.stornoNumber = this.documentConfig.documentNumber;\n            this.$super('onPreview');\n        },\n    },\n};\n","export default \"\\n{% block sw_order_document_settings_modal_form_first_row %}\\n<sw-container\\n    columns=\\\"1fr 1fr 1fr\\\"\\n    gap=\\\"0 14px\\\"\\n>\\n    \\n    {% block sw_order_document_settings_modal_form_cancellation_document_number %}\\n    <sw-text-field\\n        {% if VUE3 %}\\n        v-model:value=\\\"documentConfig.documentNumber\\\"\\n        {% else %}\\n        v-model=\\\"documentConfig.documentNumber\\\"\\n        {% endif %}\\n        :label=\\\"$tc('sw-order.documentModal.labelDocumentStornoNumber')\\\"\\n    />\\n    {% endblock %}\\n\\n    \\n    {% block sw_order_document_settings_modal_form_document_select_invoice %}\\n    <sw-select-field\\n        {% if VUE3 %}\\n        v-model:value=\\\"documentConfig.custom.invoiceNumber\\\"\\n        {% else %}\\n        v-model=\\\"documentConfig.custom.invoiceNumber\\\"\\n        {% endif %}\\n        class=\\\"sw-order-document-settings-storno-modal__invoice-select\\\"\\n        :label=\\\"$tc('sw-order.documentModal.labelInvoiceNumber')\\\"\\n        :placeholder=\\\"$tc('sw-order.documentModal.selectInvoiceNumber')\\\"\\n    >\\n        <option\\n            v-for=\\\"invoice in invoices\\\"\\n            :key=\\\"invoice.config.custom.invoiceNumber\\\"\\n            :value=\\\"invoice.config.custom.invoiceNumber\\\"\\n        >\\n            {{ invoice.config.custom.invoiceNumber }}\\n        </option>\\n    </sw-select-field>\\n    {% endblock %}\\n\\n    \\n    {% block sw_order_document_settings_modal_form_cancellation_document_date %}\\n    <sw-datepicker\\n        {% if VUE3 %}\\n        v-model:value=\\\"documentConfig.documentDate\\\"\\n        {% else %}\\n        v-model=\\\"documentConfig.documentDate\\\"\\n        {% endif %}\\n        date-type=\\\"date\\\"\\n        required\\n        :label=\\\"$tc('sw-order.documentModal.labelDocumentDate')\\\"\\n    />\\n    {% endblock %}\\n</sw-container>\\n{% endblock %}\\n\";"],"sourceRoot":""}