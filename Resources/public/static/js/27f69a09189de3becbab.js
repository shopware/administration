(window.webpackJsonpAdministration=window.webpackJsonpAdministration||[]).push([[87342],{172804:function(){},787342:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return n}}),s(805827);let{Context:r}=Shopware,{Criteria:o}=Shopware.Data;var n={template:'\n{% block sw_settings_product_feature_sets_modal %}\n<sw-modal\n    :title="$tc(\'sw-settings-product-feature-sets.modal.labelTitleModal\')"\n    class="sw-settings-product-feature-sets__modal"\n    @modal-close="$emit(\'modal-close\')"\n>\n\n    \n    {% block sw_settings_product_feature_sets_modal_first_page %}\n    <template v-if="showPageOne">\n        <sw-radio-field\n            v-model:value="selectedFeatureType"\n            :label="$tc(\'sw-settings-product-feature-sets.modal.labelTitlePageOne\')"\n            block\n            class="sw-settings-product-feature-sets-modal__options"\n            identification="fieldType"\n            :options="settingOptions"\n            @update:value="onChangeOption"\n        />\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_settings_product_feature_sets_modal_custom_field_list %}\n    <template v-if="showCustomField">\n\n        \n        {% block sw_settings_product_feature_sets_modal_custom_field_list_toolbar %}\n        <div class="sw-product-feature-set-modal-custom-field-list__toolbar">\n\n            \n            {% block sw_settings_product_feature_sets_modal_custom_field_list_toolbar_search %}\n            <sw-simple-search-field\n                v-model:value="term"\n                size="small"\n                variant="form"\n                @search-term-change="onSearchCustomFields"\n            />\n            {% endblock %}\n\n        </div>\n        {% endblock %}\n\n        <sw-data-grid\n            ref="customFieldGrid"\n            :data-source="customFields"\n            :columns="customFieldColumns"\n            :show-selection="true"\n            :show-actions="false"\n            :is-loading="valuesLoading"\n            identifier="sw-product-feature-set-modal-custom-field-list"\n            @selection-change="setFeatureSelection"\n        >\n\n            \n            {% block sw_settings_product_feature_sets_modal_custom_field_list_column_name %}\n            <template #column-name="{ item }">\n                {{ readCustomFieldLabel(item) }}\n            </template>\n            {% endblock %}\n\n            \n            {% block sw_settings_product_feature_sets_modal_custom_field_list_column_type %}\n            <template #column-type="{ item }">\n                {{ item.type }}\n            </template>\n            {% endblock %}\n\n            \n            {% block sw_settings_product_feature_sets_modal_custom_field_list_pagination %}\n            <template #pagination>\n                <sw-pagination\n                    v-if="customFieldTotal > customFieldCriteria.limit"\n                    :total="customFieldTotal"\n                    :limit="customFieldCriteria.limit"\n                    :page="customFieldCriteria.page"\n                    :auto-hide="false"\n                    @page-change="paginateCustomFieldGrid"\n                />\n            </template>\n            {% endblock %}\n\n        </sw-data-grid>\n\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_settings_product_feature_sets_modal_property_list %}\n    <template v-if="showPropertyGroups">\n\n        \n        {% block sw_settings_product_feature_sets_modal_property_list_toolbar %}\n        <div class="sw-product-feature-set-modal-property-list__toolbar">\n\n            \n            {% block sw_settings_product_feature_sets_modal_property_list_toolbar_search %}\n            <sw-simple-search-field\n                v-model:value="term"\n                size="small"\n                variant="form"\n                @search-term-change="onSearchPropertyGroups"\n            />\n            {% endblock %}\n\n        </div>\n        {% endblock %}\n\n        <sw-data-grid\n            ref="propertyGroupGrid"\n            :data-source="propertyGroups"\n            :columns="propertyGroupColumns"\n            :show-selection="true"\n            :show-actions="false"\n            :is-loading="valuesLoading"\n            identifier="sw-product-feature-set-modal-property-list"\n            @selection-change="setFeatureSelection"\n        >\n\n            \n            {% block sw_settings_product_feature_sets_modal_property_list_column_property %}\n            <template #column-id="{ item }">\n                {{ item.name }}\n            </template>\n            {% endblock %}\n\n            \n            {% block sw_settings_product_feature_sets_modal_property_list_pagination %}\n            <template #pagination>\n                <sw-pagination\n                    v-if="propertyGroupTotal > propertyGroupCriteria.limit"\n                    :total="propertyGroupTotal"\n                    :limit="propertyGroupCriteria.limit"\n                    :page="propertyGroupCriteria.page"\n                    :auto-hide="false"\n                    @page-change="paginatePropertyGroupGrid"\n                />\n            </template>\n            {% endblock %}\n\n        </sw-data-grid>\n\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_settings_product_feature_sets_modal_product_information_list %}\n    <template v-if="showProductInfo">\n\n        \n        {% block sw_settings_product_feature_sets_modal_product_information_list_toolbar %}{% endblock %}\n\n        <sw-data-grid\n            :data-source="productInfo"\n            :columns="productInformationColumns"\n            :show-selection="true"\n            :show-actions="false"\n            :is-loading="valuesLoading"\n            identifier="sw-product-feature-set-modal-product-information-list"\n            @selection-change="setFeatureSelection"\n        >\n\n            \n            {% block sw_settings_product_feature_sets_modal_product_informationlist_column_property %}\n            <template #column-id="{ item }">\n                {{ item.name }}\n            </template>\n            {% endblock %}\n\n        </sw-data-grid>\n\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_settings_product_feature_sets_modal_footer %}\n    <template #modal-footer>\n\n        \n        {% block sw_settings_product_feature_sets_modal_footer_cancel %}\n        <sw-button\n            size="small"\n            @click="$emit(\'modal-close\')"\n        >\n            {{ $tc(\'sw-settings-product-feature-sets.modal.buttonCancel\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_settings_product_feature_sets_modal_footer_button_add %}\n        <sw-button\n            v-if="!showPageOne | referencePriceSelected"\n            variant="primary"\n            size="small"\n            :disabled="addButtonDisabled"\n            @click="onConfirm"\n        >\n            {{ $tc(\'sw-settings-product-feature-sets.modal.buttonAdd\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_settings_product_feature_sets_modal_footer_button_next %}\n        <sw-button\n            v-if="showNextButton"\n            variant="primary"\n            size="small"\n            :disabled="nextButtonDisabled"\n            @click="onClickNext"\n        >\n            {{ $tc(\'sw-settings-product-feature-sets.modal.buttonNext\') }}\n        </sw-button>\n        {% endblock %}\n\n    </template>\n    {% endblock %}\n\n</sw-modal>\n{% endblock %}\n',inject:["repositoryFactory"],props:{productFeatureSet:{type:Object,required:!0}},data(){return{showModal:!1,featureType:null,selectedFeatures:new Map,features:[],selectedFeatureType:null,showPageOne:!0,term:"",showCustomField:!1,showPropertyGroups:!1,showProductInfo:!1,nextButtonDisabled:!0,addButtonDisabled:!0,showNextButton:!0,valuesLoading:!1,customFields:[],propertyGroups:[],productInfo:[{id:"fc472b0728ce4000969214a0fa61f2df",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.description"),name:"description"},{id:"f64801aad24a4de7bfea4d312f957258",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.releaseDate"),name:"releaseDate"},{id:"f4a361187eac4f6ea4507ebf20c2e9d7",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.manufacturerNumber"),name:"manufacturerNumber"},{id:"eb6c8ec9b6e24811a176be5a5c9871cf",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.ean"),name:"ean"},{id:"09110f8260804f009ab4536a1ffbc938",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.width"),name:"width"},{id:"e8a48d5fce2f402e8696477b03d7e8e7",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.height"),name:"height"},{id:"e4cf3f607a704f569c3912fb85ada9ad",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.length"),name:"length"},{id:"e06c53dc014a4130a8850fe64e395046",type:"product",label:this.$tc("sw-settings-product-feature-sets.modal.label.weight"),name:"weight"}]}},computed:{productFeatureSetRepository(){return this.repositoryFactory.create("product_feature_set")},customFieldsRepository(){return this.repositoryFactory.create("custom_field")},propertyGroupsRepository(){return this.repositoryFactory.create("property_group")},productFeatureSetCriteria(){return new o(1,25)},customFieldCriteria(){let e=new o(1,25);e.addSorting(o.sort("type","DESC"));let t=this.getFeaturesIds("customField");return t.length>0&&e.addFilter(o.not("AND",[o.equalsAny("id",t)])),e},propertyGroupCriteria(){let e=new o(1,25),t=this.getFeaturesIds("property");return t.length>0&&e.addFilter(o.not("AND",[o.equalsAny("id",t)])),e},referencePriceSelected(){return"referencePrice"===this.selectedFeatureType},propertyGroupColumns(){return this.getPropertyGroupColumns()},customFieldColumns(){return this.getCustomFieldColumns()},productInformationColumns(){return this.getProductInformationColumns()},checkIfReferencePriceSelected(){return!!this.productFeatureSet.features&&1===this.productFeatureSet.features.filter(e=>"referencePrice"===e.type).length},settingOptions(){return[{value:"property",disabled:this.propertyGroups.length<1,name:this.$tc("sw-settings-product-feature-sets.modal.textPropertyLabel")},{value:"customField",disabled:this.customFields.length<1,name:this.$tc("sw-settings-product-feature-sets.modal.textCustomFieldLabel")},{value:"product",disabled:this.productInfo.length<1,name:this.$tc("sw-settings-product-feature-sets.modal.textProductInfoLabel")},{value:"referencePrice",disabled:this.checkIfReferencePriceSelected,name:this.$tc("sw-settings-product-feature-sets.modal.textReferencePriceLabel")}]},customFieldTotal(){return this.customFields.total||0},propertyGroupTotal(){return this.propertyGroups.total||0}},created(){this.createdComponent()},methods:{createdComponent(){this.productFeatureSet.features&&(this.features=this.productFeatureSet.features),this.customFieldCriteria.setLimit(10),this.propertyGroupCriteria.setLimit(10),this.getCustomFieldList(),this.getPropertyList(),this.getProductInformationList()},onSearchCustomFields(){this.customFieldCriteria.setTerm(this.term),this.getCustomFieldList()},onSearchPropertyGroups(){this.propertyGroupCriteria.setTerm(this.term),this.getPropertyList()},onClickNext(){switch(this.showPageOne=!1,this.showNextButton=!1,this.featureType=this.selectedFeatureType,this.selectedFeatureType){case"customField":this.showCustomField=!0;break;case"property":this.showPropertyGroups=!0;break;case"product":this.showProductInfo=!0}},getProductInformationList(){if(!this.productFeatureSet.features)return;let e=this.productFeatureSet.features.map(e=>e.name);this.productInfo=this.productInfo.filter(t=>!("product"===t.type&&e.includes(t.name)))},getCustomFieldList(){return this.getList(this.customFieldsRepository,this.customFieldCriteria,e=>{this.customFields=e,this.valuesLoading=!1})},getPropertyList(){return this.getList(this.propertyGroupsRepository,this.propertyGroupCriteria,e=>{this.propertyGroups=e,this.valuesLoading=!1})},getList(e,t,s){return this.valuesLoading=!0,e.search(t,Shopware.Context.api).then(s).catch(()=>{this.valuesLoading=!1})},getFeaturesIds(e){return this.productFeatureSet.features?this.productFeatureSet.features.filter(t=>t.type===e).map(e=>e.id):[]},onChangeOption(){this.checkIfReferencePriceIsSelected(),this.addButtonDisabled=!this.referencePriceSelected,this.nextButtonDisabled&&(this.nextButtonDisabled=!1)},checkIfReferencePriceIsSelected(){this.showNextButton=!this.referencePriceSelected},onConfirm(){this.referencePriceSelected?this.features.push({id:"d45b40f6a99c4c2abe66c410369b9d3c",name:"referencePrice",type:"referencePrice",position:this.features.length+1}):this.selectedFeatures.forEach(e=>this.setFeatures(e)),this.productFeatureSet.features=this.features,this.productFeatureSetRepository.save(this.productFeatureSet,r.api).then(()=>{this.isSaveSuccessful=!0,this.featureType=null,this.$emit("modal-close")}).catch(()=>{this.createNotificationError({title:this.$tc("global.default.error"),message:this.$tc("global.notification.unspecifiedSaveErrorMessage")})}).finally(()=>{this.isLoading=!1})},setFeatures(e){Object.keys(e).forEach(t=>{this.features.push({id:e[t].id,name:e[t].name,type:this.selectedFeatureType,position:this.features.length+1})})},setFeatureSelection(e,t){if(!(this.showCustomField||this.showPropertyGroups)){if(t<1){this.addButtonDisabled=!0;return}this.selectedFeatures.set(1,e),this.addButtonDisabled=!1;return}let s=(this.showCustomField?this.customFieldCriteria:this.propertyGroupCriteria).page,r=this.selectedFeatures.get(s);if(!r||Object.keys(r).length<1){this.selectedFeatures.set(s,e),this.addButtonDisabled=!1;return}let o=this.showCustomField?this.$refs.customFieldGrid:this.$refs.propertyGroupGrid;Object.keys(r).forEach(e=>o.selectItem(!0,r[e]))},getPropertyGroupColumns(){return[{property:"name",label:"sw-settings-product-feature-sets.modal.textPropertyLabel",primary:!0}]},getCustomFieldColumns(){return[{property:"name",label:"sw-settings-product-feature-sets.modal.labelName",primary:!0},{property:"type",label:"sw-settings-product-feature-sets.valuesCard.labelType"}]},getProductInformationColumns(){return[{property:"label",label:"sw-settings-product-feature-sets.modal.labelName",primary:!0}]},paginateCustomFieldGrid({page:e,limit:t}){this.customFieldCriteria.setPage(e),this.customFieldCriteria.setLimit(t),this.getCustomFieldList()},paginatePropertyGroupGrid({page:e,limit:t}){this.propertyGroupCriteria.setPage(e),this.propertyGroupCriteria.setLimit(t),this.getPropertyList()},readCustomFieldLabel(e){let t=Shopware.State.get("session").currentLocale,s=Shopware.Context.app.fallbackLocale;return e.config.label[t]||e.config.label[s]}}}},805827:function(e,t,s){var r=s(172804);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),s(745346).Z("5ac95f1c",r,!0,{})}}]);