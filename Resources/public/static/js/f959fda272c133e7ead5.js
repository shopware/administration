(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[370],{KTcn:function(t,n,i){},TeaE:function(t,n,i){"use strict";i.r(n);i("jmqr"),n.default={template:'\n{% block sw_product_variants_configurator_restrictions %}\n<div class="sw-product-variants-configurator-restrictions">\n\n    \n    {% block sw_product_variants_configurator_restrictions_search %}\n    <div class="sw-product-variants-configurator-restrictions__search">\n        \n        {% block sw_product_variants_configurator_restrictions_search_field %}\n        <sw-simple-search-field\n            v-model="term"\n            size="small"\n            variant="form"\n            :placeholder="$tc(\'sw-product.variations.configuratorModal.searchRestrictions\')"\n        />\n        {% endblock %}\n\n        \n        {% block sw_product_variants_configurator_restrictions_buttons %}\n        <sw-button\n            variant="ghost"\n            size="small"\n            @click="addEmptyRestrictionCombination"\n        >\n            {{ $tc(\'sw-product.variations.configuratorModal.addNewRestriction\') }}\n        </sw-button>\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    \n    {% block sw_product_variants_configurator_restrictions_grid_wrapper %}\n    <div class="sw-product-variants-configurator-restrictions__grid-wrapper">\n        \n        {% block sw_product_variants_configurator_restrictions_data_grid %}\n        <sw-data-grid\n            v-if="product.variantRestrictions"\n            ref="swDataGrid"\n            :data-source="filteredRestrictions"\n            :columns="restrictionColumns"\n            :show-selection="false"\n            :compact-mode="false"\n            full-page\n        >\n\n            \n            {% block sw_product_variants_configurator_restrictions_data_grid_column_id %}\n            <template\n                #column-id="{ item, isInlineEdit, compact }"\n            >\n                <template v-for="restriction in getRestrictionsWithNaming(item.id).values">\n                    <span\n                        :key="restriction.id"\n                        class="sw-product-variants-configurator-restrictions__group-name"\n                    >\n                        {{ restriction.group }}:\n                    </span>\n                    <sw-label\n                        v-for="option in restriction.options"\n                        :key="option.id"\n                        ghost\n                    >\n                        {{ option }}\n                    </sw-label>\n                </template>\n            </template>\n            {% endblock %}\n\n            \n            {% block sw_product_variants_configurator_restrictions_data_grid_actions %}\n            <template\n                #actions="{ item }"\n            >\n                \n                {% block sw_product_variants_configurator_restrictions_data_grid_actions_items %}\n                <sw-context-menu-item @click="editRestrictionCombination(item)">\n                    {{ $tc(\'sw-product.variations.configuratorModal.editRestriction\') }}\n                </sw-context-menu-item>\n\n                <sw-context-menu-item\n                    variant="danger"\n                    @click="deleteRestrictionCombination(item)"\n                >\n                    {{ $tc(\'sw-product.variations.configuratorModal.deleteRestriction\') }}\n                </sw-context-menu-item>\n                {% endblock %}\n            </template>\n            {% endblock %}\n        </sw-data-grid>\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    \n    {% block sw_product_variants_configurator_restrictions_modal %}\n    <sw-modal\n        v-if="restrictionModalIsOpen"\n        :title="$tc(\'sw-product.variations.configuratorModal.singleRestrictionAddTitle\')"\n        class="sw-product-variants-configurator-restrictions__modal"\n        @modal-close="cancelAddRestriction"\n    >\n\n        \n        {% block sw_product_variants_configurator_restrictions_modal_main %}\n        <div class="sw-product-variants-configurator-restrictions__modal-main">\n            \n            {% block sw_product_variants_configurator_restrictions_modal_main_restriction_selection %}\n            <sw-product-restriction-selection\n                v-for="(restriction, index) in actualRestriction.values"\n                :key="restriction.id"\n                :groups-with-options="groupsWithOptions"\n                :restriction="restriction"\n                @restriction-delete="deleteRestriction"\n            >\n\n                <template #contentAfter>\n                    <p\n                        v-if="index < actualRestrictionValueLength - 1"\n                        class="sw-product-variants-configurator-restrictions__seperator"\n                    >\n                        {{ $tc(\'sw-product.variations.configuratorModal.singleRestrictionSeperation\') }}\n                    </p>\n                </template>\n            </sw-product-restriction-selection>\n            {% endblock %}\n\n            \n            {% block sw_product_variants_configurator_restrictions_modal_main_button_new_restriction %}\n            <sw-button\n                class="sw-product-variants-configurator-restrictions__button-new-restriction"\n                @click="addEmptyRestriction"\n            >\n                {{ $tc(\'sw-product.variations.configuratorModal.singleRestrictionSeperation\') }}\n            </sw-button>\n            {% endblock %}\n        </div>\n        {% endblock %}\n\n        \n        {% block sw_product_variants_configurator_restrictions_modal_footer %}\n        <template #modal-footer>\n            \n            {% block sw_product_variants_configurator_restrictions_modal_footer_cancel %}\n            <sw-button\n                size="small"\n                @click="cancelAddRestriction"\n            >\n                {{ $tc(\'sw-product.variations.configuratorModal.cancel\') }}\n            </sw-button>\n            {% endblock %}\n            \n            {% block sw_product_variants_configurator_restrictions_modal_footer_save_add_restriction %}\n            <sw-button\n                variant="primary"\n                size="small"\n                @click="saveAddRestriction"\n            >\n                {{ $tc(\'sw-product.variations.configuratorModal.save\') }}\n            </sw-button>\n            {% endblock %}\n        </template>\n        {% endblock %}\n    </sw-modal>\n    {% endblock %}\n\n    \n    {% block sw_product_variants_configurator_restrictions_loader %}\n    <sw-loader v-if="isLoading" />\n    {% endblock %}\n\n</div>\n{% endblock %}\n',props:{product:{type:Object,required:!0},selectedGroups:{type:Array,required:!0}},data:function(){return{term:"",restrictionModalIsOpen:!1,isLoading:!0,groupsWithOptions:[],actualRestriction:{}}},computed:{restrictionColumns:function(){return[{property:"id",label:"sw-product.variations.configuratorModal.restrictedCombinations",rawData:!0}]},actualRestrictionValueLength:function(){return this.actualRestriction.values.length},filteredRestrictions:function(){var t=this;if(this.term.length<=0)return this.product.variantRestrictions;var n=this.product.variantRestrictions.map((function(n){return t.getRestrictionsWithNaming(n.id)})).reduce((function(n,i){var o=!1;return i.values.forEach((function(n){n.group.toLowerCase().includes(t.term.toLowerCase())&&(o=!0),n.options.find((function(n){return!!n.toLowerCase().includes(t.term.toLowerCase())&&(o=!0,!0)}))})),o&&n.push(i.id),n}),[]);return this.product.variantRestrictions.filter((function(t){return n.indexOf(t.id)>=0}))}},mounted:function(){this.mountedComponent()},methods:{mountedComponent:function(){var t=this;this.filterEmptyValues(),this.groupsWithOptions=this.selectedGroups.map((function(n){return{group:n,options:t.getOptionsForGroupId(n.id)}})),this.isLoading=!1},getOptionsForGroupId:function(t){return this.product.configuratorSettings.filter((function(n){return!n.isDeleted&&n.option.groupId===t}))},getRestrictionsWithNaming:function(t){var n=this,i=this.product.variantRestrictions.find((function(n){return n.id===t}));return{id:i.id,values:i.values.map((function(t){var i=n.selectedGroups.find((function(n){return n.id===t.group}));if(!i)return{group:"",options:[]};var o=t.options.reduce((function(t,i){var o=i.optionId?i.optionId:i,r=n.product.configuratorSettings.find((function(t){return o===t.optionId}));return null!=r&&r.option&&t.push(r.option.translated.name),t}),[]);return{group:i.translated.name,options:o}}))}},filterEmptyValues:function(){var t=this;return!!this.product.variantRestrictions&&(this.product.variantRestrictions=this.product.variantRestrictions.filter((function(n){return n.values=n.values.filter((function(n){return n.options=n.options.filter((function(n){return t.product.configuratorSettings.find((function(t){return n===t.optionId}))})),n.options.length>0})),n.values.length>0})),!0)},addEmptyRestrictionCombination:function(){var t=String((new Date).valueOf()).split("").reverse().join("");this.actualRestriction={id:t,values:[]},this.addEmptyRestriction(),this.restrictionModalIsOpen=!0},addEmptyRestriction:function(){var t=String((new Date).valueOf()).split("").reverse().join(""),n=this.groupsWithOptions[0].group;this.actualRestriction.values.push({id:t,group:n.id,options:[]})},cancelAddRestriction:function(){this.actualRestriction={},this.restrictionModalIsOpen=!1},saveAddRestriction:function(){var t=this;null===this.product.variantRestrictions&&(this.product.variantRestrictions=[]),this.product.variantRestrictions.some((function(n){return n.id===t.actualRestriction.id}))||this.product.variantRestrictions.push(this.actualRestriction),this.actualRestriction={},this.restrictionModalIsOpen=!1},editRestrictionCombination:function(t){this.actualRestriction=t,this.restrictionModalIsOpen=!0},deleteRestrictionCombination:function(t){this.product.variantRestrictions=this.product.variantRestrictions.filter((function(n){return n.id!==t.id}))},deleteRestriction:function(t){this.actualRestriction.values=this.actualRestriction.values.filter((function(n){return n!==t}))}}}},jmqr:function(t,n,i){var o=i("KTcn");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,i("P8hj").default)("e04d6fe2",o,!0,{})}}]);