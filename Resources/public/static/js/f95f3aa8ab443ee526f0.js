(window.webpackJsonpAdministration=window.webpackJsonpAdministration||[]).push([[79805],{63995:function(){},79805:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}}),n(41852);let{Mixin:s}=Shopware,{Criteria:i}=Shopware.Data;var l={template:'\n{% block sw_cms_layout_modal %}\n<sw-modal\n    class="sw-cms-layout-modal"\n    variant="large"\n    :title="$tc(\'sw-cms.components.cmsLayoutModal.modalTitle\')"\n    @modal-close="closeModal"\n>\n\n    \n    {% block sw_cms_layout_modal_header %}\n    <div class="sw-cms-layout-modal__header">\n\n        \n        {% block sw_cms_layout_modal_header_search %}\n        <sw-simple-search-field\n            v-model:value="term"\n            class="sw-cms-layout-modal__header-search"\n            :placeholder="$tc(\'sw-cms.general.placeholderSearchBar\')"\n            @search-term-change="onSearch"\n        />\n        {% endblock %}\n\n        \n        {% block sw_cms_layout_modal_header_sorting_container %}\n        <div class="sw-cms-layout-modal__actions-sorting">\n\n            \n            {% block sw_cms_layout_modal_header_sorting_select %}\n            <sw-sorting-select\n                class="sw-cms-layout-modal__header-sorting-select"\n                :sort-by="sortBy"\n                :sort-direction="sortDirection"\n                @sorting-changed="onSort"\n            />\n            {% endblock %}\n\n            \n            {% block sw_cms_layout_modal_header_view_toggle %}\n            <div\n                class="sw-cms-layout-modal__actions-mode"\n                role="button"\n                tabindex="0"\n                @click="toggleListMode"\n                @keydown.enter="toggleListMode"\n            >\n\n                \n                {% block sw_cms_layout_modal_header_view_toogle_grid %}\n                <sw-icon\n                    v-if="listMode === \'grid\'"\n                    name="regular-view-normal"\n                    size="16"\n                />\n                {% endblock %}\n\n                \n                {% block sw_cms_layout_modal_header_view_toogle_list %}\n                <sw-icon\n                    v-if="listMode === \'list\'"\n                    name="regular-view-grid"\n                    size="16"\n                />\n                {% endblock %}\n\n            </div>\n            {% endblock %}\n\n        </div>\n        {% endblock %}\n\n    </div>\n    {% endblock %}\n\n    \n    {% block sw_cms_layout_modal_content %}\n    <div class="sw-cms-layout-modal__content">\n\n        \n        {% block sw_cms_layout_modal_loader %}\n        <sw-loader v-if="isLoading" />\n        {% endblock %}\n\n        \n        {% block sw_cms_layout_modal_content_container %}\n        <div v-else-if="listMode === \'grid\'">\n            <sw-container\n                columns="repeat(auto-fill, minmax(250px, 1fr))"\n                gap="24px"\n            >\n\n                \n                {% block sw_cms_layout_modal_content_listing %}\n                <div\n                    v-for="(cmsPage, index) in pages"\n                    :key="index"\n                    :class="gridItemClasses(cmsPage.id, index)"\n                >\n                    \n                    {% block sw_cms_layout_modal_content_listing_item %}\n\n                    \n                    {% block sw_cms_layout_modal_content_listing_item_checkbox %}\n                    <sw-checkbox-field\n                        :value="cmsPage.id === selectedPageObject?.id"\n                        class="sw-cms-layout-modal__content-checkbox"\n                        @update:value="selectItem(cmsPage)"\n                    />\n                    {% endblock %}\n\n                    \n                    {% block sw_cms_layout_modal_content_listing_item_inner %}\n                    <sw-cms-list-item\n                        :page="cmsPage"\n                        :is-default="[defaultProductId, defaultCategoryId].includes(cmsPage.id)"\n                        @item-click="selectItem(cmsPage)"\n                    />\n                    {% endblock %}\n\n                    {% endblock %}\n                </div>\n            </sw-container>\n\n            \n            {% block sw_cms_layout_modal_content_pagination %}\n            <sw-pagination\n                class="sw-cms-layout-modal__content-pagination"\n                :page="page"\n                :limit="limit"\n                :total="total"\n                :auto-hide="false"\n                @page-change="onPageChange"\n            />\n            {% endblock %}\n\n        </div>\n        {% endblock %}\n\n        <sw-data-grid\n            v-else-if="listMode === \'list\'"\n            class="sw-cms-list__list-data-grid"\n            identifier="sw-cms-list"\n            :is-loading="isLoading"\n            :limit="limit"\n            :data-source="pages"\n            :columns="columnConfig"\n            :skeleton-item-amount="limit"\n            :sort-by="sortBy"\n            :sort-direction="sortDirection"\n            :allow-inline-edit="false"\n            :allow-column-edit="false"\n            :show-settings="false"\n            :show-actions="false"\n            :show-selection="true"\n            :maximum-select-items="1"\n            :pre-selection="gridPreSelection"\n            @selection-change="selectInGrid"\n            @column-sort="onSortColumn"\n        >\n\n            \n            {% block sw_cms_list_listing_list_data_grid_column_name %}\n            <template #column-name="{ item }">\n                <div\n                    role="button"\n                    tabindex="0"\n                    @click="selectItem(item)"\n                    @keydown.enter="selectItem(item)"\n                >\n                    {{ item.translated.name }}\n                </div>\n            </template>\n            {% endblock %}\n\n            \n            {% block sw_cms_list_listing_list_data_grid_column_type %}\n            <template #column-type="{ item }">\n                {{ getPageType(item) }}\n            </template>\n            {% endblock %}\n\n            \n            {% block sw_cms_list_listing_list_data_grid_column_created %}\n            <template #column-createdAt="{ item }">\n                {{ dateFilter(item.createdAt, { hour: \'2-digit\', minute: \'2-digit\' }) }}\n            </template>\n            {% endblock %}\n\n            \n            {% block sw_cms_list_listing_list_data_grid_column_updated %}\n            <template #column-updatedAt="{ item }">\n                {{ dateFilter(item.updatedAt, { hour: \'2-digit\', minute: \'2-digit\' }) }}\n            </template>\n            {% endblock %}\n\n            \n            {% block sw_cms_list_listing_list_data_grid_pagination %}\n            <template #pagination>\n                <sw-pagination\n                    :page="page"\n                    :limit="limit"\n                    :total="total"\n                    :auto-hide="false"\n                    @page-change="onPageChange"\n                />\n            </template>\n            {% endblock %}\n        </sw-data-grid>\n        {% endblock %}\n    </div>\n    {% endblock %}\n\n    \n    {% block sw_cms_layout_modal_footer %}\n    <template #modal-footer>\n        <sw-button @click="closeModal">\n            {{ $tc(\'sw-cms.components.cmsLayoutModal.actionCancel\') }}\n        </sw-button>\n        <sw-button\n            variant="primary"\n            @click="selectLayout"\n        >\n            {{ $tc(\'sw-cms.components.cmsLayoutModal.actionConfirm\') }}\n        </sw-button>\n    </template>\n    {% endblock %}\n\n</sw-modal>\n{% endblock %}\n',inject:["repositoryFactory","systemConfigApiService","acl","cmsPageTypeService"],mixins:[s.getByName("listing")],props:{headline:{type:String,required:!1,default:""},cmsPageTypes:{type:Array,required:!1,default(){return[]}},preSelection:{type:Object,required:!1,default:()=>{}}},data(){return{listMode:"grid",disableRouteParams:!0,sortBy:"createdAt",sortDirection:"DESC",limit:10,selectedPageObject:null,isLoading:!1,term:null,total:null,pages:[],defaultCategoryId:"",defaultProductId:""}},computed:{pageRepository(){return this.repositoryFactory.create("cms_page")},cmsPageCriteria(){let e=new i(this.page,this.limit);return e.addAssociation("previewMedia").addSorting(i.sort(this.sortBy,this.sortDirection)),this.cmsPageTypes.length&&e.addFilter(i.equalsAny("type",this.cmsPageTypes)),null!==this.term&&e.setTerm(this.term),e},columnConfig(){return[{property:"name",label:this.$tc("sw-cms.list.gridHeaderName"),inlineEdit:"string",primary:!0},{property:"type",label:this.$tc("sw-cms.list.gridHeaderType")},{property:"createdAt",label:this.$tc("sw-cms.list.gridHeaderCreated")},{property:"updatedAt",label:this.$tc("sw-cms.list.gridHeaderUpdated")}]},gridPreSelection(){return this.selectedPageObject?.id?{[this.selectedPageObject.id]:this.selectedPageObject}:{}},dateFilter(){return Shopware.Filter.getByName("date")}},watch:{preSelection:{handler:function(e){this.selectedPageObject=e},immediate:!0}},created(){this.createdComponent()},methods:{createdComponent(){this.acl.can("system_config.read")&&this.getDefaultLayouts()},getList(){return this.isLoading=!0,this.pageRepository.search(this.cmsPageCriteria).then(e=>{this.total=e.total,this.pages=e,this.isLoading=!1}).catch(()=>{this.isLoading=!1})},selectLayout(){this.$emit("modal-layout-select",this.selectedPageObject?.id,this.selectedPageObject),this.closeModal()},selectInGrid(e){let t=Object.values(e);if(0===t.length){this.selectedPageObject=null;return}this.selectedPageObject=t[0]},selectItem(e){this.selectedPageObject=e},onSearch(e){(!e.length||e.length<=0)&&(this.term=null),this.page=1,this.getList()},toggleListMode(){this.listMode="grid"===this.listMode?"list":"grid"},gridItemClasses(e,t){return[{"is--selected":e===this.selectedPageObject?.id},"sw-cms-layout-modal__content-item",`sw-cms-layout-modal__content-item--${t}`]},closeModal(){this.selectedPageObject=null,this.term=null,this.$emit("modal-close")},getPageType(e){let t=[this.defaultProductId,this.defaultCategoryId].includes(e.id),n=this.$tc("sw-cms.components.cmsListItem.defaultLayout"),s=this.$tc(this.cmsPageTypeService.getType(e.type)?.title);return t?`${n} - ${s}`:s},async getDefaultLayouts(){let e=await this.systemConfigApiService.getValues("core.cms");this.defaultCategoryId=e["core.cms.default_category_cms_page"],this.defaultProductId=e["core.cms.default_product_cms_page"]}}}},41852:function(e,t,n){var s=n(63995);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals),n(45346).Z("156d0903",s,!0,{})}}]);