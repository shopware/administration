{"version":3,"sources":["webpack:///./src/module/sw-settings-tag/component/sw-settings-tag-detail-modal/sw-settings-tag-detail-modal.scss","webpack:///./src/module/sw-settings-tag/component/sw-settings-tag-detail-modal/index.js","webpack:///./src/module/sw-settings-tag/component/sw-settings-tag-detail-modal/sw-settings-tag-detail-modal.html.twig"],"names":["content","__esModule","default","module","i","locals","exports","add","Mixin","Shopware","mapPropertyErrors","Component","getComponentHelper","template","inject","mixins","getByName","shortcuts","active","this","allowSave","method","ESCAPE","props","editedTag","type","Object","required","counts","property","String","entity","data","tag","isLoading","assignmentsToBeAdded","assignmentsToBeDeleted","initialTab","computed","_objectSpread","tagRepository","repositoryFactory","create","tagDefinition","EntityDefinition","get","title","isNew","$tc","name","acl","can","tooltipSave","message","disabled","showOnDisabledElements","systemKey","$device","getSystemKey","concat","appearance","computedCounts","_this","keys","forEach","propertyName","hasOwnProperty","length","created","createdComponent","methods","_this2","assign","_isNew","entries","properties","_ref","_ref2","_slicedToArray","relation","$set","onSave","_this3","_asyncToGenerator","_regeneratorRuntime","mark","_callee","deletePayload","wrap","_context","prev","next","_ref3","_ref4","toBeAdded","id","toBeDeleted","ids","map","_ref5","_defineProperty","reference","local","push","action","mapping","payload","syncService","sync","abrupt","save","then","$emit","catch","createNotificationError","stop","onCancel","addAssignment","assignment","item","$delete","removeAssignment"],"mappings":"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","file":"static/js/d03d03df938c93ab0536.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-settings-tag-detail-modal.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"81934720\", content, true, {});","/**\n * @package inventory\n */\nimport template from './sw-settings-tag-detail-modal.html.twig';\nimport './sw-settings-tag-detail-modal.scss';\n\nconst { Mixin } = Shopware;\nconst { mapPropertyErrors } = Shopware.Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: [\n        'repositoryFactory',\n        'syncService',\n        'acl',\n    ],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    shortcuts: {\n        'SYSTEMKEY+S': {\n            active() {\n                return this.allowSave;\n            },\n            method: 'onSave',\n        },\n        ESCAPE: 'onCancel',\n    },\n\n    props: {\n        editedTag: {\n            type: Object,\n            required: false,\n            default: null,\n        },\n        counts: {\n            type: Object,\n            required: false,\n            default() {\n                return {};\n            },\n        },\n        property: {\n            type: String,\n            required: false,\n            default: null,\n        },\n        entity: {\n            type: String,\n            required: false,\n            default: null,\n        },\n    },\n\n    data() {\n        return {\n            tag: null,\n            isLoading: false,\n            assignmentsToBeAdded: {},\n            assignmentsToBeDeleted: {},\n            initialTab: this.property && this.entity ? 'assignments' : 'general',\n        };\n    },\n\n    computed: {\n        tagRepository() {\n            return this.repositoryFactory.create('tag');\n        },\n\n        tagDefinition() {\n            return Shopware.EntityDefinition.get('tag');\n        },\n\n        ...mapPropertyErrors('tag', ['name']),\n\n        title() {\n            return this.tag.isNew()\n                ? this.$tc('sw-settings-tag.list.buttonAddTag')\n                : this.$tc('sw-settings-tag.detail.editTitle', 0, { name: this.tag.name });\n        },\n\n        allowSave() {\n            return this.tag.isNew()\n                ? this.acl.can('tag.creator')\n                : this.acl.can('tag.editor');\n        },\n\n        tooltipSave() {\n            if (!this.allowSave) {\n                return {\n                    message: this.$tc('sw-privileges.tooltip.warning'),\n                    disabled: this.allowSave,\n                    showOnDisabledElements: true,\n                };\n            }\n\n            const systemKey = this.$device.getSystemKey();\n\n            return {\n                message: `${systemKey} + S`,\n                appearance: 'light',\n            };\n        },\n\n        computedCounts() {\n            const counts = { ...this.counts };\n\n            Object.keys(this.assignmentsToBeDeleted).forEach((propertyName) => {\n                if (!counts.hasOwnProperty(propertyName)) {\n                    return;\n                }\n\n                counts[propertyName] -= Object.keys(this.assignmentsToBeDeleted[propertyName]).length;\n            });\n\n            Object.keys(this.assignmentsToBeAdded).forEach((propertyName) => {\n                if (!counts.hasOwnProperty(propertyName)) {\n                    counts[propertyName] = Object.keys(this.assignmentsToBeAdded[propertyName]).length;\n\n                    return;\n                }\n\n                counts[propertyName] += Object.keys(this.assignmentsToBeAdded[propertyName]).length;\n            });\n\n            return counts;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            if (this.editedTag) {\n                this.tag = Object.assign(this.tagRepository.create(), this.editedTag);\n                this.tag._isNew = false;\n            } else {\n                this.tag = this.tagRepository.create();\n            }\n\n            Object.entries(this.tagDefinition.properties).forEach(([propertyName, property]) => {\n                if (property.relation === 'many_to_many') {\n                    this.$set(this.assignmentsToBeAdded, propertyName, {});\n                    this.$set(this.assignmentsToBeDeleted, propertyName, {});\n                }\n            });\n        },\n\n        async onSave() {\n            this.isLoading = true;\n            const deletePayload = [];\n\n            Object.entries(this.tagDefinition.properties).forEach(([propertyName, property]) => {\n                if (property.relation !== 'many_to_many') {\n                    return;\n                }\n\n                const toBeAdded = Object.keys(this.assignmentsToBeAdded[propertyName]);\n\n                if (toBeAdded.length !== 0) {\n                    toBeAdded.forEach((id) => {\n                        this.tag[propertyName].add(this.assignmentsToBeAdded[propertyName][id]);\n                    });\n                }\n\n                const toBeDeleted = Object.keys(this.assignmentsToBeDeleted[propertyName]);\n\n                if (toBeDeleted.length === 0) {\n                    return;\n                }\n\n                const ids = toBeDeleted.map((id) => {\n                    return {\n                        [property.reference]: id,\n                        [property.local]: this.tag.id,\n                    };\n                });\n\n                deletePayload.push({\n                    action: 'delete',\n                    entity: property.mapping,\n                    payload: ids,\n                });\n            });\n\n            if (deletePayload.length) {\n                await this.syncService.sync(deletePayload, {}, { 'single-operation': 1 });\n            }\n\n            return this.tagRepository.save(this.tag).then(() => {\n                this.$emit('finish');\n            }).catch(() => {\n                this.createNotificationError({\n                    message: this.$tc('global.notification.unspecifiedSaveErrorMessage'),\n                });\n                this.isLoading = false;\n            });\n        },\n\n        onCancel() {\n            this.$emit('close');\n        },\n\n        addAssignment(assignment, id, item) {\n            if (this.assignmentsToBeDeleted[assignment].hasOwnProperty(id)) {\n                this.$delete(this.assignmentsToBeDeleted[assignment], id);\n\n                return;\n            }\n\n            this.$set(this.assignmentsToBeAdded[assignment], id, item);\n        },\n\n        removeAssignment(assignment, id, item) {\n            if (this.assignmentsToBeAdded[assignment].hasOwnProperty(id)) {\n                this.$delete(this.assignmentsToBeAdded[assignment], id);\n\n                return;\n            }\n\n            this.$set(this.assignmentsToBeDeleted[assignment], id, item);\n        },\n    },\n};\n","export default \"\\n{% block sw_settings_tag_detail_modal %}\\n<sw-modal\\n    class=\\\"sw-settings-tag-detail-modal\\\"\\n    :class=\\\"{ 'is--auto-height': initialTab === 'general' }\\\"\\n    :title=\\\"title\\\"\\n    :is-loading=\\\"isLoading\\\"\\n    variant=\\\"full\\\"\\n    @modal-close=\\\"$emit('close')\\\"\\n>\\n    \\n    {% block sw_settings_tag_detail_modal_tabs %}\\n    <sw-tabs\\n        position-identifier=\\\"sw-settings-tag-detail-modal\\\"\\n        :small=\\\"false\\\"\\n        :default-item=\\\"initialTab\\\"\\n        @new-item-active=\\\"active => initialTab = active.name\\\"\\n    >\\n        <template #default=\\\"{ active }\\\">\\n            \\n            {% block sw_settings_tag_detail_modal_tabs_general %}\\n            <sw-tabs-item\\n                :title=\\\"$tc('sw-settings-tag.detail.generalTab')\\\"\\n                :active-tab=\\\"active\\\"\\n                name=\\\"general\\\"\\n            >\\n                {{ $tc('sw-settings-tag.detail.generalTab') }}\\n            </sw-tabs-item>\\n            {% endblock %}\\n\\n            \\n            {% block sw_settings_tag_detail_modal_tabs_assignments %}\\n            <sw-tabs-item\\n                :title=\\\"$tc('sw-settings-tag.detail.assignmentsTab')\\\"\\n                :active-tab=\\\"active\\\"\\n                name=\\\"assignments\\\"\\n            >\\n                {{ $tc('sw-settings-tag.detail.assignmentsTab') }}\\n            </sw-tabs-item>\\n            {% endblock %}\\n        </template>\\n\\n        <template #content=\\\"{ active }\\\">\\n            <template v-if=\\\"active === 'general'\\\">\\n                \\n                {% block sw_settings_tag_detail_modal_tabs_general_tab %}\\n                <p class=\\\"sw-settings-tag-detail-modal__tag-name\\\">\\n                    <sw-text-field\\n                        id=\\\"sw-field--tag-name\\\"\\n                        {% if VUE3 %}\\n                        v-model:value=\\\"tag.name\\\"\\n                        {% else %}\\n                        v-model=\\\"tag.name\\\"\\n                        {% endif %}\\n                        name=\\\"sw-field--tag-name\\\"\\n                        :label=\\\"$tc('sw-settings-tag.list.columnName')\\\"\\n                        :placeholder=\\\"$tc('sw-settings-tag.list.placeholderTagName')\\\"\\n                        :error=\\\"tagNameError\\\"\\n                        maxlength=\\\"255\\\"\\n                        required\\n                    />\\n                </p>\\n                {% endblock %}\\n            </template>\\n\\n            <template v-if=\\\"active === 'assignments'\\\">\\n                \\n                {% block sw_settings_tag_detail_modal_tabs_assignments_tab %}\\n                <sw-settings-tag-detail-assignments\\n                    :tag=\\\"tag\\\"\\n                    :initial-counts=\\\"computedCounts\\\"\\n                    :to-be-added=\\\"assignmentsToBeAdded\\\"\\n                    :to-be-deleted=\\\"assignmentsToBeDeleted\\\"\\n                    :property=\\\"property\\\"\\n                    :entity=\\\"entity\\\"\\n                    @add-assignment=\\\"addAssignment\\\"\\n                    @remove-assignment=\\\"removeAssignment\\\"\\n                />\\n                {% endblock %}\\n            </template>\\n        </template>\\n    </sw-tabs>\\n    {% endblock %}\\n\\n    \\n    {% block sw_settings_tag_detail_modal_footer %}\\n    <template #modal-footer>\\n        \\n        {% block sw_settings_tag_detail_modal_cancel %}\\n        <sw-button\\n            size=\\\"small\\\"\\n            @click=\\\"$emit('close')\\\"\\n        >\\n            {{ $tc('sw-settings-tag.list.buttonCancel') }}\\n        </sw-button>\\n        {% endblock %}\\n\\n        \\n        {% block sw_settings_tag_detail_modal_confirm %}\\n        <sw-button\\n            variant=\\\"primary\\\"\\n            size=\\\"small\\\"\\n            :disabled=\\\"!allowSave\\\"\\n            :is-loading=\\\"isLoading\\\"\\n            @click=\\\"onSave\\\"\\n        >\\n            {{ $tc('sw-settings-tag.detail.buttonSave') }}\\n        </sw-button>\\n        {% endblock %}\\n    </template>\\n    {% endblock %}\\n</sw-modal>\\n{% endblock %}\\n\";"],"sourceRoot":""}