{"version":3,"sources":["webpack:///./src/module/sw-order/view/sw-order-detail-general/index.js","webpack:///./src/module/sw-order/view/sw-order-detail-general/sw-order-detail-general.html.twig"],"names":["_Shopware","Shopware","Utils","Mixin","format","array","_Shopware$Component$g","Component","getComponentHelper","mapGetters","mapState","cloneDeep","object","template","inject","mixins","getByName","props","orderId","type","String","required","isSaveSuccessful","Boolean","computed","_objectSpread","delivery","this","order","deliveries","deliveryDiscounts","slice","shippingCostsDetail","_this","calcTaxes","sortByTaxRate","shippingCosts","calculatedTaxes","formattedTaxes","concat","map","calcTax","$tc","taxRate","tax","currency","shortName","join","sortedCalculatedTaxes","price","filter","taxStatus","displayRounded","totalRounding","interval","decimals","itemRounding","orderTotal","rawTotal","totalPrice","currencyFilter","Filter","methods","sort","prev","current","onShippingChargeEdited","amount","unitPrice","saveAndRecalculate","$emit","onSaveEdits","recalculateAndReload"],"mappings":"stBAMA,IAAAA,EAAyBC,SAAjBC,EAAKF,EAALE,MAAOC,EAAKH,EAALG,MACPC,EAAkBF,EAAlBE,OAAQC,EAAUH,EAAVG,MAChBC,EAAiCL,SAASM,UAAUC,qBAA5CC,EAAUH,EAAVG,WAAYC,EAAQJ,EAARI,SACZC,EAAcV,SAASC,MAAMU,OAA7BD,UAGO,WACXE,SCbW,uoRDeXC,OAAQ,CACJ,OAGJC,OAAQ,CACJZ,EAAMa,UAAU,iBAGpBC,MAAO,CACHC,QAAS,CACLC,KAAMC,OACNC,UAAU,GAGdC,iBAAkB,CACdH,KAAMI,QACNF,UAAU,IAIlBG,SAAQC,MAAA,GACDhB,EAAW,gBAAiB,CAC3B,eAGDC,EAAS,gBAAiB,CACzB,QACA,oBACF,IAEFgB,SAAQ,WACJ,OAAOC,KAAKC,MAAMC,WAAW,IAGjCC,kBAAiB,WACb,OAAOzB,EAAM0B,MAAMJ,KAAKC,MAAMC,WAAY,IAAM,IAGpDG,oBAAmB,WAAI,IAADC,EAAA,KACZC,EAAYP,KAAKQ,cAAcxB,EAAUgB,KAAKC,MAAMQ,cAAcC,kBAClEC,EAAc,GAAAC,OAAML,EAAUM,KAChC,SAAAC,GAAO,SAAAF,OAAON,EAAKS,IAAI,uCAAwC,EAAG,CAC9DC,QAASF,EAAQE,QACjBC,IAAKxC,EAAOyC,SAASJ,EAAQG,IAAKX,EAAKL,MAAMiB,SAASC,iBAE5DC,KAAK,SAEP,MAAM,GAANR,OAAUZ,KAAKe,IAAI,2BAA0B,QAAAH,OAAOD,IAGxDU,sBAAqB,WACjB,OAAOrB,KAAKQ,cAAcxB,EAAUgB,KAAKC,MAAMqB,MAAMZ,kBAChDa,QAAO,SAAAD,GAAK,OAAkB,IAAdA,EAAML,QAG/BO,UAAS,WACL,OAAOxB,KAAKC,MAAMqB,MAAME,WAG5BC,eAAc,WACV,MAA6C,MAAtCzB,KAAKC,MAAMyB,cAAcC,UACzB3B,KAAKC,MAAMyB,cAAcE,WAAa5B,KAAKC,MAAM4B,aAAaD,UAGzEE,WAAU,WACN,OAAI9B,KAAKyB,eACEzB,KAAKC,MAAMqB,MAAMS,SAGrB/B,KAAKC,MAAMqB,MAAMU,YAG5Bd,SAAQ,WACJ,OAAOlB,KAAKC,MAAMiB,UAGtBe,eAAc,WACV,OAAO3D,SAAS4D,OAAO7C,UAAU,eAIzC8C,QAAS,CACL3B,cAAa,SAACc,GACV,OAAOA,EAAMc,MAAK,SAACC,EAAMC,GACrB,OAAOD,EAAKrB,QAAUsB,EAAQtB,YAItCuB,uBAAsB,SAACC,GACnBxC,KAAKD,SAASU,cAAcgC,UAAYD,EACxCxC,KAAKD,SAASU,cAAcuB,WAAaQ,EACzCxC,KAAK0C,sBAGTA,mBAAkB,WACd1C,KAAK2C,MAAM,yBAGfC,YAAW,WACP5C,KAAK2C,MAAM,eAGfE,qBAAoB,WAChB7C,KAAK2C,MAAM","file":"static/js/5fe7ce68f88832e3960c.js","sourcesContent":["import template from './sw-order-detail-general.html.twig';\n\n/**\n * @package checkout\n */\n\nconst { Utils, Mixin } = Shopware;\nconst { format, array } = Utils;\nconst { mapGetters, mapState } = Shopware.Component.getComponentHelper();\nconst { cloneDeep } = Shopware.Utils.object;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: [\n        'acl',\n    ],\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    props: {\n        orderId: {\n            type: String,\n            required: true,\n        },\n\n        isSaveSuccessful: {\n            type: Boolean,\n            required: true,\n        },\n    },\n\n    computed: {\n        ...mapGetters('swOrderDetail', [\n            'isLoading',\n        ]),\n\n        ...mapState('swOrderDetail', [\n            'order',\n            'versionContext',\n        ]),\n\n        delivery() {\n            return this.order.deliveries[0];\n        },\n\n        deliveryDiscounts() {\n            return array.slice(this.order.deliveries, 1) || [];\n        },\n\n        shippingCostsDetail() {\n            const calcTaxes = this.sortByTaxRate(cloneDeep(this.order.shippingCosts.calculatedTaxes));\n            const formattedTaxes = `${calcTaxes.map(\n                calcTax => `${this.$tc('sw-order.detailBase.shippingCostsTax', 0, {\n                    taxRate: calcTax.taxRate,\n                    tax: format.currency(calcTax.tax, this.order.currency.shortName),\n                })}`,\n            ).join('<br>')}`;\n\n            return `${this.$tc('sw-order.detailBase.tax')}<br>${formattedTaxes}`;\n        },\n\n        sortedCalculatedTaxes() {\n            return this.sortByTaxRate(cloneDeep(this.order.price.calculatedTaxes))\n                .filter(price => price.tax !== 0);\n        },\n\n        taxStatus() {\n            return this.order.price.taxStatus;\n        },\n\n        displayRounded() {\n            return this.order.totalRounding.interval !== 0.01\n                || this.order.totalRounding.decimals !== this.order.itemRounding.decimals;\n        },\n\n        orderTotal() {\n            if (this.displayRounded) {\n                return this.order.price.rawTotal;\n            }\n\n            return this.order.price.totalPrice;\n        },\n\n        currency() {\n            return this.order.currency;\n        },\n\n        currencyFilter() {\n            return Shopware.Filter.getByName('currency');\n        },\n    },\n\n    methods: {\n        sortByTaxRate(price) {\n            return price.sort((prev, current) => {\n                return prev.taxRate - current.taxRate;\n            });\n        },\n\n        onShippingChargeEdited(amount) {\n            this.delivery.shippingCosts.unitPrice = amount;\n            this.delivery.shippingCosts.totalPrice = amount;\n            this.saveAndRecalculate();\n        },\n\n        saveAndRecalculate() {\n            this.$emit('save-and-recalculate');\n        },\n\n        onSaveEdits() {\n            this.$emit('save-edits');\n        },\n\n        recalculateAndReload() {\n            this.$emit('recalculate-and-reload');\n        },\n    },\n};\n","export default \"\\n{% block sw_order_detail_general %}\\n<div class=\\\"sw-order-detail-general\\\">\\n    \\n    {% block sw_order_detail_general_info_card %}\\n    <sw-card\\n        class=\\\"sw-order-detail-base__general-info\\\"\\n        position-identifier=\\\"sw-order-detail-general-info\\\"\\n        :title=\\\"$tc('sw-order.detailBase.cardTitleGeneralInfo')\\\"\\n    >\\n        \\n        {% block sw_order_detail_general_info %}\\n        <sw-order-general-info\\n            ref=\\\"swOrderGeneralInfo\\\"\\n            :order=\\\"order\\\"\\n            @save-edits=\\\"onSaveEdits\\\"\\n        />\\n        {% endblock %}\\n    </sw-card>\\n    {% endblock %}\\n\\n    \\n    {% block sw_order_detail_general_line_items_card %}\\n    <sw-extension-component-section\\n        position-identifier=\\\"sw-order-detail-base-line-items__before\\\"\\n    />\\n\\n    <sw-card\\n        class=\\\"sw-order-detail-general__line-item-grid-card\\\"\\n        position-identifier=\\\"sw-order-detail-general-line-items\\\"\\n        :title=\\\"$tc('sw-order.detailBase.cardTitleLineItems')\\\"\\n    >\\n\\n        \\n        {% block sw_order_detail_general_line_items_card_rows %}\\n        <template #grid>\\n            <sw-container type=\\\"row\\\">\\n                \\n                {% block sw_order_detail_general_line_items_grid %}\\n                <sw-order-line-items-grid\\n                    ref=\\\"sw-order-line-item-grid\\\"\\n                    :order=\\\"order\\\"\\n                    :context=\\\"versionContext\\\"\\n                    :editable=\\\"acl.can('order.editor')\\\"\\n                    @item-delete=\\\"recalculateAndReload\\\"\\n                    @item-edit=\\\"recalculateAndReload\\\"\\n                    @existing-item-edit=\\\"saveAndRecalculate\\\"\\n                    @item-cancel=\\\"recalculateAndReload\\\"\\n                />\\n                {% endblock %}\\n\\n                \\n                {% block sw_order_detail_general_line_items_summary %}\\n                <sw-card-section\\n                    divider=\\\"top\\\"\\n                    slim\\n                >\\n                    <sw-description-list\\n                        class=\\\"sw-order-detail__summary\\\"\\n                        grid=\\\"1fr 1fr\\\"\\n                    >\\n\\n                        \\n                        {% block sw_order_detail_general_line_items_summary_entries %}\\n                        \\n                        {% block sw_order_detail_general_line_items_summary_amount %}\\n                        <dt>{{ $tc('sw-order.detailBase.summaryLabelAmount') }}</dt>\\n                        <dd>{{ currencyFilter(order.positionPrice, currency.translated.shortName, order.totalRounding.decimals) }}</dd>\\n                        {% endblock %}\\n\\n                        \\n                        {% block sw_order_detail_general_line_items_summary_shipping_cost %}\\n                        <template v-if=\\\"delivery\\\">\\n                            <dt>{{ $tc('sw-order.detailBase.summaryLabelShippingCosts') }}</dt>\\n                            <dd>\\n                                <sw-order-saveable-field\\n                                    v-tooltip=\\\"{\\n                                        showDelay: 300,\\n                                        message: shippingCostsDetail,\\n                                        disabled: taxStatus === 'tax-free'\\n                                    }\\\"\\n                                    type=\\\"number\\\"\\n                                    :editable=\\\"acl.can('order.editor')\\\"\\n                                    :value=\\\"delivery.shippingCosts.totalPrice\\\"\\n                                    @value-change=\\\"onShippingChargeEdited\\\"\\n                                >\\n                                    {{ currencyFilter(delivery.shippingCosts.totalPrice, currency.translated.shortName, order.totalRounding.decimals) }}\\n                                </sw-order-saveable-field>\\n                            </dd>\\n                        </template>\\n\\n                        <template\\n                            v-for=\\\"(delivery, index) in deliveryDiscounts\\\"\\n                            {% if VUE3 %}\\n                            :key=\\\"index\\\"\\n                            {% endif %}\\n                        >\\n                            <dt\\n                                {% if VUE2 %}\\n                                :key=\\\"`delivery-discount-dt-${index}`\\\"\\n                                {% endif %}\\n                            >\\n                                {{ $tc('sw-order.detailBase.discountLabelShippingCosts') }}\\n                            </dt>\\n                            <dd\\n                                {% if VUE2 %}\\n                                :key=\\\"`delivery-discount-dd-${index}`\\\"\\n                                {% endif %}\\n                            >\\n                                {{ currencyFilter(delivery.shippingCosts.totalPrice, currency.translated.shortName, order.totalRounding.decimals) }}\\n                            </dd>\\n                        </template>\\n                        {% endblock %}\\n\\n                        \\n                        {% block sw_order_detail_general_line_items_summary_amount_without_tax %}\\n                        <template v-if=\\\"taxStatus !== 'tax-free'\\\">\\n                            <dt><strong>{{ $tc('sw-order.detailBase.summaryLabelAmountWithoutTaxes') }}</strong></dt>\\n                            <dd><strong>{{ currencyFilter(order.amountNet, currency.translated.shortName, order.totalRounding.decimals) }}</strong></dd>\\n                        </template>\\n                        {% endblock %}\\n\\n                        \\n                        {% block sw_order_detail_general_line_items_summary_taxes %}\\n                        <template v-if=\\\"taxStatus !== 'tax-free'\\\">\\n                            <template\\n                                v-for=\\\"(calculatedTax, index) in sortedCalculatedTaxes\\\"\\n                                {% if VUE3 %}\\n                                :key=\\\"index\\\"\\n                                {% endif %}\\n                            >\\n                                <dt\\n                                    {% if VUE2 %}\\n                                    :key=\\\"`sorted-calculated-taxes-dt-${index}`\\\"\\n                                    {% endif %}\\n                                >\\n                                    {{ $tc('sw-order.detailBase.summaryLabelTaxes', 1, { taxRate: calculatedTax.taxRate }) }}\\n                                </dt>\\n                                <dd\\n                                    {% if VUE2 %}\\n                                    :key=\\\"`sorted-calculated-taxes-dd-${index}`\\\"\\n                                    {% endif %}\\n                                >\\n                                    {{ currencyFilter(calculatedTax.tax, currency.translated.shortName, order.totalRounding.decimals) }}\\n                                </dd>\\n                            </template>\\n                        </template>\\n                        {% endblock %}\\n\\n                        \\n                        {% block sw_order_detail_general_line_items_summary_amount_total %}\\n                        <template v-if=\\\"taxStatus !== 'tax-free'\\\">\\n                            <dt><strong>{{ $tc('sw-order.detailBase.summaryLabelAmountTotal') }}</strong></dt>\\n                            <dd><strong>{{ currencyFilter(orderTotal, currency.shortName, order.totalRounding.decimals) }}</strong></dd>\\n                            <template v-if=\\\"displayRounded\\\">\\n                                <dt><strong>{{ $tc('sw-order.detailBase.summaryLabelAmountTotalRounded') }}</strong></dt>\\n                                <dd><strong>{{ currencyFilter(order.price.totalPrice, currency.shortName, order.totalRounding.decimals) }}</strong></dd>\\n                            </template>\\n                        </template>\\n                        {% endblock %}\\n\\n                        \\n                        {% block sw_order_detail_general_line_items_summary_amount_free_tax %}\\n                        <template v-if=\\\"taxStatus === 'tax-free'\\\">\\n                            <dt><strong>{{ $tc('sw-order.detailBase.summaryLabelAmount') }}</strong></dt>\\n                            <dd><strong>{{ currencyFilter(order.price.totalPrice, currency.translated.shortName, order.totalRounding.decimals) }}</strong></dd>\\n                        </template>\\n                        {% endblock %}\\n                    {% endblock %}\\n                    </sw-description-list>\\n                </sw-card-section>\\n                {% endblock %}\\n            </sw-container>\\n        </template>\\n        {% endblock %}\\n    </sw-card>\\n\\n    <sw-extension-component-section\\n        position-identifier=\\\"sw-order-detail-base-line-items__after\\\"\\n    />\\n    {% endblock %}\\n</div>\\n{% endblock %}\\n\";"],"sourceRoot":""}