{"version":3,"sources":["webpack:///./src/module/sw-promotion-v2/component/promotion-codes/sw-promotion-v2-generate-codes-modal/index.js","webpack:///./src/module/sw-promotion-v2/component/promotion-codes/sw-promotion-v2-generate-codes-modal/sw-promotion-v2-generate-codes-modal.html.twig","webpack:///./src/module/sw-promotion-v2/component/promotion-codes/sw-promotion-v2-generate-codes-modal/sw-promotion-v2-generate-codes-modal.scss"],"names":["debounce","Shopware","Utils","template","inject","mixins","props","promotion","type","Object","required","data","isGenerating","customPatternMode","codeAmount","preview","pattern","prefix","suffix","codeLength","watch","deep","handler","this","updatePattern","updatePreview","created","createdComponent","methods","currentPattern","individualCodePattern","length","groups","_wrapRegExp","replacement","exec","includes","_objectSpread","characters","Array","Number","join","concat","_this2","promotionCodeApiService","generatePreview","then","result","onGenerate","_this3","replaceIndividualCodes","id","$emit","catch","e","response","errors","forEach","error","errorType","code","createNotificationError","autoClose","message","$tc","onClose","content","__esModule","default","module","i","locals","exports","add"],"mappings":"0xDAMA,IAAMA,EAAWC,SAASC,MAAMF,SAGjB,WACXG,SCVW,i/NDYXC,OAAQ,CACJ,2BAGJC,OAAQ,CACJ,gBAGJC,MAAO,CACHC,UAAW,CACPC,KAAMC,OACNC,UAAU,IAIlBC,KAAI,WACA,MAAO,CACHC,cAAc,EACdC,mBAAmB,EACnBC,WAAY,GACZC,QAAS,GACTC,QAAS,CACLC,OAAQ,GACRC,OAAQ,GACRC,WAAY,KAKxBC,MAAO,CACHJ,QAAS,CACLK,MAAM,EACNC,QAAO,WACEC,KAAKV,mBACNU,KAAKC,gBAGTD,KAAKE,kBAIb,kCAAiC,WAC7BF,KAAKE,iBAGTZ,kBAAiB,WACRU,KAAKV,mBACNU,KAAKC,gBAGTD,KAAKE,kBAIbC,QAAO,WACHH,KAAKI,oBAGTC,QAAS,CACLD,iBAAgB,WACZ,IAAME,EAAiBN,KAAKhB,UAAUuB,sBAEtC,IAAKD,IAAmBA,EAAeE,OAAS,EAC5CR,KAAKP,QAAU,CACXC,OAAQ,GACRC,OAAQ,GACRC,WAAY,OAJpB,CAUA,IACMa,EADMC,EAAG,yBAAwD,CAAAhB,OAAA,EAAAiB,YAAA,EAAAhB,OAAA,IACjDiB,KAAKN,GAAgBG,OAG3CT,KAAKV,kBAAoBmB,EAAOE,YAAYE,SAAS,KAErDb,KAAKP,QAAOqB,IAAA,GACLL,GAAM,IACTb,WAAYa,EAAOE,YAAYH,OAAS,GAAK,IAGjDR,KAAKE,kBAGTD,cAAa,WACT,IAAMc,EAAaC,MAAMC,OAAOjB,KAAKP,QAAQG,YAAc,GAAGsB,KAAK,MACnElB,KAAKhB,UAAUuB,sBAAqB,GAAAY,OAAMnB,KAAKP,QAAQC,QAAMyB,OAAGJ,GAAUI,OAAGnB,KAAKP,QAAQE,SAG9FO,cAAezB,GAAS,WAA0B,IAAD2C,EAAA,KAC7CpB,KAAKX,cAAe,EACpBW,KAAKqB,wBAAwBC,gBAAgBtB,KAAKhB,UAAUuB,uBAAuBgB,MAAK,SAACC,GACrFJ,EAAK/B,cAAe,EACpB+B,EAAK5B,QAAUgC,OAEpB,KAEHC,WAAU,WAAI,IAADC,EAAA,KACT1B,KAAKX,cAAe,EACpBW,KAAKqB,wBAAwBM,uBACzB3B,KAAKhB,UAAU4C,GACf5B,KAAKhB,UAAUuB,sBACfP,KAAKT,YACPgC,MAAK,WACHG,EAAKrC,cAAe,EACpBqC,EAAKG,MAAM,sBACZC,OAAM,SAACC,GACNL,EAAKrC,cAAe,EACpB0C,EAAEC,SAAS5C,KAAK6C,OAAOC,SAAQ,SAACC,GAC5B,IAAIC,EACJ,OAAQD,EAAME,MACV,IAAK,6DACDD,EAAY,4BACZ,MACJ,IAAK,qDACDA,EAAY,wBACZ,MACJ,QACIA,EAAY,mBAIpBV,EAAKY,wBAAwB,CACzBC,WAAW,EACXC,QAASd,EAAKe,IAAI,8DAADtB,OACiDiB,aAOlFM,QAAO,WACH1C,KAAK6B,MAAM,a,4CEhJvB,IAAIc,EAAU,EAAQ,QACnBA,EAAQC,aAAYD,EAAUA,EAAQE,SACnB,iBAAZF,IAAsBA,EAAU,CAAC,CAACG,EAAOC,EAAIJ,EAAS,MAC7DA,EAAQK,SAAQF,EAAOG,QAAUN,EAAQK,SAG/BE,EADH,EAAQ,QAA2EL,SAC5E,WAAYF,GAAS,EAAM","file":"static/js/50c29043f81307d0c227.js","sourcesContent":["/**\n * @package buyers-experience\n */\nimport template from './sw-promotion-v2-generate-codes-modal.html.twig';\nimport './sw-promotion-v2-generate-codes-modal.scss';\n\nconst debounce = Shopware.Utils.debounce;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: [\n        'promotionCodeApiService',\n    ],\n\n    mixins: [\n        'notification',\n    ],\n\n    props: {\n        promotion: {\n            type: Object,\n            required: true,\n        },\n    },\n\n    data() {\n        return {\n            isGenerating: false,\n            customPatternMode: false,\n            codeAmount: 10,\n            preview: '',\n            pattern: {\n                prefix: '',\n                suffix: '',\n                codeLength: 5,\n            },\n        };\n    },\n\n    watch: {\n        pattern: {\n            deep: true,\n            handler() {\n                if (!this.customPatternMode) {\n                    this.updatePattern();\n                }\n\n                this.updatePreview();\n            },\n        },\n\n        'promotion.individualCodePattern'() {\n            this.updatePreview();\n        },\n\n        customPatternMode() {\n            if (!this.customPatternMode) {\n                this.updatePattern();\n            }\n\n            this.updatePreview();\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            const currentPattern = this.promotion.individualCodePattern;\n\n            if (!currentPattern || !currentPattern.length > 0) {\n                this.pattern = {\n                    prefix: '',\n                    suffix: '',\n                    codeLength: 5,\n                };\n\n                return;\n            }\n\n            const regexp = /(?<prefix>[^%]*)(?<replacement>(%[sd])+)(?<suffix>.*)/g;\n            const groups = regexp.exec(currentPattern).groups;\n\n            // The saved pattern is NOT custom, if it only consists of multiple \"%s\"\n            this.customPatternMode = groups.replacement.includes('d');\n\n            this.pattern = {\n                ...groups,\n                codeLength: groups.replacement.length / 2 || 1,\n            };\n\n            this.updatePreview();\n        },\n\n        updatePattern() {\n            const characters = Array(Number(this.pattern.codeLength) + 1).join('%s');\n            this.promotion.individualCodePattern = `${this.pattern.prefix}${characters}${this.pattern.suffix}`;\n        },\n\n        updatePreview: debounce(function updatePreview() {\n            this.isGenerating = true;\n            this.promotionCodeApiService.generatePreview(this.promotion.individualCodePattern).then((result) => {\n                this.isGenerating = false;\n                this.preview = result;\n            });\n        }, 500),\n\n        onGenerate() {\n            this.isGenerating = true;\n            this.promotionCodeApiService.replaceIndividualCodes(\n                this.promotion.id,\n                this.promotion.individualCodePattern,\n                this.codeAmount,\n            ).then(() => {\n                this.isGenerating = false;\n                this.$emit('generate-finish');\n            }).catch((e) => {\n                this.isGenerating = false;\n                e.response.data.errors.forEach((error) => {\n                    let errorType;\n                    switch (error.code) {\n                        case 'PROMOTION__INDIVIDUAL_CODES_PATTERN_INSUFFICIENTLY_COMPLEX':\n                            errorType = 'notComplexEnoughException';\n                            break;\n                        case 'PROMOTION__INDIVIDUAL_CODES_PATTERN_ALREADY_IN_USE':\n                            errorType = 'alreadyInUseException';\n                            break;\n                        default:\n                            errorType = 'unknownErrorCode';\n                            break;\n                    }\n\n                    this.createNotificationError({\n                        autoClose: false,\n                        message: this.$tc(\n                            `sw-promotion-v2.detail.base.codes.individual.generateModal.${errorType}`,\n                        ),\n                    });\n                });\n            });\n        },\n\n        onClose() {\n            this.$emit('close');\n        },\n    },\n};\n","export default \"\\n{% block sw_promotion_v2_generate_codes_modal %}\\n<sw-modal\\n    class=\\\"sw-promotion-v2-generate-codes-modal\\\"\\n    :title=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.title')\\\"\\n    @modal-close=\\\"onClose\\\"\\n>\\n\\n    \\n    {% block sw_promotion_v2_generate_codes_modal_content %}\\n    <div class=\\\"sw-promotion-v2-generate-codes-modal__content\\\">\\n\\n        \\n        {% block sw_promotion_v2_generate_codes_modal_warning %}\\n        <sw-alert\\n            v-if=\\\"promotion.individualCodes && promotion.individualCodes.length > 0\\\"\\n            class=\\\"sw-promotion-v2-generate-codes-modal__warning\\\"\\n            variant=\\\"warning\\\"\\n        >\\n            {{ $tc('sw-promotion-v2.detail.base.codes.individual.generateModal.warning') }}\\n        </sw-alert>\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_generate_codes_modal_description %}\\n        <p class=\\\"sw-promotion-v2-generate-codes-modal__description\\\">\\n            {{ $tc('sw-promotion-v2.detail.base.codes.individual.generateModal.description') }}\\n        </p>\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_generate_codes_modal_container_pattern %}\\n        \\n        {% block sw_promotion_v2_generate_codes_modal_container_pattern_simple %}\\n        <sw-container\\n            v-if=\\\"!customPatternMode\\\"\\n            class=\\\"sw-promotion-v2-generate-codes-modal__container-pattern\\\"\\n            columns=\\\"1fr 1fr 1fr\\\"\\n            gap=\\\"0px 32px\\\"\\n        >\\n\\n            \\n            {% block sw_promotion_v2_generate_codes_modal_prefix %}\\n            <sw-text-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"pattern.prefix\\\"\\n                {% else %}\\n                v-model=\\\"pattern.prefix\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-generate-codes-modal__prefix\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.labelPrefix')\\\"\\n                :placeholder=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.placeholderPrefix')\\\"\\n            />\\n            {% endblock %}\\n\\n            \\n            {% block sw_promotion_v2_generate_codes_modal_replacement %}\\n            <sw-number-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"pattern.codeLength\\\"\\n                {% else %}\\n                v-model=\\\"pattern.codeLength\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-generate-codes-modal__replacement\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.labelCodeLength')\\\"\\n                :min=\\\"1\\\"\\n                :max=\\\"20\\\"\\n            />\\n            {% endblock %}\\n\\n            \\n            {% block sw_promotion_v2_generate_codes_modal_suffix %}\\n            <sw-text-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"pattern.suffix\\\"\\n                {% else %}\\n                v-model=\\\"pattern.suffix\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-generate-codes-modal__suffix\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.labelSuffix')\\\"\\n                :placeholder=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.placeholderSuffix')\\\"\\n            />\\n            {% endblock %}\\n\\n        </sw-container>\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_generate_codes_modal_container_pattern_custom %}\\n        <sw-text-field\\n            v-else\\n            {% if VUE3 %}\\n            v-model:value=\\\"promotion.individualCodePattern\\\"\\n            {% else %}\\n            v-model=\\\"promotion.individualCodePattern\\\"\\n            {% endif %}\\n            class=\\\"sw-promotion-v2-generate-codes-modal__custom-pattern\\\"\\n            :label=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.labelCustomPattern')\\\"\\n            :placeholder=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.placeholderCustomPattern')\\\"\\n            :help-text=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.helpTextCustomPattern')\\\"\\n        />\\n        {% endblock %}\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_generate_codes_modal_custom_pattern_switch %}\\n        <sw-switch-field\\n            {% if VUE3 %}\\n            v-model:value=\\\"customPatternMode\\\"\\n            {% else %}\\n            v-model=\\\"customPatternMode\\\"\\n            {% endif %}\\n            class=\\\"sw-promotion-v2-generate-codes-modal__custom-pattern\\\"\\n            :label=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.labelUseCustomPattern')\\\"\\n            bordered\\n        />\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_generate_codes_modal_container_generate %}\\n        <sw-container\\n            class=\\\"sw-promotion-v2-generate-codes-modal__container-generate\\\"\\n            columns=\\\"1fr 1fr\\\"\\n            gap=\\\"0px 32px\\\"\\n        >\\n\\n            \\n            {% block sw_promotion_v2_generate_codes_modal_preview %}\\n            <sw-text-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"preview\\\"\\n                {% else %}\\n                v-model=\\\"preview\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-generate-codes-modal__preview\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.labelPreview')\\\"\\n                disabled\\n            />\\n            {% endblock %}\\n\\n            \\n            {% block sw_promotion_v2_generate_codes_modal_code_amount %}\\n            <sw-number-field\\n                {% if VUE3 %}\\n                v-model:value=\\\"codeAmount\\\"\\n                {% else %}\\n                v-model=\\\"codeAmount\\\"\\n                {% endif %}\\n                class=\\\"sw-promotion-v2-generate-codes-modal__code-amount\\\"\\n                :label=\\\"$tc('sw-promotion-v2.detail.base.codes.individual.generateModal.labelCodeAmount')\\\"\\n                :min=\\\"1\\\"\\n            />\\n            {% endblock %}\\n\\n        </sw-container>\\n        {% endblock %}\\n\\n    </div>\\n    {% endblock %}\\n\\n    \\n    {% block sw_promotion_v2_generate_codes_modal_footer %}\\n    <template #modal-footer>\\n\\n        \\n        {% block sw_promotion_v2_generate_codes_modal_cancel %}\\n        <sw-button\\n            class=\\\"sw-promotion-v2-generate-codes-modal__button-cancel\\\"\\n            size=\\\"small\\\"\\n            @click=\\\"onClose\\\"\\n        >\\n            {{ $tc('global.default.cancel') }}\\n        </sw-button>\\n        {% endblock %}\\n\\n        \\n        {% block sw_promotion_v2_generate_codes_modal_generate %}\\n        <sw-button-process\\n            class=\\\"sw-promotion-v2-generate-codes-modal__button-generate\\\"\\n            variant=\\\"primary\\\"\\n            size=\\\"small\\\"\\n            :is-loading=\\\"isGenerating\\\"\\n            :process-success=\\\"false\\\"\\n            @click=\\\"onGenerate\\\"\\n        >\\n            {{ $tc('sw-promotion-v2.detail.base.codes.individual.generateModal.buttonGenerate') }}\\n        </sw-button-process>\\n        {% endblock %}\\n\\n    </template>\\n    {% endblock %}\\n</sw-modal>\\n{% endblock %}\\n\";","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-promotion-v2-generate-codes-modal.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"63646003\", content, true, {});"],"sourceRoot":""}