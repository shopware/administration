{"version":3,"sources":["webpack:///./src/module/sw-extension/page/sw-extension-app-module-page/sw-extension-app-module-page.scss","webpack:///./src/module/sw-extension/page/sw-extension-app-module-page/sw-extension-app-module-page.html.twig","webpack:///./src/module/sw-extension/page/sw-extension-app-module-page/index.ts"],"names":["content","__esModule","default","module","i","locals","exports","add","_Shopware","Shopware","State","Context","Component","wrapComponentConfig","template","inject","props","appName","type","String","required","moduleName","data","appLoaded","timedOut","timedOutTimeout","computed","currentLocale","get","fallbackLocale","app","appDefinition","_State$get$apps$find","_this","apps","find","name","moduleDefinition","_this$appDefinition$m2","_this$appDefinition$m","_this2","this","modules","mainModule","suspend","heading","appLabel","translate","label","filter","part","join","entryPoint","_this$moduleDefinitio","_this$moduleDefinitio2","source","origin","URL","e","loadedMessage","watch","immediate","handler","loaded","_this3","clearTimeout","window","setTimeout","mounted","addEventListener","onContentLoaded","beforeDestroy","removeEventListener","created","createdComponent","methods","acl","can","concat","$router","push","labels","event"],"mappings":"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","file":"static/js/07853165f7168db46c23.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-extension-app-module-page.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"05638867\", content, true, {});","export default \"<sw-page class=\\\"sw-extension-app-module-page\\\">\\n    <template\\n        v-if=\\\"!suspend\\\"\\n        #smart-bar-header\\n    >\\n        <h2>{{ heading }}</h2>\\n    </template>\\n\\n    <template #content>\\n        <template v-if=\\\"!suspend\\\">\\n            <iframe\\n                v-show=\\\"appLoaded\\\"\\n                id=\\\"app-content\\\"\\n                class=\\\"sw-extension-app-module-page__app-content\\\"\\n                referrerpolicy=\\\"origin-when-cross-origin\\\"\\n                :src=\\\"entryPoint\\\"\\n                :title=\\\"heading\\\"\\n            ></iframe>\\n\\n            <template v-if=\\\"!appLoaded\\\">\\n                <template v-if=\\\"timedOut\\\">\\n                    <sw-extension-app-module-error-page />\\n                </template>\\n\\n                <template v-else>\\n                    <sw-loader />\\n                </template>\\n            </template>\\n        </template>\\n    </template>\\n</sw-page>\\n\";","import type { AppModuleDefinition } from 'src/core/service/api/app-modules.service';\nimport template from './sw-extension-app-module-page.html.twig';\nimport './sw-extension-app-module-page.scss';\n\nconst { State, Context } = Shopware;\n\n/**\n * @package services-settings\n * @private\n */\nexport default Shopware.Component.wrapComponentConfig({\n    template,\n\n    inject: ['acl'],\n\n    props: {\n        appName: {\n            type: String,\n            required: true,\n        },\n\n        moduleName: {\n            type: String,\n            required: false,\n            default: null,\n        },\n    },\n\n    data(): { appLoaded: boolean, timedOut: boolean, timedOutTimeout: null|number } {\n        return {\n            appLoaded: false,\n            timedOut: false,\n            timedOutTimeout: null,\n        };\n    },\n\n    computed: {\n        currentLocale(): string|null {\n            return State.get('session').currentLocale;\n        },\n\n        fallbackLocale(): string|null {\n            return Context.app.fallbackLocale;\n        },\n\n        appDefinition(): AppModuleDefinition|null {\n            return State.get('shopwareApps').apps.find((app) => {\n                return app.name === this.appName;\n            }) ?? null;\n        },\n\n        moduleDefinition(): Partial<{ source: string, label: {[key: string]: string} }>|null {\n            if (!this.appDefinition) {\n                return null;\n            }\n\n            if (!this.moduleName) {\n                return this.appDefinition.mainModule ?? null;\n            }\n\n            return this.appDefinition.modules.find((module) => {\n                return module.name === this.moduleName;\n            }) ?? null;\n        },\n\n        suspend(): boolean {\n            return !this.appDefinition || !this.moduleDefinition;\n        },\n\n        heading(): string|null {\n            if (!this.appDefinition) {\n                return null;\n            }\n\n            const appLabel = this.translate(this.appDefinition.label);\n\n            if (!this.moduleDefinition || !this.moduleDefinition.label) {\n                return appLabel;\n            }\n\n            const moduleLabel = this.translate(this.moduleDefinition.label);\n\n            return [appLabel, moduleLabel]\n                .filter((part) => !!part)\n                .join(' - ');\n        },\n\n        entryPoint(): string|null {\n            if (this.suspend) {\n                return null;\n            }\n\n            return this.moduleDefinition?.source ?? null;\n        },\n\n        origin(): string|null {\n            if (!this.entryPoint) {\n                return null;\n            }\n\n            try {\n                const url = new URL(this.entryPoint);\n                return url.origin;\n            } catch (e) {\n                return null;\n            }\n        },\n\n        loadedMessage(): 'sw-app-loaded' {\n            return 'sw-app-loaded';\n        },\n    },\n\n    watch: {\n        entryPoint(): void {\n            this.appLoaded = false;\n            this.timedOut = false;\n        },\n\n        appLoaded: {\n            immediate: true,\n            handler(loaded) {\n                if (this.timedOutTimeout !== null) {\n                    clearTimeout(this.timedOutTimeout);\n                }\n\n                this.timedOutTimeout = null;\n\n                if (!loaded) {\n                    this.timedOutTimeout = window.setTimeout(() => {\n                        if (!this.appLoaded) {\n                            this.timedOut = true;\n                        }\n                    }, 5000);\n                }\n            },\n        },\n    },\n\n    mounted() {\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        window.addEventListener('message', this.onContentLoaded);\n    },\n\n    beforeDestroy() {\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        window.removeEventListener('message', this.onContentLoaded);\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            if (!this.acl.can(`app.${this.appName}`)) {\n                // ignore promise from push because this page should be destroyed after the url change\n                void this.$router.push({ name: 'sw.privilege.error.index' });\n            }\n        },\n\n        translate(labels : {[key:string]: string}): string|null {\n            if (this.currentLocale && labels[this.currentLocale]) {\n                return labels[this.currentLocale];\n            }\n\n            if (this.fallbackLocale && labels[this.fallbackLocale]) {\n                return labels[this.fallbackLocale];\n            }\n\n            return null;\n        },\n\n        onContentLoaded(event: MessageEvent): void {\n            if (event.origin !== this.origin) {\n                return;\n            }\n\n            if (event.data === this.loadedMessage) {\n                this.appLoaded = true;\n            }\n        },\n    },\n});\n"],"sourceRoot":""}