(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[38],{"/GKh":function(e,t,n){var i=n("V88h");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n("ydqr").default)("ba15e488",i,!0,{})},V88h:function(e,t,n){},ZfeT:function(e,t,n){"use strict";n.r(t);var i=n("HZZ/"),o=n.n(i),a=n("QGb3"),r=n.n(a),d=n("hJxD"),s=n.n(d),u=(n("/GKh"),Shopware),l=u.Mixin,c=u.Context,m=Shopware.Utils;t.default={template:'\n{% block sw_media_list_selection_v2 %}\n<div class="sw-media-list-selection-v2">\n\n    \n    {% block sw_media_list_selection_v2_upload %}\n    <sw-upload-listener\n        :upload-tag="uploadId"\n        @media-upload-add="onUploadsAdded"\n        @media-upload-finish="successfulUpload"\n        @media-upload-fail="onUploadFailed"\n    />\n\n    <sw-media-upload-v2\n        :upload-tag="uploadId"\n        variant="regular"\n        :default-folder="defaultFolderName"\n        @media-upload-sidebar-open="onMediaUploadButtonOpenSidebar"\n    />\n    {% endblock %}\n\n    \n    {% block sw_media_list_selection_v2_grid %}\n    <div\n        ref="grid"\n        class="sw-media-list-selection-v2__grid"\n        :style="gridAutoRows"\n    >\n        <sw-loader v-if="entity.isLoading" />\n        {%  block sw_media_list_selection_v2_grid_items %}\n        <sw-media-list-selection-item-v2\n            v-for="(mediaItem, i) in mediaItems"\n            :key="i"\n            v-draggable="{ dragGroup: \'media-items\', data: mediaItem, onDragEnter: onDeboundDragDrop }"\n            v-droppable="{ dragGroup: \'media-items\', data: mediaItem }"\n            :item="mediaItem"\n            @item-remove="removeItem(mediaItem, i)"\n        />\n        {% endblock %}\n    </div>\n    {% endblock %}\n</div>\n{% endblock %}\n',inject:["repositoryFactory","mediaService"],mixins:[l.getByName("notification")],props:{entity:{type:Object,required:!0},entityMediaItems:{type:Array,required:!0},uploadTag:{type:String,required:!1,default:null},defaultFolderName:{type:String,required:!1,default:null}},data:function(){return{columnCount:8,columnWidth:"90px"}},computed:{mediaRepository:function(){return this.repositoryFactory.create("media")},currentCount:function(){return this.entityMediaItems.length},mediaItems:function(){var e=2*this.columnCount;if(this.currentCount>=e)return this.entityMediaItems;var t=r()(this.entityMediaItems);return t.splice.apply(t,[this.currentCount,0].concat(r()(this.createPlaceholders(e-this.currentCount)))),t.forEach((function(e,t){e.position=t})),t},gridAutoRows:function(){return"grid-auto-rows: ".concat(this.columnWidth)},uploadId:function(){return this.uploadTag||this.entity.id},defaultFolder:function(){return this.defaultFolderName||this.entity.getEntityName()}},mounted:function(){this.mountedComponent()},methods:{mountedComponent:function(){this.$device.onResize({listener:this.updateColumnCount,component:this}),this.updateColumnCount()},updateColumnCount:function(){var e=this;this.$nextTick((function(){var t=window.getComputedStyle(e.$refs.grid,null).getPropertyValue("grid-template-columns").split(" ");e.columnCount=t.length,e.columnWidth=t[0]}))},createPlaceholders:function(e){return new Array(e).fill({isPlaceholder:!0,media:{isPlaceholder:!0,name:""},mediaId:this.currentCount})},onUploadsAdded:function(e){var t=this;return o()(s.a.mark((function n(){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==e.data.length){n.next=3;break}return n.abrupt("return");case 3:return t.entity.isLoading=!0,n.next=6,t.mediaService.runUploads(t.uploadId);case 6:t.entity.isLoading=!1;case 7:case"end":return n.stop()}}),n)})))()},onMediaUploadButtonOpenSidebar:function(){this.$emit("open-sidebar")},successfulUpload:function(e){var t=this;return o()(s.a.mark((function n(){var i,o;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.targetId,n.next=3,t.mediaRepository.get(i,c.api);case 3:o=n.sent,t.$forceUpdate(),t.$emit("upload-finish",o);case 6:case"end":return n.stop()}}),n)})))()},onUploadFailed:function(e){var t=this.mediaItems.find((function(t){return t.mediaId===e.targetId}));t&&this.removeItem(t),this.entity.isLoading=!1},onMediaItemDragSort:function(e,t,n){!0!==n||t.position>this.currentCount||e.position>this.currentCount||this.$emit("item-sort",e,t)},onDeboundDragDrop:m.debounce((function(e,t,n){this.onMediaItemDragSort(e,t,n)}),500),removeItem:function(e,t){this.$emit("item-remove",e,t)}}}}}]);