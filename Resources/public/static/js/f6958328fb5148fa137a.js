(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[490],{PrqG:function(e,s,n){var t=n("VGUZ");t.__esModule&&(t=t.default),"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);(0,n("P8hj").default)("0e1543ac",t,!0,{})},VGUZ:function(e,s,n){},Y67s:function(e,s,n){"use strict";n.r(s);var t=n("CsSd"),r=n.n(t),i=n("7yzw"),o=n.n(i),a=n("92Mt"),l=n.n(a);n("PrqG");function c(e,s){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);s&&(t=t.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),n.push.apply(n,t)}return n}function u(e){for(var s=1;s<arguments.length;s++){var n=null!=arguments[s]?arguments[s]:{};s%2?c(Object(n),!0).forEach((function(s){r()(e,s,n[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))}))}return e}var m=Shopware,d=m.Data,p=m.Mixin,_=m.State,w=d.Criteria;s.default={template:'\n{% block sw_settings_user_list %}\n<sw-card\n    class="sw-users-permissions-user-listing sw-settings-user-list"\n    position-identifier="sw-users-permissions-user-listing"\n    :title="$tc(\'sw-users-permissions.users.general.cardLabel\')"\n>\n\n    <div class="sw-users-permissions-user-listing__toolbar">\n        <sw-container\n            columns="1fr minmax(100px, 200px)"\n            gap="0 10px"\n        >\n            \n            {% block sw_settings_user_list_smart_bar_actions %}\n            \n            {% block sw_settings_user_list_search_bar %}\n            <sw-simple-search-field\n                v-model="term"\n                size="small"\n                variant="form"\n                @search-term-change="onSearch"\n            />\n            {% endblock %}\n\n            \n            {% block sw_settings_user_list_actions_create_user %}\n            <sw-button\n                :router-link="{ name: \'sw.users.permissions.user.create\' }"\n                variant="ghost"\n                size="small"\n                :disabled="!acl.can(\'users_and_permissions.creator\')"\n                class="sw-users-permissions-user-listing__add-user-button"\n            >\n                {{ $tc(\'sw-users-permissions.users.general.labelCreateNewUser\') }}\n            </sw-button>\n            {% endblock %}\n            {% endblock %}\n        </sw-container>\n    </div>\n\n    \n    {% block sw_settings_user_list_content %}\n    \n    {% block sw_settings_user_list_content_grid %}\n    <sw-data-grid\n        :data-source="user"\n        :columns="userColumns"\n        identifier="user-grid"\n        :show-settings="true"\n        :show-selection="false"\n        :is-loading="isLoading"\n        @column-sort="onSortColumn"\n    >\n\n        \n        {% block sw_settings_user_list_content_grid_actions %}\n        <template #actions="{ item }">\n            \n            {% block sw_settings_user_list_actions_edit %}\n            <sw-context-menu-item\n                class="sw-settings-user-list__user-view-action"\n                :disabled="!acl.can(\'users_and_permissions.editor\')"\n                :router-link="{ name: \'sw.users.permissions.user.detail\', params: { id: item.id } }"\n            >\n                {{ $tc(\'sw-users-permissions.users.user-grid.contextMenuEdit\') }}\n            </sw-context-menu-item>\n            {% endblock %}\n\n            \n            {% block sw_settings_user_list_actions_delete %}\n            <sw-context-menu-item\n                class="sw-settings-user-list__user-delete-action"\n                variant="danger"\n                :disabled="!acl.can(\'users_and_permissions.deleter\')"\n                @click="onDelete(item)"\n            >\n                {{ $tc(\'sw-users-permissions.users.user-grid.contextMenuDelete\') }}\n            </sw-context-menu-item>\n            {% endblock %}\n        </template>\n        {% endblock %}\n\n        \n        {% block sw_settings_user_list_column_username_preview %}\n        <template #preview-username="{ item, compact }">\n            <sw-avatar\n                :size="compact ? \'32px\' : \'48px\'"\n                :first-name="item.firstName"\n                :last-name="item.lastName"\n                variant="square"\n                :source-context="item"\n            />\n        </template>\n        {% endblock %}\n\n        \n        {% block sw_settings_user_list_column_username %}\n        <template #column-username="{ item }">\n            \n            {% block sw_settings_user_list_column_username_content %}\n            <router-link\n                class="sw-settings-user-list__columns"\n                :to="{ name: \'sw.users.permissions.user.detail\', params: { id: item.id } }"\n            >\n                {{ item.username }}\n            </router-link>\n            {% endblock %}\n        </template>\n        {% endblock %}\n\n        \n        {% block sw_settings_user_list_column_username_acl_roles %}\n        <template #column-aclRoles="{ item, compact }">\n            <template v-if="item.aclRoles && item.aclRoles.length > 0">\n                <span\n                    v-for="(role, index) in item.aclRoles"\n                    :key="index"\n                >\n                    {{ role.name }}<template v-if="index + 1 < item.aclRoles.length">,&nbsp;</template>\n                </span>\n            </template>\n            <span v-else-if="item.admin">\n                {{ $tc(\'sw-users-permissions.users.user-detail.labelAdministrator\') }}\n            </span>\n            <span v-else></span>\n        </template>\n        {% endblock %}\n\n        <template #pagination>\n            \n            {% block sw_settings_user_list_grid_pagination %}\n            <sw-pagination\n                :page="page"\n                :limit="limit"\n                :total="total"\n                :auto-hide="true"\n                @page-change="onPageChange"\n            />\n            {% endblock %}\n        </template>\n\n        <template #action-modals="{ item }">\n            \n            {% block sw_settings_user_list_delete_modal %}\n            <sw-modal\n                v-if="getItemToDelete(item)"\n                :title="$tc(\'global.default.warning\')"\n                variant="small"\n                @modal-close="onCloseDeleteModal"\n            >\n                \n                {% block sw_settings_user_list_delete_modal_confirm_delete_text %}\n                <p class="sw-settings-user-list__confirm-delete-text">\n                    {{ $tc(\'sw-users-permissions.users.user-grid.textModalDelete\', 0, { name: salutation(item) }) }}\n                </p>\n                {% endblock %}\n\n                \n                {% block sw_settings_user_list_delete_modal_input__confirm_password %}\n                <sw-password-field\n                    {% if VUE3 %}\n                    v-model:value="confirmPassword"\n                    {% else %}\n                    v-model="confirmPassword"\n                    {% endif %}\n                    class="sw-settings-user-detail__confirm-password"\n                    required\n                    name="sw-field--confirm-password"\n                    :password-toggle-able="true"\n                    :copy-able="false"\n                    autocomplete="new-password"\n                    :label="$tc(\'sw-users-permissions.users.user-detail.passwordConfirmation.labelConfirmPassword\')"\n                    :placeholder="$tc(\'sw-users-permissions.users.user-detail.passwordConfirmation.placeholderConfirmPassword\')"\n                    @keypress.enter="onConfirmDelete(item)"\n                />\n                {% endblock %}\n\n                \n                {% block sw_settings_user_list_delete_modal_footer %}\n                <template #modal-footer>\n                    \n                    {% block sw_settings_user_list_delete_modal_cancel %}\n                    <sw-button\n                        size="small"\n                        @click="onCloseDeleteModal"\n                    >\n                        {{ $tc(\'sw-users-permissions.users.user-grid.labelButtonCancel\') }}\n                    </sw-button>\n                    {% endblock %}\n\n                    \n                    {% block sw_settings_user_list_delete_modal_confirm %}\n                    <sw-button\n                        :disabled="!confirmPassword"\n                        :is-loading="isConfirmingPassword"\n                        variant="danger"\n                        size="small"\n                        @click="onConfirmDelete(item)"\n                    >\n                        {{ $tc(\'sw-users-permissions.users.user-grid.labelButtonDelete\') }}\n                    </sw-button>\n                    {% endblock %}\n                </template>\n                {% endblock %}\n            </sw-modal>\n            {% endblock %}\n        </template>\n    </sw-data-grid>\n    {% endblock %}\n    {% endblock %}\n</sw-card>\n{% endblock %}\n',inject:["userService","loginService","repositoryFactory","acl"],mixins:[p.getByName("listing"),p.getByName("notification"),p.getByName("salutation")],data:function(){return{user:[],isLoading:!1,itemToDelete:null,disableRouteParams:!0,confirmPassword:"",sortBy:"username",isConfirmingPassword:!1}},metaInfo:function(){return{title:this.$createTitle()}},computed:{userRepository:function(){return this.repositoryFactory.create("user")},currentUser:{get:function(){return _.get("session").currentUser}},userCriteria:function(){var e=new w(this.page,this.limit);return this.term&&e.setTerm(this.term),this.sortBy&&e.addSorting(w.sort(this.sortBy,this.sortDirection||"ASC")),e.addAssociation("aclRoles"),e},userColumns:function(){return[{property:"username",label:this.$tc("sw-users-permissions.users.user-grid.labelUsername")},{property:"firstName",label:this.$tc("sw-users-permissions.users.user-grid.labelFirstName")},{property:"lastName",label:this.$tc("sw-users-permissions.users.user-grid.labelLastName")},{property:"aclRoles",sortable:!1,label:this.$tc("sw-users-permissions.users.user-grid.labelRoles")},{property:"email",label:this.$tc("sw-users-permissions.users.user-grid.labelEmail")}]}},methods:{getItemToDelete:function(e){return!!this.itemToDelete&&this.itemToDelete.id===e.id},onSearch:function(e){this.term=e,this.getList()},getList:function(){var e=this;return this.isLoading=!0,this.user=[],this.$emit("get-list"),this.userRepository.search(this.userCriteria).then((function(s){e.total=s.total,e.user=s})).finally((function(){e.isLoading=!1}))},onDelete:function(e){this.itemToDelete=e},onConfirmDelete:function(e){var s=this;return o()(l.a.mark((function n(){var t,r,i,o,a,c,m;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t="".concat(e.firstName," ").concat(e.lastName," "),r=s.$tc("global.default.success"),i=s.$tc("sw-users-permissions.users.user-grid.notification.deleteSuccess.message",0,{name:t}),o=s.$tc("global.default.error"),a=s.$tc("sw-users-permissions.users.user-grid.notification.deleteError.message",0,{name:t}),e.id!==s.currentUser.id){n.next=8;break}return s.createNotificationError({title:s.$tc("global.default.error"),message:s.$tc("sw-users-permissions.users.user-grid.notification.deleteUserLoggedInError.message")}),n.abrupt("return");case 8:return n.prev=8,s.isConfirmingPassword=!0,n.next=12,s.loginService.verifyUserToken(s.confirmPassword);case 12:c=n.sent,n.next=18;break;case 15:n.prev=15,n.t0=n.catch(8),s.createNotificationError({title:s.$tc("sw-users-permissions.users.user-detail.passwordConfirmation.notificationPasswordErrorTitle"),message:s.$tc("sw-users-permissions.users.user-detail.passwordConfirmation.notificationPasswordErrorMessage")});case 18:return n.prev=18,s.confirmPassword="",s.isConfirmingPassword=!1,n.finish(18);case 22:if(c){n.next=24;break}return n.abrupt("return");case 24:s.confirmPasswordModal=!1,(m=u({},Shopware.Context.api)).authToken.access=c,s.userRepository.delete(e.id,m).then((function(){s.createNotificationSuccess({title:r,message:i}),s.getList()})).catch((function(){s.createNotificationError({title:o,message:a})})),s.onCloseDeleteModal();case 29:case"end":return n.stop()}}),n,null,[[8,15,18,22]])})))()},onCloseDeleteModal:function(){this.itemToDelete=null}}}}}]);
//# sourceMappingURL=f6958328fb5148fa137a.js.map