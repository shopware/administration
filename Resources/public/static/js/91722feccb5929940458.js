"use strict";(window.webpackJsonpAdministration=window.webpackJsonpAdministration||[]).push([[28866],{28866:function(t,i,e){e.r(i),e.d(i,{default:function(){return o}});let{Criteria:n}=Shopware.Data,s=Shopware.Utils.types;var o=Shopware.Component.wrapComponentConfig({template:'<sw-page\n    :header-border-color="entityAccentColor"\n    class="sw-generic-custom-entity-list"\n>\n    <template #search-bar>\n        <sw-search-bar\n            :key="customEntityName"\n            :initial-search-type="customEntityName"\n            :initial-search="term"\n            :entity-search-color="entityAccentColor"\n            @search="onSearch"\n        />\n    </template>\n\n    <template #smart-bar-header>\n        <h2 class="sw-generic-custom-entity-list__title">\n            {{ $tc(`${customEntityName}.moduleTitle`) }}\n\n            <span v-if="!isLoading">\n                ({{ total }})\n            </span>\n        </h2>\n    </template>\n\n    <template #smart-bar-actions>\n        <sw-button\n            class="sw-generic-custom-entity-list__button-add"\n            :router-link="{ name: \'sw.custom.entity.create\' }"\n            variant="primary"\n        >\n            {{ $tc(\'global.default.add\') }}\n        </sw-button>\n    </template>\n\n    <template #language-switch>\n        <sw-language-switch @on-change="onChangeLanguage" />\n    </template>\n\n    <template #content>\n        <div class="sw-generic-custom-entity-list__content">\n            <sw-entity-listing\n                v-if="!isLoading && customEntityDefinition && customEntityInstances.length > 0"\n                class="sw-generic-custom-entity-list__content-list"\n                :repository="customEntityRepository"\n                :items="customEntityInstances"\n                :allow-inline-edit="false"\n                :allow-column-edit="false"\n                :columns="columnConfig"\n                :sort-by="sortBy"\n                :sort-direction="sortDirection"\n                :natural-sorting="naturalSorting"\n                :criteria-limit="limit"\n                :disable-data-fetching="true"\n                :is-loading="isLoading"\n                @column-sort="onColumnSort"\n                @page-change="onPageChange"\n                @update-records="onUpdateRecords"\n            />\n\n            <sw-empty-state\n                v-else\n                class="sw-generic-custom-entity-list__content-empty-state"\n                :title="emptyStateTitle"\n                :subline="emptyStateSubline"\n            >\n                <template #icon>\n                    <img\n                        :src="assetFilter(\'/administration/static/img/empty-states/custom-entity-empty-state.svg\')"\n                        :alt="emptyStateTitle"\n                    >\n                </template>\n            </sw-empty-state>\n        </div>\n    </template>\n</sw-page>\n',inject:["customEntityDefinitionService","repositoryFactory","acl"],data(){return{customEntityInstances:null,page:1,limit:25,total:0,term:"",sortBy:"",sortDirection:"ASC",naturalSorting:!1,isLoading:!1}},created(){this.createdComponent()},computed:{customEntityName(){let t=this.$route.params.entityName,i=this.customEntityDefinitionService.getDefinitionByName(t)??null;return i?i.entity:""},customEntityDefinition(){return this.customEntityDefinitionService.getDefinitionByName(this.customEntityName)??null},customEntityRepository(){return null===this.customEntityDefinition?null:this.repositoryFactory.create(this.customEntityDefinition.entity)},adminConfig(){return this.customEntityDefinition?.flags["admin-ui"]},entityAccentColor(){return this.adminConfig?.color},columnConfig(){return this.customEntityDefinition?this.customEntityDefinition.flags["admin-ui"].listing.columns.map(t=>{let i=`${this.customEntityName}.list.${t.ref}`;return{label:this.$tc(i),property:t.ref,routerLink:"sw.custom.entity.detail",visible:!t.hidden}}):[]},customEntityCriteria(){let t=new n(this.page,this.limit);return t.setTerm(this.term),t.addSorting({field:this.sortBy,naturalSorting:this.naturalSorting,order:this.sortDirection}),t},emptyStateTitle(){let t=`${this.customEntityName}.list.emptyState`;return this.$te(t)?this.$tc(t):this.$tc("sw-custom-entity.general.emptyState")},emptyStateSubline(){let t=`${this.customEntityName}.list.emptyStateSubline`;return this.$te(t)?this.$tc(t):this.$tc("sw-custom-entity.general.emptyStateSubline")},assetFilter(){return Shopware.Filter.getByName("asset")}},watch:{$route(){s.isEmpty(this.$route.query)&&this.updateRoute({}),this.parseRoute(),this.getList()}},methods:{createdComponent(){null!==this.adminConfig&&(this.sortBy=this.adminConfig?.listing?.columns?.[0]?.ref??"",this.$route.meta.$module.icon=this.adminConfig?.icon),this.parseRoute(),this.getList()},async getList(){if(!this.customEntityRepository)return;this.isLoading=!0;let t=await this.customEntityRepository.search(this.customEntityCriteria);this.customEntityInstances=t,this.total=t.total??0,this.isLoading=!1},onChangeLanguage(t){Shopware.State.commit("context/setApiLanguageId",t),this.getList()},parseSortDirection(t){return"ASC"===t||"DESC"===t?t:this.sortDirection},parseRoute(){let t=this.$route.query;this.page=t.page?parseInt(t.page,10):this.page,this.limit=t.limit?parseInt(t.limit,10):this.limit,this.term=t.term||this.term,this.sortBy=t.sortBy||this.sortBy,this.sortDirection=this.parseSortDirection(t.sortDirection),this.naturalSorting=t.naturalSorting?"true"===t.naturalSorting:this.naturalSorting},updateRoute(t){this.$router.replace({query:{limit:(t.limit||this.limit).toString(),page:(t.page||this.page).toString(),term:t.term||this.term,sortBy:t.sortBy||this.sortBy,sortDirection:t.sortDirection||this.sortDirection,naturalSorting:t.naturalSorting||this.naturalSorting?"true":"false"}})},onSearch(t){this.updateRoute({term:t})},onColumnSort({dataIndex:t,naturalSorting:i}){this.sortBy===t?this.updateRoute({sortDirection:"ASC"===this.sortDirection?"DESC":"ASC"}):this.updateRoute({sortBy:t,sortDirection:"ASC",naturalSorting:i})},onPageChange({page:t,limit:i}){this.updateRoute({page:t,limit:i})},onUpdateRecords(t){this.customEntityInstances=t,this.total=t.total??0}}})}}]);