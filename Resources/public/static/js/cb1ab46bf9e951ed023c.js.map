{"version":3,"sources":["webpack:///./src/module/sw-order/component/sw-order-select-document-type-modal/sw-order-select-document-type-modal.scss","webpack:///./src/module/sw-order/component/sw-order-select-document-type-modal/sw-order-select-document-type-modal.html.twig","webpack:///./src/module/sw-order/component/sw-order-select-document-type-modal/index.js"],"names":["content","__esModule","default","module","i","locals","exports","add","Criteria","Shopware","Data","template","inject","model","prop","event","props","order","type","Object","required","value","data","documentTypes","documentTypeCollection","documentType","invoiceExists","isLoading","computed","creditItems","items","this","lineItems","forEach","lineItem","push","documentRepository","repositoryFactory","create","documentTypeRepository","documentTypeCriteria","addSorting","sort","documentCriteria","criteria","addFilter","equals","id","created","createdComponent","methods","_this","searchIds","then","documentCollection","total","search","response","map","option","name","translated","disabled","documentTypeAvailable","technicalName","addHelpTextToOption","length","find","onRadioFieldChange","helpText","$tc","concat","feature","isActive","$emit","get"],"mappings":"0GAGA,IAAIA,EAAU,EAAQ,QACnBA,EAAQC,aAAYD,EAAUA,EAAQE,SACnB,iBAAZF,IAAsBA,EAAU,CAAC,CAACG,EAAOC,EAAIJ,EAAS,MAC7DA,EAAQK,SAAQF,EAAOG,QAAUN,EAAQK,SAG/BE,EADH,EAAQ,QAAwEL,SACzE,WAAYF,GAAS,EAAM,K,4ECT7B,ICOPQ,EAAaC,SAASC,KAAtBF,SAGO,WACXG,SDXW,g/CCaXC,OAAQ,CACJ,oBACA,WAGJC,MAAO,CACHC,KAAM,QACNC,MAAO,UAGXC,MAAO,CACHC,MAAO,CACHC,KAAMC,OACNC,UAAU,GAGdC,MAAO,CACHD,UAAU,EACVF,KAAMC,OACNjB,QAAS,OAIjBoB,KAAI,WACA,MAAO,CACHC,cAAe,GACfC,uBAAwB,KACxBC,aAAc,KACdC,eAAe,EACfC,WAAW,IAInBC,SAAU,CACNC,YAAW,WACP,IAAMC,EAAQ,GAQd,OANAC,KAAKd,MAAMe,UAAUC,SAAQ,SAACC,GACJ,WAAlBA,EAAShB,MACTY,EAAMK,KAAKD,MAIZJ,GAGXM,mBAAkB,WACd,OAAOL,KAAKM,kBAAkBC,OAAO,aAGzCC,uBAAsB,WAClB,OAAOR,KAAKM,kBAAkBC,OAAO,kBAGzCE,qBAAoB,WAChB,OAAQ,IAAIhC,EAAS,EAAG,KACnBiC,WAAWjC,EAASkC,KAAK,OAAQ,SAG1CC,iBAAgB,WACZ,IAAMC,EAAW,IAAIpC,EAAS,EAAG,KAIjC,OAHAoC,EAASC,UAAUrC,EAASsC,OAAO,WAAYf,KAAKd,MAAM8B,KAC1DH,EAASC,UAAUrC,EAASsC,OAAO,6BAA8B,YAE1DF,IAIfI,QAAO,WACHjB,KAAKkB,oBAGTC,QAAS,CACLD,iBAAgB,WAAI,IAADE,EAAA,KACfpB,KAAKJ,WAAY,EAEjBI,KAAKK,mBAAmBgB,UAAUrB,KAAKY,kBAAkBU,MAAK,SAACC,GAC3DH,EAAKzB,cAAgB4B,EAAmBC,MAAQ,EAEhDJ,EAAKZ,uBAAuBiB,OAAOL,EAAKX,sBAAsBa,MAAK,SAACI,GAChEN,EAAK3B,uBAAyBiC,EAC9BN,EAAK5B,cAAgBkC,EAASC,KAAI,SAACjC,GAC/B,IAAMkC,EAAS,CACXtC,MAAOI,EAAasB,GACpBa,KAAMnC,EAAaoC,WAAWD,KAC9BE,UAAWX,EAAKY,sBAAsBtC,IAG1C,MAAmC,WAA/BA,EAAauC,eAA6D,gBAA/BvC,EAAauC,cACjDb,EAAKc,oBAAoBN,EAAQlC,GAGrCkC,KAGPR,EAAK5B,cAAc2C,SACnBf,EAAK1B,aAAe0B,EAAK5B,cAAc4C,MAAK,SAAA1C,GAAY,OAAKA,EAAaqC,YAAUzC,MACpF8B,EAAKiB,sBAGTjB,EAAKxB,WAAY,SAK7BoC,sBAAqB,SAACtC,GAClB,MAEuC,WAA/BA,EAAauC,eACkB,gBAA/BvC,EAAauC,gBAIsB,WAA/BvC,EAAauC,eAEsB,gBAA/BvC,EAAauC,eACe,IAA5BjC,KAAKF,YAAYqC,SAEpBnC,KAAKL,eAKtBuC,oBAAmB,SAACN,EAAQlC,GAGxB,OAFAkC,EAAOU,SAAWtC,KAAKuC,IAAI,wDAADC,OAAyD9C,EAAauC,gBAEzFL,GAGXS,mBAAkB,WACVrC,KAAKyC,QAAQC,SAAS,QACtB1C,KAAK2C,MAAM,eAAgB3C,KAAKP,uBAAuBmD,IAAI5C,KAAKN,eAKpEM,KAAK2C,MAAM,SAAU3C,KAAKP,uBAAuBmD,IAAI5C,KAAKN","file":"static/js/cb1ab46bf9e951ed023c.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--15-1!../../../../../node_modules/css-loader/dist/cjs.js??ref--15-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--15-3!./sw-order-select-document-type-modal.scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"edd04608\", content, true, {});","export default \"\\n{% block sw_order_select_document_type_modal %}\\n<sw-modal\\n    v-bind=\\\"$attrs\\\"\\n    :title=\\\"$tc('sw-order.components.selectDocumentTypeModal.title')\\\"\\n    variant=\\\"small\\\"\\n    class=\\\"sw-order-select-document-type-modal\\\"\\n    @modal-close=\\\"$emit('modal-close', false)\\\"\\n>\\n\\n    \\n    {% block sw_order_select_document_type_modal_document_types %}\\n    <sw-radio-field\\n        v-if=\\\"!isLoading && documentTypes.length\\\"\\n        {% if VUE3 %}\\n        v-model:value=\\\"documentType\\\"\\n        {% else %}\\n        v-model=\\\"documentType\\\"\\n        {% endif %}\\n        :options=\\\"documentTypes\\\"\\n        class=\\\"sw-order-select-document-type-modal__radio-field\\\"\\n        {% if VUE3 %}\\n        @update:value=\\\"onRadioFieldChange\\\"\\n        {% else %}\\n        @change=\\\"onRadioFieldChange\\\"\\n        {% endif %}\\n    />\\n    {% endblock %}\\n\\n    <template #modal-footer>\\n        \\n        {% block sw_order_select_document_type_modal_footer_action_cancel %}\\n        <sw-button\\n            @click=\\\"$emit('modal-close', false)\\\"\\n        >\\n            {{ $tc('global.default.cancel') }}\\n        </sw-button>\\n        {% endblock %}\\n\\n        \\n        {% block sw_order_select_document_type_modal_footer_action_create %}\\n        <sw-button\\n            variant=\\\"primary\\\"\\n            @click=\\\"$emit('modal-close', true)\\\"\\n        >\\n            {{ $tc('sw-order.components.selectDocumentTypeModal.primaryAction') }}\\n        </sw-button>\\n        {% endblock %}\\n\\n    </template>\\n</sw-modal>\\n{% endblock %}\\n\";","import template from './sw-order-select-document-type-modal.html.twig';\nimport './sw-order-select-document-type-modal.scss';\n\n/**\n * @package checkout\n */\n\nconst { Criteria } = Shopware.Data;\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: [\n        'repositoryFactory',\n        'feature',\n    ],\n\n    model: {\n        prop: 'value',\n        event: 'change',\n    },\n\n    props: {\n        order: {\n            type: Object,\n            required: true,\n        },\n\n        value: {\n            required: false,\n            type: Object,\n            default: null,\n        },\n    },\n\n    data() {\n        return {\n            documentTypes: [],\n            documentTypeCollection: null,\n            documentType: null,\n            invoiceExists: false,\n            isLoading: false,\n        };\n    },\n\n    computed: {\n        creditItems() {\n            const items = [];\n\n            this.order.lineItems.forEach((lineItem) => {\n                if (lineItem.type === 'credit') {\n                    items.push(lineItem);\n                }\n            });\n\n            return items;\n        },\n\n        documentRepository() {\n            return this.repositoryFactory.create('document');\n        },\n\n        documentTypeRepository() {\n            return this.repositoryFactory.create('document_type');\n        },\n\n        documentTypeCriteria() {\n            return (new Criteria(1, 100))\n                .addSorting(Criteria.sort('name', 'ASC'));\n        },\n\n        documentCriteria() {\n            const criteria = new Criteria(1, 100);\n            criteria.addFilter(Criteria.equals('order.id', this.order.id));\n            criteria.addFilter(Criteria.equals('documentType.technicalName', 'invoice'));\n\n            return criteria;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.isLoading = true;\n\n            this.documentRepository.searchIds(this.documentCriteria).then((documentCollection) => {\n                this.invoiceExists = documentCollection.total > 0;\n\n                this.documentTypeRepository.search(this.documentTypeCriteria).then((response) => {\n                    this.documentTypeCollection = response;\n                    this.documentTypes = response.map((documentType) => {\n                        const option = {\n                            value: documentType.id,\n                            name: documentType.translated.name,\n                            disabled: !this.documentTypeAvailable(documentType),\n                        };\n\n                        if (documentType.technicalName === 'storno' || documentType.technicalName === 'credit_note') {\n                            return this.addHelpTextToOption(option, documentType);\n                        }\n\n                        return option;\n                    });\n\n                    if (this.documentTypes.length) {\n                        this.documentType = this.documentTypes.find(documentType => !documentType.disabled).value;\n                        this.onRadioFieldChange();\n                    }\n\n                    this.isLoading = false;\n                });\n            });\n        },\n\n        documentTypeAvailable(documentType) {\n            return (\n                (\n                    documentType.technicalName !== 'storno' &&\n                    documentType.technicalName !== 'credit_note'\n                ) ||\n                (\n                    (\n                        documentType.technicalName === 'storno' ||\n                        (\n                            documentType.technicalName === 'credit_note' &&\n                            this.creditItems.length !== 0\n                        )\n                    ) && this.invoiceExists\n                )\n            );\n        },\n\n        addHelpTextToOption(option, documentType) {\n            option.helpText = this.$tc(`sw-order.components.selectDocumentTypeModal.helpText.${documentType.technicalName}`);\n\n            return option;\n        },\n\n        onRadioFieldChange() {\n            if (this.feature.isActive('VUE3')) {\n                this.$emit('update:value', this.documentTypeCollection.get(this.documentType));\n\n                return;\n            }\n\n            this.$emit('change', this.documentTypeCollection.get(this.documentType));\n        },\n    },\n};\n"],"sourceRoot":""}