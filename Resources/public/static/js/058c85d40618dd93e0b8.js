(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[473],{"4OWw":function(t,e,n){var s=n("uPSr");s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,n("P8hj").default)("81934720",s,!0,{})},iInt:function(t,e,n){"use strict";n.r(e);var s=n("7yzw"),a=n.n(s),i=n("c1oF"),o=n.n(i),r=n("CsSd"),l=n.n(r),c=n("92Mt"),d=n.n(c);n("4OWw");function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var u=Shopware.Mixin,p=Shopware.Component.getComponentHelper().mapPropertyErrors;e.default={template:'\n{% block sw_settings_tag_detail_modal %}\n<sw-modal\n    class="sw-settings-tag-detail-modal"\n    :class="{ \'is--auto-height\': initialTab === \'general\' }"\n    :title="title"\n    :is-loading="isLoading"\n    variant="full"\n    @modal-close="$emit(\'close\')"\n>\n    \n    {% block sw_settings_tag_detail_modal_tabs %}\n    <sw-tabs\n        position-identifier="sw-settings-tag-detail-modal"\n        :small="false"\n        :default-item="initialTab"\n        @new-item-active="active => initialTab = active.name"\n    >\n        <template #default="{ active }">\n            \n            {% block sw_settings_tag_detail_modal_tabs_general %}\n            <sw-tabs-item\n                :title="$tc(\'sw-settings-tag.detail.generalTab\')"\n                :active-tab="active"\n                name="general"\n            >\n                {{ $tc(\'sw-settings-tag.detail.generalTab\') }}\n            </sw-tabs-item>\n            {% endblock %}\n\n            \n            {% block sw_settings_tag_detail_modal_tabs_assignments %}\n            <sw-tabs-item\n                :title="$tc(\'sw-settings-tag.detail.assignmentsTab\')"\n                :active-tab="active"\n                name="assignments"\n            >\n                {{ $tc(\'sw-settings-tag.detail.assignmentsTab\') }}\n            </sw-tabs-item>\n            {% endblock %}\n        </template>\n\n        <template #content="{ active }">\n            <template v-if="active === \'general\'">\n                \n                {% block sw_settings_tag_detail_modal_tabs_general_tab %}\n                <p class="sw-settings-tag-detail-modal__tag-name">\n                    <sw-text-field\n                        id="sw-field--tag-name"\n                        {% if VUE3 %}\n                        v-model:value="tag.name"\n                        {% else %}\n                        v-model="tag.name"\n                        {% endif %}\n                        name="sw-field--tag-name"\n                        :label="$tc(\'sw-settings-tag.list.columnName\')"\n                        :placeholder="$tc(\'sw-settings-tag.list.placeholderTagName\')"\n                        :error="tagNameError"\n                        maxlength="255"\n                        required\n                    />\n                </p>\n                {% endblock %}\n            </template>\n\n            <template v-if="active === \'assignments\'">\n                \n                {% block sw_settings_tag_detail_modal_tabs_assignments_tab %}\n                <sw-settings-tag-detail-assignments\n                    :tag="tag"\n                    :initial-counts="computedCounts"\n                    :to-be-added="assignmentsToBeAdded"\n                    :to-be-deleted="assignmentsToBeDeleted"\n                    :property="property"\n                    :entity="entity"\n                    @add-assignment="addAssignment"\n                    @remove-assignment="removeAssignment"\n                />\n                {% endblock %}\n            </template>\n        </template>\n    </sw-tabs>\n    {% endblock %}\n\n    \n    {% block sw_settings_tag_detail_modal_footer %}\n    <template #modal-footer>\n        \n        {% block sw_settings_tag_detail_modal_cancel %}\n        <sw-button\n            size="small"\n            @click="$emit(\'close\')"\n        >\n            {{ $tc(\'sw-settings-tag.list.buttonCancel\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_settings_tag_detail_modal_confirm %}\n        <sw-button\n            variant="primary"\n            size="small"\n            :disabled="!allowSave"\n            :is-loading="isLoading"\n            @click="onSave"\n        >\n            {{ $tc(\'sw-settings-tag.detail.buttonSave\') }}\n        </sw-button>\n        {% endblock %}\n    </template>\n    {% endblock %}\n</sw-modal>\n{% endblock %}\n',inject:["repositoryFactory","syncService","acl"],mixins:[u.getByName("notification")],shortcuts:{"SYSTEMKEY+S":{active:function(){return this.allowSave},method:"onSave"},ESCAPE:"onCancel"},props:{editedTag:{type:Object,required:!1,default:null},counts:{type:Object,required:!1,default:function(){return{}}},property:{type:String,required:!1,default:null},entity:{type:String,required:!1,default:null}},data:function(){return{tag:null,isLoading:!1,assignmentsToBeAdded:{},assignmentsToBeDeleted:{},initialTab:this.property&&this.entity?"assignments":"general"}},computed:m(m({tagRepository:function(){return this.repositoryFactory.create("tag")},tagDefinition:function(){return Shopware.EntityDefinition.get("tag")}},p("tag",["name"])),{},{title:function(){return this.tag.isNew()?this.$tc("sw-settings-tag.list.buttonAddTag"):this.$tc("sw-settings-tag.detail.editTitle",0,{name:this.tag.name})},allowSave:function(){return this.tag.isNew()?this.acl.can("tag.creator"):this.acl.can("tag.editor")},tooltipSave:function(){if(!this.allowSave)return{message:this.$tc("sw-privileges.tooltip.warning"),disabled:this.allowSave,showOnDisabledElements:!0};var t=this.$device.getSystemKey();return{message:"".concat(t," + S"),appearance:"light"}},computedCounts:function(){var t=this,e=m({},this.counts);return Object.keys(this.assignmentsToBeDeleted).forEach((function(n){e.hasOwnProperty(n)&&(e[n]-=Object.keys(t.assignmentsToBeDeleted[n]).length)})),Object.keys(this.assignmentsToBeAdded).forEach((function(n){e.hasOwnProperty(n)?e[n]+=Object.keys(t.assignmentsToBeAdded[n]).length:e[n]=Object.keys(t.assignmentsToBeAdded[n]).length})),e}}),created:function(){this.createdComponent()},methods:{createdComponent:function(){var t=this;this.editedTag?(this.tag=Object.assign(this.tagRepository.create(),this.editedTag),this.tag._isNew=!1):this.tag=this.tagRepository.create(),Object.entries(this.tagDefinition.properties).forEach((function(e){var n=o()(e,2),s=n[0];"many_to_many"===n[1].relation&&(t.$set(t.assignmentsToBeAdded,s,{}),t.$set(t.assignmentsToBeDeleted,s,{}))}))},onSave:function(){var t=this;return a()(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoading=!0,n=[],Object.entries(t.tagDefinition.properties).forEach((function(e){var s=o()(e,2),a=s[0],i=s[1];if("many_to_many"===i.relation){var r=Object.keys(t.assignmentsToBeAdded[a]);0!==r.length&&r.forEach((function(e){t.tag[a].add(t.assignmentsToBeAdded[a][e])}));var c=Object.keys(t.assignmentsToBeDeleted[a]);if(0!==c.length){var d=c.map((function(e){var n;return n={},l()(n,i.reference,e),l()(n,i.local,t.tag.id),n}));n.push({action:"delete",entity:i.mapping,payload:d})}}})),!n.length){e.next=6;break}return e.next=6,t.syncService.sync(n,{},{"single-operation":1});case 6:return e.abrupt("return",t.tagRepository.save(t.tag).then((function(){t.$emit("finish")})).catch((function(){t.createNotificationError({message:t.$tc("global.notification.unspecifiedSaveErrorMessage")}),t.isLoading=!1})));case 7:case"end":return e.stop()}}),e)})))()},onCancel:function(){this.$emit("close")},addAssignment:function(t,e,n){this.assignmentsToBeDeleted[t].hasOwnProperty(e)?this.$delete(this.assignmentsToBeDeleted[t],e):this.$set(this.assignmentsToBeAdded[t],e,n)},removeAssignment:function(t,e,n){this.assignmentsToBeAdded[t].hasOwnProperty(e)?this.$delete(this.assignmentsToBeAdded[t],e):this.$set(this.assignmentsToBeDeleted[t],e,n)}}}},uPSr:function(t,e,n){}}]);