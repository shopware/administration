(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[253],{Y6pV:function(e,t,a){},b9ib:function(e,t,a){"use strict";a.r(t);var l=a("HZZ/"),n=a.n(l),o=a("J58c"),i=a.n(o),r=a("hJxD"),m=a.n(r);a("basE");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}var s=Shopware.Mixin,p=Shopware.Data.Criteria,d=Shopware.Component.getComponentHelper().mapPropertyErrors,f=Shopware.Utils;t.default={template:'\n{% block sw_flow_create_mail_template_modal %}\n<sw-modal\n    class="sw-flow-create-mail-template-modal"\n    :title="$tc(\'sw-flow.modals.mail.titleNewEmailTemplate\')"\n    :closable="false"\n    @modal-close="onClose"\n>\n    \n    {% block sw_flow_create_mail_template_modal_content %}\n    \n    {% block sw_flow_create_mail_template_modal_type_selection %}\n    <sw-entity-single-select\n        v-model="mailTemplate.mailTemplateTypeId"\n        class="sw-flow-create-mail-template-modal__type"\n        entity="mail_template_type"\n        required\n        :label="$tc(\'sw-flow.modals.mail.labelMailType\')"\n        :placeholder="$tc(\'sw-flow.modals.mail.placeholderMailType\')"\n        :error="mailTemplateMailTemplateTypeIdError"\n        @change="onChangeType"\n    />\n    {% endblock %}\n\n    \n    {% block sw_flow_create_mail_template_modal_info %}\n    <sw-container\n        columns="1fr 1fr"\n        gap="30px"\n    >\n        \n        {% block sw_flow_create_mail_template_modal_subject %}\n        <sw-text-field\n            v-model="mailTemplate.subject"\n            class="sw-flow-create-mail-template-modal__subject"\n            required\n            :label="$tc(\'sw-flow.modals.mail.labelSubject\')"\n            :placeholder="$tc(\'sw-flow.modals.mail.placeholderSubject\')"\n            :error="mailTemplateSubjectError"\n        />\n        {% endblock %}\n\n        \n        {% block sw_flow_create_mail_template_modal_sender_name %}\n        <sw-text-field\n            v-model="mailTemplate.senderName"\n            class="sw-flow-create-mail-template-modal__sender-name"\n            :label="$tc(\'sw-flow.modals.mail.labelSenderName\')"\n            :placeholder="$tc(\'sw-flow.modals.mail.placeholderSenderName\')"\n        />\n        {% endblock %}\n    </sw-container>\n    {% endblock %}\n\n    \n    {% block sw_flow_create_mail_template_modal_description %}\n    <sw-textarea-field\n        v-model="mailTemplate.description"\n        class="sw-flow-create-mail-template-modal__description"\n        :label="$tc(\'sw-flow.modals.mail.labelDescription\')"\n        :placeholder="$tc(\'sw-flow.modals.mail.placeholderDescription\')"\n    />\n    {% endblock %}\n\n    \n    {% block sw_flow_create_mail_template_modal_plain_content %}\n    <sw-code-editor\n        ref="plainEditor"\n        :key="`${mailTemplate.mailTemplateTypeId}plain`"\n        v-model="mailTemplate.contentPlain"\n        class="sw-flow-create-mail-template-modal__content-plain"\n        name="content_plain"\n        completion-mode="entity"\n        :label="$tc(\'sw-flow.modals.mail.labelContentPlain\')"\n        :placeholder="placeholder(mailTemplate, \'contentPlain\', $tc(\'sw-flow.modals.mail.placeholderPlain\'))"\n        :completer-function="outerCompleterFunction"\n        :editor-config="editorConfig"\n    />\n    {% endblock %}\n\n    \n    {% block sw_flow_create_mail_template_modal_html_content %}\n    <sw-code-editor\n        ref="htmlEditor"\n        :key="`${mailTemplate.mailTemplateTypeId}html`"\n        v-model="mailTemplate.contentHtml"\n        class="sw-flow-create-mail-template-modal__content-html"\n        name="content_html"\n        completion-mode="entity"\n        :label="$tc(\'sw-flow.modals.mail.labelContentHtml\')"\n        :placeholder="placeholder(mailTemplate, \'contentPlain\', $tc(\'sw-flow.modals.mail.placeholderHtml\'))"\n        :completer-function="outerCompleterFunction"\n        :editor-config="editorConfig"\n    />\n    {% endblock %}\n    {% endblock %}\n\n    \n    {% block sw_flow_create_mail_template_modal_footer %}\n    <template #modal-footer>\n        \n        {% block sw_flow_create_mail_template_modal_footer_cancel_button %}\n        <sw-button\n            class="sw-flow-create-mail-template-modal__cancel-button"\n            size="small"\n            @click="onClose"\n        >\n            {{ $tc(\'global.default.cancel\') }}\n        </sw-button>\n        {% endblock %}\n\n        \n        {% block sw_flow_create_mail_template_modal_footer_save_button %}\n        <sw-button\n            class="sw-flow-create-mail-template-modal__save-button"\n            variant="primary"\n            size="small"\n            :is-loading="isLoading"\n            @click="onAddMailTemplate"\n        >\n            {{ $tc(\'sw-flow.modals.mail.buttonAddMailTemplate\') }}\n        </sw-button>\n        {% endblock %}\n    </template>\n    {% endblock %}\n</sw-modal>\n{% endblock %}\n',inject:["mailService","entityMappingService","repositoryFactory"],mixins:[s.getByName("placeholder"),s.getByName("notification")],data:function(){return{mailTemplate:{},mailTemplateType:{},editorConfig:{enableBasicAutocompletion:!0},isLoading:!1}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){i()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({mailTemplateRepository:function(){return this.repositoryFactory.create("mail_template")},mailTemplateTypeRepository:function(){return this.repositoryFactory.create("mail_template_type")},mailTemplateCriteria:function(){var e=new p(1,25);return e.addAssociation("mailTemplateType"),e},outerCompleterFunction:function(){return e=this.entityMappingService,t=this.mailTemplateType,function(a){var l=[];return Object.keys(e.getEntityMapping(a,t.availableEntities)).forEach((function(e){l.push({value:e})})),l};var e,t}},d("mailTemplate",["mailTemplateTypeId","subject"])),created:function(){this.createdComponent()},methods:{createdComponent:function(){Shopware.State.getters["context/isSystemDefaultLanguage"]||Shopware.State.commit("context/resetLanguageToDefault"),this.mailTemplate=this.mailTemplateRepository.create(Shopware.Context.api,f.createId())},onClose:function(){this.$emit("modal-close")},onAddMailTemplate:function(){var e=this,t=this.mailTemplate.subject||this.placeholder(this.mailTemplate,"subject");return this.isSaveSuccessful=!1,this.isLoading=!0,this.mailTemplateRepository.save(this.mailTemplate).then((function(){e.getMailTemplate()})).catch((function(a){var l="";if(e.isLoading=!1,a.response.data.errors.length>0){var n=a.response.data.errors[0].detail;l="<br/> ".concat(e.$tc("sw-mail-template.detail.textErrorMessage"),': "').concat(n,'"')}e.createNotificationError({message:e.$tc("sw-mail-template.detail.messageSaveError",0,{subject:t})+l})}))},getMailTemplateType:function(){var e,t=this;return null!==(e=this.mailTemplate)&&void 0!==e&&e.mailTemplateTypeId?this.mailTemplateTypeRepository.get(this.mailTemplate.mailTemplateTypeId).then((function(e){t.mailTemplateType=e,t.$refs.htmlEditor.defineAutocompletion(t.outerCompleterFunction),t.$refs.plainEditor.defineAutocompletion(t.outerCompleterFunction)})):Promise.resolve()},onChangeType:function(e){var t=this;return n()(m.a.mark((function a(){var l,n;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,a.next=5,t.getMailTemplateType();case 5:a.next=12;break;case 7:a.prev=7,a.t0=a.catch(2),l="",a.t0.response.data.errors.length>0&&(n=a.t0.response.data.errors[0].detail,l="<br/> ".concat(t.$tc("sw-mail-template.detail.textErrorMessage"),': "').concat(n,'"')),t.createNotificationError({message:l});case 12:case"end":return a.stop()}}),a,null,[[2,7]])})))()},getMailTemplate:function(){var e=this;return this.mailTemplateRepository.get(this.mailTemplate.id,Shopware.Context.api,this.mailTemplateCriteria).then((function(t){e.$emit("process-finish",t)})).catch((function(){e.$emit("process-finish",null)})).finally((function(){e.isLoading=!1,e.onClose()}))}}}},basE:function(e,t,a){var l=a("Y6pV");l.__esModule&&(l=l.default),"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);(0,a("ydqr").default)("0a719349",l,!0,{})}}]);