(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[574],{TUIL:function(t,e,n){"use strict";n.r(e);var r=Shopware,a=r.Component,i=r.State,s=r.Mixin,c=r.Utils,o=c.get,d=c.format,l=c.array;e.default=a.wrapComponentConfig({template:'<div class="sw-order-create-general">\n    <sw-card\n        class="sw-order-create-general__general-info"\n        position-identifier="sw-order-create-general-info"\n        :title="$tc(\'sw-order.createBase.generalTab.labelGeneralInfoCard\')"\n    >\n        <sw-order-create-general-info\n            :cart="cart"\n            :context="context"\n            :is-loading="isLoading"\n        />\n    </sw-card>\n\n    <sw-card\n        class="sw-order-create-general__line-items"\n        position-identifier="sw-order-create-line-items"\n        :is-loading="isLoading"\n        :title="$tc(\'sw-order.createBase.generalTab.labelLineItemsCard\')"\n    >\n        <template #grid>\n            <sw-order-line-items-grid-sales-channel\n                editable\n                :cart="cart"\n                :currency="currency"\n                :sales-channel-id="context.salesChannel.id"\n                :is-loading="isLoading"\n                :is-customer-active="isCustomerActive"\n                @on-save-item="onSaveItem"\n                @on-remove-items="onRemoveItems"\n            />\n\n            <sw-card-section\n                v-show="cart.lineItems.length"\n                divider="top"\n                slim\n            >\n\n                <sw-container\n                    class="sw-order-create-summary"\n                    columns="1fr 1fr"\n                >\n\n                    <sw-description-list\n                        class="sw-order-create-summary__data"\n                        grid="1fr 1fr"\n                    >\n                        <dt>{{ $tc(\'sw-order.createBase.summaryLabelAmount\') }}</dt>\n                        <dd>{{ (cart.price ? cart.price.positionPrice : 0) | currency(currency.shortName, currency.totalRounding.decimals) }}</dd>\n\n                        <template v-if="cartDelivery">\n                            <dt>{{ $tc(\'sw-order.createBase.summaryLabelShippingCosts\') }}</dt>\n                            <dd>\n                                <sw-order-saveable-field\n                                    v-tooltip="{\n                                        showDelay: 300,\n                                        message: shippingCostsDetail,\n                                        disabled: taxStatus === \'tax-free\'\n                                    }"\n                                    type="number"\n                                    editable\n                                    :value="cartDelivery.shippingCosts.totalPrice"\n                                    @value-change="onShippingChargeEdited"\n                                >\n                                    {{ cartDelivery.shippingCosts.totalPrice | currency(currency.shortName, currency.totalRounding.decimals) }}\n                                </sw-order-saveable-field>\n                            </dd>\n                        </template>\n\n                        <template v-for="(delivery, index) in cartDeliveryDiscounts">\n                            <dt :key="`dt-delivery-${index}`">\n                                {{ $tc(\'sw-order.createBase.discountLabelShippingCosts\') }}\n                            </dt>\n                            <dd :key="`dd-delivery-${index}`">\n                                {{ delivery.shippingCosts.totalPrice | currency(currency.shortName, currency.totalRounding.decimals) }}\n                            </dd>\n                        </template>\n\n                        <template v-if="taxStatus !== \'tax-free\'">\n                            <dt><strong>{{ $tc(\'sw-order.createBase.summaryLabelAmountWithoutTaxes\') }}</strong></dt>\n                            <dd>\n                                <strong>{{ (cart.price ? cart.price.netPrice : 0) | currency(currency.shortName, currency.totalRounding.decimals) }}</strong>\n                            </dd>\n                        </template>\n\n                        <template v-if="taxStatus !== \'tax-free\'">\n                            <template v-for="(calculatedTax, index) in filteredCalculatedTaxes">\n                                <dt :key="`dt-${index}`">\n                                    {{ $tc(\'sw-order.createBase.summaryLabelTaxes\', 1, { taxRate: calculatedTax.taxRate }) }}\n                                </dt>\n                                <dd :key="`dd-${index}`">\n                                    {{ calculatedTax.tax | currency(currency.shortName, currency.totalRounding.decimals) }}\n                                </dd>\n                            </template>\n                        </template>\n\n                        <template v-if="taxStatus !== \'tax-free\'">\n                            <dt><strong>{{ $tc(\'sw-order.createBase.summaryLabelAmountTotal\') }}</strong></dt>\n                            <dd>\n                                <strong>{{ orderTotal | currency(currency.shortName, currency.totalRounding.decimals) }}</strong>\n                            </dd>\n                            <template v-if="displayRounded">\n                                <dt><strong>{{ $tc(\'sw-order.createBase.summaryLabelAmountTotalRounded\') }}</strong>\n                                </dt>\n                                <dd>\n                                    <strong>{{ cart.price ? cart.price.totalPrice : 0 | currency(currency.shortName, currency.totalRounding.decimals) }}</strong>\n                                </dd>\n                            </template>\n                        </template>\n\n                        <template v-if="taxStatus === \'tax-free\'">\n                            <dt><strong>{{ $tc(\'sw-order.detailBase.summaryLabelAmount\') }}</strong></dt>\n                            <dd>\n                                <strong>{{ cart.price ? cart.price.totalPrice : 0 | currency(currency.shortName, currency.totalRounding.decimals) }}</strong>\n                            </dd>\n                        </template>\n                    </sw-description-list>\n                </sw-container>\n            </sw-card-section>\n        </template>\n    </sw-card>\n</div>\n',mixins:[s.getByName("notification"),s.getByName("cart-notification")],data:function(){return{isLoading:!1}},computed:{customer:function(){return i.get("swOrder").customer},cart:function(){return i.get("swOrder").cart},currency:function(){return i.get("swOrder").context.currency},context:function(){return i.get("swOrder").context},isCustomerActive:function(){return i.getters["swOrder/isCustomerActive"]},cartDelivery:function(){return o(this.cart,"deliveries[0]",null)},cartDeliveryDiscounts:function(){return l.slice(this.cart.deliveries,1)||[]},taxStatus:function(){return o(this.cart,"price.taxStatus","")},shippingCostsDetail:function(){var t=this;if(!this.cartDelivery)return null;var e=this.sortByTaxRate(this.cartDelivery.shippingCosts.calculatedTaxes).map((function(e){var n;return t.$tc("sw-order.createBase.shippingCostsTax",0,{taxRate:e.taxRate,tax:d.currency(e.tax,t.currency.shortName,null===(n=t.currency.totalRounding)||void 0===n?void 0:n.decimals)})}));return"".concat(this.$tc("sw-order.createBase.tax"),"<br>").concat(e.join("<br>"))},filteredCalculatedTaxes:function(){var t;return this.cart.price&&this.cart.price.calculatedTaxes?this.sortByTaxRate(null!==(t=this.cart.price.calculatedTaxes)&&void 0!==t?t:[]).filter((function(t){return 0!==t.tax})):[]},displayRounded:function(){return!!this.cart.price&&this.cart.price.rawTotal!==this.cart.price.totalPrice},orderTotal:function(){return this.cart.price?this.displayRounded?this.cart.price.rawTotal:this.cart.price.totalPrice:0}},created:function(){this.createdComponent()},methods:{createdComponent:function(){var t=this;this.customer?(this.isLoading=!0,this.loadCart().finally((function(){t.isLoading=!1}))):this.$nextTick((function(){t.$router.push({name:"sw.order.create.initial"})}))},onSaveItem:function(t){var e,n=this;return this.isLoading=!0,i.dispatch("swOrder/saveLineItem",{salesChannelId:null===(e=this.customer)||void 0===e?void 0:e.salesChannelId,contextToken:this.cart.token,item:t}).finally((function(){n.isLoading=!1}))},onShippingChargeEdited:function(t){var e,n=this,r=Math.abs(t);this.cartDelivery.shippingCosts.unitPrice=r,this.cartDelivery.shippingCosts.totalPrice=r,this.isLoading=!0,i.dispatch("swOrder/modifyShippingCosts",{salesChannelId:null===(e=this.customer)||void 0===e?void 0:e.salesChannelId,contextToken:this.cart.token,shippingCosts:this.cartDelivery.shippingCosts}).catch((function(t){n.$emit("error",t)})).finally((function(){n.isLoading=!1}))},onRemoveItems:function(t){var e,n=this;return this.isLoading=!0,i.dispatch("swOrder/removeLineItems",{salesChannelId:null===(e=this.customer)||void 0===e?void 0:e.salesChannelId,contextToken:this.cart.token,lineItemKeys:t}).then((function(){t.forEach((function(t){var e=i.get("swOrder").promotionCodes.find((function(e){return e.discountId===t}));e&&i.commit("swOrder/setPromotionCodes",i.get("swOrder").promotionCodes.filter((function(t){return t.discountId!==e.discountId})))}))})).finally((function(){n.isLoading=!1}))},loadCart:function(){var t;return i.dispatch("swOrder/getCart",{salesChannelId:null===(t=this.customer)||void 0===t?void 0:t.salesChannelId,contextToken:this.cart.token})},sortByTaxRate:function(t){return t.sort((function(t,e){return t.taxRate-e.taxRate}))}}})}}]);