(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[271],{"/zJf":function(e,i,t){"use strict";t.r(i);t("mwDM");var n=Shopware.Data.Criteria;i.default={template:'\n{% block sw_import_export_new_profile_wizard %}\n<sw-wizard\n    ref="wizard"\n    class="sw-import-export-new-profile-wizard"\n    variant="full"\n    :right-button-disabled="nextButtonDisabled"\n    :active-page="currentlyActivePage"\n    @close="onClose"\n    @finish="onFinish"\n    @current-page-change="onCurrentPageChange"\n>\n    \n    {% block sw_import_export_new_profile_wizard_page_general %}\n    <sw-wizard-page\n        :position="0"\n        :title="pageTitleSnippet(\'sw-import-export.profile.generalTab\')"\n    >\n        <sw-import-export-new-profile-wizard-general-page\n            :profile="profile"\n            @next-disable="onNextDisable"\n            @next-allow="onNextAllow"\n        />\n    </sw-wizard-page>\n    {% endblock %}\n    \n    {% block sw_import_export_new_profile_wizard_page_csv %}\n    <sw-wizard-page\n        :position="csvUploadPagePosition"\n        :title="pageTitleSnippet(\'sw-import-export.profile.csvUploadTab\')"\n    >\n        <sw-import-export-new-profile-wizard-csv-page\n            :profile="profile"\n            @next-disable="onNextDisable"\n            @next-allow="onNextAllow"\n        />\n    </sw-wizard-page>\n    {% endblock %}\n    \n    {% block sw_import_export_new_profile_wizard_page_mapping %}\n    <sw-wizard-page\n        :position="2"\n        :title="pageTitleSnippet(\'sw-import-export.profile.mappingsTab\')"\n    >\n        <sw-import-export-new-profile-wizard-mapping-page\n            :profile="profile"\n            :system-required-fields="systemRequiredFields"\n            @next-disable="onNextDisable"\n            @next-allow="onNextAllow"\n        />\n    </sw-wizard-page>\n    {% endblock %}\n\n    \n    {% block sw_import_export_new_profile_wizard_footer_right_button %}\n    <template #footer-right-button>\n        <div class="sw-import-export-new-profile-wizard__footer-right-button-group">\n            \n            {% block sw_import_export_new_profile_wizard_footer_right_button_finish %}\n            <sw-button\n                v-if="showNextButton"\n                size="small"\n                variant="primary"\n                :disabled="nextButtonDisabled"\n                @click="onFinish"\n            >\n                {{ $tc(\'sw-import-export.profile.addProfileLabel\') }}\n            </sw-button>\n            {% endblock %}\n\n            <template v-else>\n                \n                {% block sw_import_export_new_profile_wizard_footer_right_button_skip %}\n                <sw-button\n                    v-if="showCsvSkipButton"\n                    size="small"\n                    @click="onNextPage"\n                >\n                    {{ $tc(\'sw-import-export.profile.skipCsvUpload\') }}\n                </sw-button>\n                {% endblock %}\n\n                \n                {% block sw_import_export_new_profile_wizard_footer_right_button_next %}\n                <sw-button\n                    size="small"\n                    variant="primary"\n                    :disabled="nextButtonDisabled"\n                    @click="onNextPage"\n                >\n                    {{ $tc(\'sw-wizard.nextButton\') }}\n                </sw-button>\n            {% endblock %}\n            </template>\n        </div>\n    </template>\n    {% endblock %}\n\n    \n    {% block sw_import_export_new_profile_wizard_violation_modal %}\n    <sw-modal\n        v-if="showValidationError"\n        :title="$tc(\'global.default.error\')"\n        class="sw-import-export-new-profile-wizard__violation-modal"\n        @modal-close="resetViolations"\n    >\n\n        \n        {% block sw_import_export_new_profile_wizard_violation_modal_message %}\n        <p>{{ $tc(\'sw-import-export.profile.violationMessage\') }}</p>\n        {% endblock %}\n\n        \n        {% block sw_import_export_new_profile_wizard_violation_modal_required_fields %}\n        <ul>\n            \n            {% block sw_import_export_new_profile_wizard_violation_modal_required_field %}\n            <li\n                v-for="requiredField in missingRequiredFields"\n                :key="requiredField"\n            >\n                {{ requiredField }}\n            </li>\n            {% endblock %}\n        </ul>\n        {% endblock %}\n\n        \n        {% block sw_import_export_new_profile_wizard_violation_modal_footer %}\n        <template #modal-footer>\n            <sw-button\n                size="small"\n                @click="resetViolations"\n            >\n                {{ $tc(\'sw-import-export.profile.closeViolation\') }}\n            </sw-button>\n        </template>\n        {% endblock %}\n    </sw-modal>\n    {% endblock %}\n</sw-wizard>\n{% endblock %}\n',inject:["repositoryFactory","feature","importExportProfileMapping"],props:{profile:{type:Object,required:!0}},data:function(){return{nextButtonDisabled:!0,missingRequiredFields:[],systemRequiredFields:{},csvUploadPagePosition:1,currentlyActivePage:0,pagesCount:3}},computed:{profileRepository:function(){return this.repositoryFactory.create("import_export_profile")},showValidationError:function(){return this.missingRequiredFields.length>0},showNextButton:function(){return this.currentlyActivePage>=this.pagesCount-1},showCsvSkipButton:function(){return this.currentlyActivePage===this.csvUploadPagePosition},parentProfileCriteria:function(){var e=new n(1,25);return e.addFilter(n.equals("sourceEntity",this.profile.sourceEntity)),e.addFilter(n.equals("systemDefault",!0)),e}},watch:{"profile.sourceEntity":{handler:function(e){e&&this.loadSystemRequiredFieldsForEntity(e)}}},methods:{onClose:function(){this.$emit("close")},onFinish:function(){return this.saveProfile()},pageTitleSnippet:function(e){return"".concat(this.$tc("sw-import-export.profile.newProfileLabel")," - ").concat(this.$tc(e))},onNextAllow:function(){this.nextButtonDisabled=!1},onNextDisable:function(){this.nextButtonDisabled=!0},loadSystemRequiredFieldsForEntity:function(e){this.systemRequiredFields=this.importExportProfileMapping.getSystemRequiredFields(e)},saveProfile:function(){var e=this;return this.getParentProfileSelected().then((function(i){e.checkValidation(i),0===e.missingRequiredFields.length&&e.$emit("profile-save")}))},getParentProfileSelected:function(){var e=this;return this.profileRepository.search(this.parentProfileCriteria).then((function(e){return e.total>0?e[0]:null})).catch((function(){e.createNotificationError({message:e.$tc("sw-import-export.profile.messageSearchParentProfileError")})}))},checkValidation:function(e){if("export"!==this.profile.type){var i=e?e.mapping:[],t=!1===this.profile.config.createEntities&&!0===this.profile.config.updateEntities,n=this.importExportProfileMapping.validate(this.profile.sourceEntity,this.profile.mapping,i,t);n.missingRequiredFields.length>0&&(this.missingRequiredFields=n.missingRequiredFields)}},resetViolations:function(){this.missingRequiredFields=[]},onCurrentPageChange:function(e){this.currentlyActivePage=e},onNextPage:function(){this.$refs.wizard.nextPage()}}}},ID7S:function(e,i,t){},mwDM:function(e,i,t){var n=t("ID7S");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,t("P8hj").default)("11c1736a",n,!0,{})}}]);
//# sourceMappingURL=2fd09a5c3d255c3a3c88.js.map