{"version":3,"sources":["webpack:///./src/module/sw-settings-tax/component/sw-settings-tax-rule-modal/index.js","webpack:///./src/module/sw-settings-tax/component/sw-settings-tax-rule-modal/sw-settings-tax-rule-modal.html.twig"],"names":["Context","Shopware","Criteria","Data","mapPropertyErrors","Component","getComponentHelper","template","inject","props","tax","type","Object","required","currentRule","default","data","showModal","taxRule","currentTaxRuleType","computed","_objectSpread","taxRuleRepository","this","repositoryFactory","create","taxRuleTypeRepository","additionalComponent","subComponentName","technicalName","replace","feature","isActive","concat","$options","components","taxRuleTypeCriteria","criteria","addSorting","sort","countryCriteria","created","createdComponent","methods","changeRuleType","id","_this","get","api","then","item","taxRuleTypeId","taxId","onConfirm","_this2","save","isSaveSuccessful","$emit","catch","isLoading"],"mappings":"qXAMA,IAAQA,EAAYC,SAAZD,QACAE,EAAaD,SAASE,KAAtBD,SACAE,EAAsBH,SAASI,UAAUC,qBAAzCF,kBAGO,WACXG,SCZW,0jIDcXC,OAAQ,CAAC,oBAAqB,WAE9BC,MAAO,CACHC,IAAK,CACDC,KAAMC,OACNC,UAAU,GAEdC,YAAa,CACTH,KAAMC,OACNC,UAAU,EACVE,QAAS,OAIjBC,KAAI,WACA,MAAO,CACHC,WAAW,EACXC,QAAS,KACTC,mBAAoB,OAI5BC,S,iWAAQC,CAAA,CACJC,kBAAiB,WACb,OAAOC,KAAKC,kBAAkBC,OAAO,aAEzCC,sBAAqB,WACjB,OAAOH,KAAKC,kBAAkBC,OAAO,kBAEzCE,oBAAmB,WACf,IAAKJ,KAAKJ,mBACN,OAAO,KAEX,IAAMS,EAAmBL,KAAKJ,mBAAmBU,cAAcC,QAAQ,KAAM,KAE7E,OAAIP,KAAKQ,QAAQC,SAAS,QAChB,6BAANC,OAAoCL,GAGjCL,KAAKW,SAASC,WAAW,6BAADF,OAA8BL,KAEjEQ,oBAAmB,WACf,IAAMC,EAAW,IAAInC,EAAS,EAAG,IAGjC,OAFAmC,EAASC,WAAWpC,EAASqC,KAAK,WAAY,QAEvCF,GAEXG,gBAAe,WACX,IAAMH,EAAW,IAAInC,EAAS,EAAG,IAGjC,OAFAmC,EAASC,WAAWpC,EAASqC,KAAK,OAAQ,OAAO,IAE1CF,IAGRjC,EAAkB,UAAW,CAAC,gBAAiB,YAAa,UAAW,gBAG9EqC,QAAO,WACHlB,KAAKmB,oBAGTC,QAAS,CACLC,eAAc,SAACC,GAAK,IAADC,EAAA,KACfvB,KAAKG,sBAAsBqB,IAAIF,EAAI7C,EAAQgD,KAAKC,MAAK,SAACC,GAClDJ,EAAK3B,mBAAqB+B,MAGlCR,iBAAgB,WACRnB,KAAKT,aACLS,KAAKL,QAAUK,KAAKT,YAChBS,KAAKL,QAAQiC,eACb5B,KAAKqB,eAAerB,KAAKL,QAAQiC,iBAGrC5B,KAAKL,QAAUK,KAAKD,kBAAkBG,SACtCF,KAAKL,QAAQkC,MAAQ7B,KAAKb,IAAImC,KAItCQ,UAAS,WAAI,IAADC,EAAA,KACR/B,KAAKD,kBAAkBiC,KAAKhC,KAAKL,QAASlB,EAAQgD,KAAKC,MAAK,WACxDK,EAAKE,kBAAmB,EAExBF,EAAKG,MAAM,kBACZC,OAAM,WACLJ,EAAKK,WAAY","file":"static/js/0806f86c10733fe2dca6.js","sourcesContent":["import template from './sw-settings-tax-rule-modal.html.twig';\n\n/**\n * @package checkout\n */\n\nconst { Context } = Shopware;\nconst { Criteria } = Shopware.Data;\nconst { mapPropertyErrors } = Shopware.Component.getComponentHelper();\n\n// eslint-disable-next-line sw-deprecation-rules/private-feature-declarations\nexport default {\n    template,\n\n    inject: ['repositoryFactory', 'feature'],\n\n    props: {\n        tax: {\n            type: Object,\n            required: true,\n        },\n        currentRule: {\n            type: Object,\n            required: false,\n            default: null,\n        },\n    },\n\n    data() {\n        return {\n            showModal: false,\n            taxRule: null,\n            currentTaxRuleType: null,\n        };\n    },\n\n    computed: {\n        taxRuleRepository() {\n            return this.repositoryFactory.create('tax_rule');\n        },\n        taxRuleTypeRepository() {\n            return this.repositoryFactory.create('tax_rule_type');\n        },\n        additionalComponent() {\n            if (!this.currentTaxRuleType) {\n                return null;\n            }\n            const subComponentName = this.currentTaxRuleType.technicalName.replace(/_/g, '-');\n\n            if (this.feature.isActive('VUE3')) {\n                return `sw-settings-tax-rule-type-${subComponentName}`;\n            }\n\n            return this.$options.components[`sw-settings-tax-rule-type-${subComponentName}`];\n        },\n        taxRuleTypeCriteria() {\n            const criteria = new Criteria(1, 25);\n            criteria.addSorting(Criteria.sort('position', 'ASC'));\n\n            return criteria;\n        },\n        countryCriteria() {\n            const criteria = new Criteria(1, 25);\n            criteria.addSorting(Criteria.sort('name', 'ASC', false));\n\n            return criteria;\n        },\n\n        ...mapPropertyErrors('taxRule', ['taxRuleTypeId', 'countryId', 'taxRate', 'activeFrom']),\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        changeRuleType(id) {\n            this.taxRuleTypeRepository.get(id, Context.api).then((item) => {\n                this.currentTaxRuleType = item;\n            });\n        },\n        createdComponent() {\n            if (this.currentRule) {\n                this.taxRule = this.currentRule;\n                if (this.taxRule.taxRuleTypeId) {\n                    this.changeRuleType(this.taxRule.taxRuleTypeId);\n                }\n            } else {\n                this.taxRule = this.taxRuleRepository.create();\n                this.taxRule.taxId = this.tax.id;\n            }\n        },\n\n        onConfirm() {\n            this.taxRuleRepository.save(this.taxRule, Context.api).then(() => {\n                this.isSaveSuccessful = true;\n\n                this.$emit('modal-close');\n            }).catch(() => {\n                this.isLoading = false;\n            });\n        },\n    },\n};\n","export default \"\\n{% block sw_settings_tax_rule_modal %}\\n<sw-modal\\n    :title=\\\"$tc('sw-settings-tax.taxRuleCard.labelCountryName')\\\"\\n    class=\\\"sw-settings-tax-rule-modal__settings-modal\\\"\\n    @modal-close=\\\"$emit('modal-close')\\\"\\n>\\n    \\n    {% block sw_settings_tax_rule_modal_form_first_row %}\\n    <sw-container\\n        columns=\\\"1fr 1fr\\\"\\n        gap=\\\"0px 32px\\\"\\n    >\\n        \\n        {% block sw_settings_tax_rule_modal_country_select %}\\n        <sw-entity-single-select\\n            {% if VUE3 %}\\n            v-model:value=\\\"taxRule.countryId\\\"\\n            {% else %}\\n            v-model=\\\"taxRule.countryId\\\"\\n            {% endif %}\\n            show-clearable-button\\n            required\\n            :label=\\\"$tc('sw-settings-tax.taxRuleCard.labelCountryName')\\\"\\n            :help-text=\\\"$tc('sw-settings-tax.taxRuleCard.tooltipCountries')\\\"\\n            :error=\\\"taxRuleCountryIdError\\\"\\n            :criteria=\\\"countryCriteria\\\"\\n            entity=\\\"country\\\"\\n        />\\n        {% endblock %}\\n        \\n        {% block sw_settings_tax_rule_modal_type_select %}\\n        <sw-entity-single-select\\n            {% if VUE3 %}\\n            v-model:value=\\\"taxRule.taxRuleTypeId\\\"\\n            {% else %}\\n            v-model=\\\"taxRule.taxRuleTypeId\\\"\\n            {% endif %}\\n            show-clearable-button\\n            required\\n            :label=\\\"$tc('sw-settings-tax.taxRuleCard.labelAppliesOn')\\\"\\n            label-property=\\\"typeName\\\"\\n            :error=\\\"taxRuleTaxRuleTypeIdError\\\"\\n            :criteria=\\\"taxRuleTypeCriteria\\\"\\n            entity=\\\"tax_rule_type\\\"\\n            {% if VUE3 %}\\n            @update:value=\\\"changeRuleType\\\"\\n            {% else %}\\n            @change=\\\"changeRuleType\\\"\\n            {% endif %}\\n        />\\n        {% endblock %}\\n    </sw-container>\\n    {% endblock %}\\n\\n    \\n    {% block sw_settings_tax_rule_modal_form_second_row %}\\n    <sw-container\\n        columns=\\\"1fr 1fr\\\"\\n        gap=\\\"0 32px\\\"\\n    >\\n        \\n        {% block sw_settings_tax_rule_modal_additional_component %}\\n        <component\\n            :is=\\\"additionalComponent\\\"\\n            v-if=\\\"additionalComponent\\\"\\n            :tax-rule=\\\"taxRule\\\"\\n        />\\n        {% endblock %}\\n\\n        \\n        {% block sw_settings_tax_rule_modal_tax_rate %}\\n        <sw-number-field\\n            {% if VUE3 %}\\n            v-model:value=\\\"taxRule.taxRate\\\"\\n            {% else %}\\n            v-model=\\\"taxRule.taxRate\\\"\\n            {% endif %}\\n            required\\n            :digits=\\\"3\\\"\\n            :error=\\\"taxRuleTaxRateError\\\"\\n            :label=\\\"$tc('sw-settings-tax.taxRuleCard.labelTaxRate')\\\"\\n        >\\n            <template #suffix>\\n                <span>\\n                    <span v-html=\\\"$sanitize($tc('sw-settings-tax.general.taxRateSymbol'))\\\"></span>\\n                </span>\\n            </template>\\n        </sw-number-field>\\n        {% endblock %}\\n\\n        \\n        {% block sw_settings_tax_rule_modal_tax_active_from %}\\n        <sw-datepicker\\n            {% if VUE3 %}\\n            v-model:value=\\\"taxRule.activeFrom\\\"\\n            {% else %}\\n            v-model=\\\"taxRule.activeFrom\\\"\\n            {% endif %}\\n            date-type=\\\"datetime\\\"\\n            :error=\\\"taxRuleActiveFromError\\\"\\n            :label=\\\"$tc('sw-settings-tax.taxRuleCard.labelActiveFrom')\\\"\\n        />\\n        {% endblock %}\\n    </sw-container>\\n    {% endblock %}\\n\\n    \\n    {% block sw_settings_tax_rule_modal_form_footer %}\\n    <template #modal-footer>\\n        \\n        {% block sw_settings_tax_rule_modal_form_footer_cancel %}\\n        <sw-button\\n            size=\\\"small\\\"\\n            @click=\\\"$emit('modal-close')\\\"\\n        >\\n            {{ $tc('sw-settings-tax.taxRuleCard.labelCancel') }}\\n        </sw-button>\\n        {% endblock %}\\n\\n        \\n        {% block sw_settings_tax_rule_modal_form_footer_button_create %}\\n        <sw-button\\n            variant=\\\"primary\\\"\\n            size=\\\"small\\\"\\n            @click=\\\"onConfirm\\\"\\n        >\\n            {{ $tc('sw-settings-tax.detail.buttonSave') }}\\n        </sw-button>\\n        {% endblock %}\\n    </template>\\n    {% endblock %}\\n</sw-modal>\\n{% endblock %}\\n\";"],"sourceRoot":""}