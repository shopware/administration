(window.webpackJsonpAdministration=window.webpackJsonpAdministration||[]).push([[4083],{994341:function(){},104083:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return r}}),n(603749);let{mapGetters:s,mapState:i}=Shopware.Component.getComponentHelper(),{Context:o}=Shopware,{Criteria:a}=Shopware.Data;var r={template:'<div class="sw-product-cross-selling-assignment">\n    \n    {% block sw_product_cross_selling_assignment_container %}\n    <div class="sw-product-cross-selling-assignment__select-container">\n        \n        {% block sw_product_cross_selling_assignment_select %}\n        <sw-entity-single-select\n            :label="$tc(\'sw-product.crossselling.inputCrossSellingProductList\')"\n            entity="product"\n            value=""\n            :criteria="searchCriteria"\n            :context="searchContext"\n            disable-auto-close\n            :disabled="!allowEdit"\n            show-clearable-button\n            @update:value="onToggleProduct"\n        >\n\n            <template #result-item="{ item, index }">\n                <slot\n                    name="result-item"\n                    v-bind="{ item, index, isSelected }"\n                >\n                    <sw-select-result\n                        :selected="isSelected(item)"\n                        v-bind="{ item, index }"\n                    >\n                        \n                        {% block sw_entity_single_select_base_results_list_result_label %}\n                        <span class="sw-select-result__result-item-text">\n                            <sw-product-variant-info :variations="item.variation">\n                                {{ item.translated.name || item.name }}\n                            </sw-product-variant-info>\n                        </span>\n                        {% endblock %}\n                    </sw-select-result>\n                </slot>\n            </template>\n\n        </sw-entity-single-select>\n        {% endblock %}\n\n        \n        {% block sw_product_cross_selling_assignment_option_grid %}\n        <sw-data-grid\n            v-if="total"\n            :key="isLoadingGrid"\n            :data-source="assignedProducts"\n            :is-loading="isLoadingGrid"\n            :columns="assignedProductColumns"\n            :show-settings="true"\n            :show-selection="false"\n        >\n\n            <template #actions="{ item }">\n                <sw-context-menu-item\n                    :disabled="!allowEdit"\n                    variant="danger"\n                    @click="removeItem(item)"\n                >\n                    {{ $tc(\'global.default.delete\') }}\n                </sw-context-menu-item>\n            </template>\n\n            <template #column-product.translated.name="{ item }">\n                \n                {% block sw_data_grid_columns_render_value %}\n                <span>\n                    <sw-product-variant-info :variations="item.product.variation">\n                        {{ item.product.translated.name || item.product.name || variantNames[item.product.id] }}\n                    </sw-product-variant-info>\n                </span>\n                {% endblock %}\n            </template>\n\n            \n            {% block sw_product_cross_selling_assignment_option_grid_column_position %}\n            <template #column-position="{ item }">\n                <sw-data-grid-column-position\n                    ref="columnPosition"\n                    v-model:value="assignedProducts"\n                    :show-value="true"\n                    :item="item"\n                />\n            </template>\n            {% endblock %}\n        </sw-data-grid>\n        {% endblock %}\n        \n        {% block sw_product_cross_selling_assignment_empty_state %}\n        <sw-empty-state\n            v-if="!total && !isLoadingGrid"\n            class="sw-product-cross-selling-assignment__option-list-empty-state"\n            title=""\n            :absolute="false"\n            :subline="$tc(\'sw-product.crossselling.assignEmptyStateDescription\')"\n        >\n            <template #icon>\n                <img\n                    :src="assetFilter(\'/administration/static/img/empty-states/products-empty-state.svg\')"\n                    alt=""\n                >\n            </template>\n        </sw-empty-state>\n        {% endblock %}\n    </div>\n    {% endblock %}\n</div>\n',inject:["repositoryFactory"],props:{assignedProducts:{type:Array,required:!0},crossSellingId:{type:String,required:!0},allowEdit:{type:Boolean,required:!1,default:!0}},data(){return{isLoadingData:!1,variantNames:{}}},computed:{...i("swProductDetail",["product"]),...s("swProductDetail",["isLoading"]),isLoadingGrid(){return this.isLoadingData||this.isLoading},assignmentRepository(){return this.repositoryFactory.create(this.assignedProducts.entity,this.assignedProducts.source)},productRepository(){return this.repositoryFactory.create("product")},searchCriteria(){let t=new a(1,25);return t.addFilter(a.not("and",[a.equals("id",this.product.id)])),t.addFilter(a.multi("or",[a.equals("childCount",0),a.not("and",[a.equals("parentId",null)])])),t.addAssociation("options.group"),t},searchContext(){return{...o.api,inheritance:!0}},total(){return this.assignedProducts&&Array.isArray(this.assignedProducts)?this.assignedProducts.length:0},assignedProductColumns(){return[{property:"product.translated.name",label:this.$tc("sw-product.list.columnName"),primary:!0,allowResize:!0,sortable:!1},{property:"product.productNumber",label:this.$tc("sw-product.list.columnProductNumber"),allowResize:!0,sortable:!1},{property:"position",label:this.$tc("sw-product.crossselling.inputCrossSellingPosition"),allowResize:!0,sortable:!1}]},variantProductIds(){let t=[];return this.assignedProducts.forEach(e=>{!e.product.parentId||e.product.translated.name||e.product.name||t.push(e.product.id)}),t},variantCriteria(){let t=new a(1,25);return t.setIds(this.variantProductIds),t},assetFilter(){return Shopware.Filter.getByName("asset")}},created(){0!==this.variantProductIds.length&&this.productRepository.search(this.variantCriteria,{...o.api,inheritance:!0}).then(t=>{let e={};t.forEach(t=>{e[t.id]=t.translated.name}),this.variantNames=e})},methods:{onToggleProduct(t){if(null===t)return;this.isLoadingData=!0;let e=this.assignedProducts.find(e=>e.productId===t);if(e)this.removeItem(e),this.isLoadingData=!1;else{let e=this.assignmentRepository.create();e.crossSellingId=this.crossSellingId,e.productId=t,e.position=this.assignedProducts.length+1,this.assignedProducts.add(e);let n=new a(1,25);n.addAssociation("options.group"),this.productRepository.get(t,{...o.api,inheritance:!0},n).then(t=>{e.product=t,this.isLoadingData=!1})}},removeItem(t){let e=t.position;this.assignedProducts.remove(t.id),this.assignedProducts.forEach(t=>{t.position<=e||(t.position-=1)})},isSelected(t){return this.assignedProducts.some(e=>e.productId===t.id)}}}},603749:function(t,e,n){var s=n(994341);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals),n(745346).Z("50390a14",s,!0,{})}}]);