(this.webpackJsonpAdministration=this.webpackJsonpAdministration||[]).push([[591],{"7B76":function(o,n,i){"use strict";i.r(n);var t=Shopware.Data,e=t.Criteria,r=t.EntityCollection,s=Shopware.Utils.types;n.default={template:'\n{% block sw_promotion_v2_conditions %}\n<div class="sw-promotion-v2-conditions">\n\n    \n    {% block sw_promotion_v2_conditions_pre_conditions_card %}\n    <sw-card\n        :title="$tc(\'sw-promotion-v2.detail.conditions.preConditions.cardTitlePreConditions\')"\n        position-identifier="sw-promotion-conditions-pre-conditions"\n    >\n\n        \n        {% block sw_promotion_v2_conditions_pre_conditions_sales_channel_selection %}\n        <sw-promotion-v2-sales-channel-select\n            class="sw-promotion-v2-conditions__sales-channel-selection"\n            :promotion="promotion"\n            :entity-collection="promotion.salesChannels"\n            :disabled="!acl.can(\'promotion.editor\')"\n            :label="$tc(\'sw-promotion-v2.detail.conditions.preConditions.labelPromotionSalesChannel\')"\n            :placeholder="$tc(\'sw-promotion-v2.detail.conditions.preConditions.labelPromotionSalesChannel\')"\n        />\n        {% endblock %}\n\n        \n        {% block sw_promotion_v2_conditions_pre_conditions_prevent_combination %}\n        <sw-switch-field\n            {% if VUE3 %}\n            v-model:value="promotion.preventCombination"\n            {% else %}\n            v-model="promotion.preventCombination"\n            {% endif %}\n            class="sw-promotion-v2-conditions__prevent-combination"\n            :label="$tc(\'sw-promotion-v2.detail.conditions.preConditions.labelPreventCombination\')"\n            :text="$tc(\'sw-promotion-v2.detail.conditions.preConditions.helpTextPreventCombination\')"\n        />\n        {% endblock %}\n\n        \n        {% block sw_promotion_v2_conditions_pre_conditions_exclusions %}\n        <sw-entity-multi-select\n            class="sw-promotion-v2-conditions__rules-exclusion-selection"\n            :label="$tc(\'sw-promotion-v2.detail.conditions.preConditions.labelPromotionExclusions\')"\n            :placeholder="$tc(\'sw-promotion-v2.detail.conditions.preConditions.placeholderPromotionExclusions\')"\n            :criteria="exclusionCriteria"\n            :entity-collection="excludedPromotions"\n            :disabled="!acl.can(\'promotion.editor\') || promotion.preventCombination"\n            {% if VUE3 %}\n            @update:entity-collection="onChangeExclusions"\n            {% else %}\n            @change="onChangeExclusions"\n            {% endif %}\n        />\n        {% endblock %}\n\n    </sw-card>\n    {% endblock %}\n\n    \n    {% block sw_promotion_v2_rule_conditions_card %}\n    <sw-card\n        :title="$tc(\'sw-promotion-v2.detail.conditions.preConditions.cardTitleRuleConditions\')"\n        position-identifier="sw-promotion-conditions-rules"\n    >\n\n        \n        {% block sw_promotion_v2_rule_conditions_rule_select_customer %}\n        <sw-promotion-v2-rule-select\n            v-if="promotion"\n            {% if VUE3 %}\n            v-model:collection="promotion.personaRules"\n            {% else %}\n            v-model="promotion.personaRules"\n            {% endif %}\n            class="sw-promotion-v2-conditions__rule-select-customer"\n            :local-mode="promotion.isNew()"\n            :criteria="personaRuleFilter"\n            :label="$tc(\'sw-promotion-v2.detail.conditions.preConditions.labelCustomerSelect\')"\n            :placeholder="$tc(\'sw-promotion-v2.detail.conditions.preConditions.placeholderCustomerSelect\')"\n            :rule-scope="[\'checkout\']"\n            :disabled="!acl.can(\'promotion.editor\')"\n            rule-aware-group-key="personaPromotions"\n        />\n        {% endblock %}\n\n        \n        {% block sw_promotion_v2_rule_conditions_rule_select_cart_conditions %}\n        <sw-promotion-v2-cart-condition-form\n            :promotion="promotion"\n            :restricted-rules="cartRestrictedRules"\n        />\n        {% endblock %}\n\n        \n        {% block sw_promotion_v2_rule_conditions_rule_select_order_conditions %}\n        <sw-promotion-v2-rule-select\n            v-if="promotion"\n            {% if VUE3 %}\n            v-model:collection="promotion.orderRules"\n            {% else %}\n            v-model="promotion.orderRules"\n            {% endif %}\n            class="sw-promotion-v2-conditions__rule-select-order-conditions"\n            :label="$tc(\'sw-promotion-v2.detail.conditions.preConditions.labelOrderConditionSelect\')"\n            :placeholder="$tc(\'sw-promotion-v2.detail.conditions.preConditions.placeholderOrderConditionSelect\')"\n            :criteria="orderConditionsFilter"\n            :rule-scope="[\'checkout\']"\n            :disabled="!acl.can(\'promotion.editor\')"\n            rule-aware-group-key="orderPromotions"\n        />\n        {% endblock %}\n\n    </sw-card>\n    {% endblock %}\n\n</div>\n{% endblock %}\n',inject:["repositoryFactory","acl","feature","ruleConditionDataProviderService"],props:{promotion:{type:Object,required:!1,default:function(){return null}}},data:function(){return{excludedPromotions:this.createPromotionCollection(),personaRestrictedRules:[],orderRestrictedRules:[],cartRestrictedRules:[]}},computed:{exclusionCriteria:function(){var o=new e(1,25);return o.addFilter(e.not("and",[e.equals("id",this.promotion.id)])),o},personaRuleFilter:function(){var o=new e(1,25);return o.addAssociation("conditions").addSorting(e.sort("name","ASC",!1)),o},cartConditionsRuleFilter:function(){var o=new e(1,25);return o.addAssociation("conditions").addSorting(e.sort("name","ASC",!1)),o},orderConditionsFilter:function(){var o=new e(1,25);return o.addAssociation("conditions").addSorting(e.sort("name","ASC",!1)),o}},created:function(){this.createdComponent()},methods:{createdComponent:function(){this.loadExclusions()},loadExclusions:function(){var o=this;if(s.isEmpty(this.promotion.exclusionIds))this.excludedPromotions=this.createPromotionCollection();else{var n=this.repositoryFactory.create("promotion"),i=new e(1,25).addFilter(e.equalsAny("id",this.promotion.exclusionIds));n.search(i).then((function(n){o.excludedPromotions=n}))}},onChangeExclusions:function(o){this.promotion.exclusionIds=o.map((function(o){return o.id})),this.loadExclusions()},createPromotionCollection:function(){return new r("/promotion","promotion",Shopware.Context.api,new e(1,25))}}}}}]);